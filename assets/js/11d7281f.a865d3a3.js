"use strict";(self.webpackChunkcypress_docusaurus_ts=self.webpackChunkcypress_docusaurus_ts||[]).push([[7460],{9525:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>a,toc:()=>l});var t=s(5893),r=s(1151);const o={title:"Trade-offs",e2eSpecific:!0},i=void 0,a={id:"guides/references/trade-offs",title:"Trade-offs",description:"Cypress automates the browser with its own unique architecture. While this",source:"@site/docs/guides/references/trade-offs.mdx",sourceDirName:"guides/references",slug:"/guides/references/trade-offs",permalink:"/guides/references/trade-offs",draft:!1,unlisted:!1,editUrl:"https://github.com/cypress-io/cypress-documentation/tree/main/docs/guides/references/trade-offs.mdx",tags:[],version:"current",lastUpdatedAt:1728611023,formattedLastUpdatedAt:"Oct 11, 2024",frontMatter:{title:"Trade-offs",e2eSpecific:!0},sidebar:"guides",previous:{title:"Roadmap",permalink:"/guides/references/roadmap"},next:{title:"Troubleshooting",permalink:"/guides/references/troubleshooting"}},c={},l=[{value:"Permanent trade-offs:",id:"Permanent-trade-offs",level:4},{value:"Temporary trade-offs:",id:"Temporary-trade-offs",level:4},{value:"Permanent trade-offs",id:"Permanent-trade-offs-1",level:2},{value:"Automation restrictions",id:"Automation-restrictions",level:3},{value:"Inside the browser",id:"Inside-the-browser",level:3},{value:"Multiple browsers open at the same time",id:"Multiple-browsers-open-at-the-same-time",level:3},{value:"1. Use only the browser:",id:"1-Use-only-the-browser",level:4},{value:"2. Stub the other connection:",id:"2-Stub-the-other-connection",level:4},{value:"3: Introduce another connection:",id:"3-Introduce-another-connection",level:4}];function h(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"Cypress automates the browser with its own unique architecture. While this\nunlocks the power to do things you will not find anywhere else, there are\nspecific trade-offs that are made. There is no free lunch!"}),"\n",(0,t.jsx)(n.p,{children:"In this guide we will lay out what some of the trade-offs are - and specifically\nhow you can work around them."}),"\n",(0,t.jsxs)(n.p,{children:["While at first it may seem like these are strict limitations in Cypress - we\nthink you will soon realize that many of these boundaries are actually ",(0,t.jsx)(n.strong,{children:"good"}),"\nto have. In a sense they prevent you from writing bad, slow, or flaky tests."]}),"\n",(0,t.jsx)(n.h4,{id:"Permanent-trade-offs",children:"Permanent trade-offs:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Cypress is not a general purpose ",(0,t.jsx)(n.a,{href:"#Automation-restrictions",children:"automation tool"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Cypress commands run ",(0,t.jsx)(n.a,{href:"#Inside-the-browser",children:"inside of a browser"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["You cannot use Cypress to drive\n",(0,t.jsx)(n.a,{href:"#Multiple-browsers-open-at-the-same-time",children:"two browsers at the same time"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Each test is bound to a single superdomain. Cross-origin navigation inside\ntests can be enabled by using the ",(0,t.jsx)(n.a,{href:"/api/commands/origin",children:(0,t.jsx)(n.code,{children:"cy.origin"})})," command.\nPlease read our\n",(0,t.jsx)(n.a,{href:"/guides/guides/cross-origin-testing",children:"Cross Origin Testing Guide"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"Temporary-trade-offs",children:"Temporary trade-offs:"}),"\n",(0,t.jsxs)(n.p,{children:["We have ",(0,t.jsx)(n.a,{href:"https://github.com/cypress-io/cypress/issues",children:"open issues"})," where you\ncan find a full list of things Cypress will eventually address, we wanted to\nhighlight some of the more important ",(0,t.jsx)(n.em,{children:"temporary"})," restrictions that Cypress will\neventually address. ",(0,t.jsx)(n.a,{href:"https://on.cypress.io/contributing",children:"PRs are welcome ;-)"})]}),"\n",(0,t.jsxs)(n.p,{children:["Many of these issues are currently being worked on or are on our\n",(0,t.jsx)(n.a,{href:"/guides/references/roadmap",children:"Roadmap"}),"."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsxs)(n.a,{href:"/api/commands/hover",children:["Workarounds for the lack of a ",(0,t.jsx)(n.code,{children:"cy.hover()"})," command."]})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsxs)(n.a,{href:"https://github.com/cypress-io/cypress/issues/299",children:[(0,t.jsx)(n.code,{children:"cy.tab()"})," command."]})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/cypress-io/cypress/issues/311#issuecomment-339824191",children:"There is not any native or mobile events support."})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/cypress-io/cypress/issues/136",children:"iframe support is somewhat limited, but does work."})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"Permanent-trade-offs-1",children:"Permanent trade-offs"}),"\n",(0,t.jsx)(n.h3,{id:"Automation-restrictions",children:"Automation restrictions"}),"\n",(0,t.jsx)(n.p,{children:"Cypress is a specialized tool that does one thing really well: end-to-end\ntesting web applications while they are under development. You should not use\nCypress for things it is not designed for such as:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Indexing the web"}),"\n",(0,t.jsx)(n.li,{children:"Spidering links"}),"\n",(0,t.jsx)(n.li,{children:"Performance testing"}),"\n",(0,t.jsx)(n.li,{children:"Scripting 3rd party sites"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"There are other excellent tools that are optimized for doing each item listed\nabove."}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.strong,{children:"sweet spot"})," of Cypress is to be used as a tool to test your own\napplication ",(0,t.jsx)(n.strong,{children:"as you build it"}),". It is built for developers and QA engineers,\nnot manual testers or exploratory testing."]}),"\n",(0,t.jsx)(n.h3,{id:"Inside-the-browser",children:"Inside the browser"}),"\n",(0,t.jsx)(n.p,{children:"In case you missed it before - Cypress tests run inside of the browser! This\nmeans we can do things nobody else can. There is no object serialization or JSON\nwire protocols. You have real, native access to everything in your application\nunder test. It is impossible for Cypress to 'miss' elements and it always knows\nthe moment your application fires any kind of event."}),"\n",(0,t.jsxs)(n.p,{children:["But what this also means is that your test code ",(0,t.jsx)(n.strong,{children:"is being evaluated inside the\nbrowser"}),". Test code is not evaluated in Node, or any other server side\nlanguage. The ",(0,t.jsx)(n.strong,{children:"only"})," language we will ever support is the language of the web:\nJavaScript."]}),"\n",(0,t.jsxs)(n.p,{children:["This trade-off means it makes it a little bit harder to communicate with the\nback end - like your server or database. You will not be able to connect or\nimport those server-side libraries or modules directly. Although you can require\n",(0,t.jsx)(n.code,{children:"node_modules"})," which can be used in the browser. Additionally, you have the\nability to use Node to import or talk directly to your back end scripts using\n",(0,t.jsx)(n.a,{href:"/api/plugins/writing-a-plugin",children:"our Plugins API"})," or\n",(0,t.jsx)(n.a,{href:"/api/commands/task",children:"cy.task()"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["To talk to your database or server you need to use the\n",(0,t.jsx)(n.a,{href:"/api/commands/exec",children:(0,t.jsx)(n.code,{children:"cy.exec()"})}),", ",(0,t.jsx)(n.a,{href:"/api/commands/task",children:(0,t.jsx)(n.code,{children:"cy.task()"})}),", or\n",(0,t.jsx)(n.a,{href:"/api/commands/request",children:(0,t.jsx)(n.code,{children:"cy.request()"})})," commands. That means you will need to\nexpose a way to seed and setup your database. This really is not that hard, but\nit might take a bit more elbow grease than other testing tools written in your\nback end language."]}),"\n",(0,t.jsx)(n.p,{children:"The trade-off here is that doing everything in the browser (basically all of\nyour tests) is a much better experience in Cypress. But doing things outside of\nthe browser may take a little extra work."}),"\n",(0,t.jsxs)(n.p,{children:["In the future we ",(0,t.jsx)(n.strong,{children:"do"})," have plans to release back end adapters for other\nlanguages."]}),"\n",(0,t.jsx)(n.h3,{id:"Multiple-browsers-open-at-the-same-time",children:"Multiple browsers open at the same time"}),"\n",(0,t.jsx)(n.p,{children:"Cypress does not support controlling more than 1 open browser at a time."}),"\n",(0,t.jsx)(n.p,{children:"With that said, except in the most unusual and rare circumstances, you can still\ntest most application behavior without opening multiple browsers at the same\ntime."}),"\n",(0,t.jsx)(n.p,{children:"You may ask about this functionality like this:"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"I'm trying to test a chat application. Can I run more than one browser at a\ntime with Cypress?"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Whether you are testing a chat application or anything else - what you are\nreally asking about is testing collaboration. But, ",(0,t.jsx)(n.strong,{children:"you don't need to recreate\nthe entire environment in order to test collaboration with 100% coverage"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Doing it this way can be faster, more accurate, and more scalable."}),"\n",(0,t.jsx)(n.p,{children:"While outside the scope of this article, you could test a chat application using\nthe following principles. Each one will incrementally introduce more\ncollaboration:"}),"\n",(0,t.jsx)(n.h4,{id:"1-Use-only-the-browser",children:"1. Use only the browser:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"    \u2193\n\u2190 browser \u2192\n    \u2191\n"})}),"\n",(0,t.jsx)(n.p,{children:'Avoid the server, invoke your JavaScript callbacks manually thereby simulating\nwhat happens when "notifications come in", or "users leave the chat" purely in\nthe browser.'}),"\n",(0,t.jsxs)(n.p,{children:["You can ",(0,t.jsx)(n.a,{href:"/api/commands/stub",children:"stub"})," everything and simulate every single\nscenario. Chat messages, offline messages, connections, reconnections,\ndisconnections, group chat, etc. Everything that happens inside of the browser\ncan be fully tested. Requests leaving the browser could also be stubbed and you\ncould assert that the request bodies were correct."]}),"\n",(0,t.jsx)(n.h4,{id:"2-Stub-the-other-connection",children:"2. Stub the other connection:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"server \u2192 browser\n            \u2193\nserver \u2190 browser\n  \u2193\n(other connections stubbed)\n  \u2193\nserver \u2192 browser\n"})}),"\n",(0,t.jsx)(n.p,{children:'Use your server to receive messages from the browser, and simulate "the other\nparticipant" by sending messages as that participant. This is certainly\napplication specific, but generally you could insert records into the database\nor do whatever it takes for your server to act as if a message of one client\nneeds to be sent back to the browser.'}),"\n",(0,t.jsx)(n.p,{children:"Typically this pattern enables you to avoid making a secondary WebSocket\nconnection and yet still fulfills the bidirectional browser and server contract.\nThis means you could also test edge cases (disconnections, etc) without actually\nhandling real connections."}),"\n",(0,t.jsx)(n.h4,{id:"3-Introduce-another-connection",children:"3: Introduce another connection:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"server \u2192 browser\n            \u2193\nserver \u2190 browser\n  \u2193\nserver \u2192 other connection\n            \u2193\nserver \u2190 other connection\n  \u2193\nserver \u2192 browser\n"})}),"\n",(0,t.jsx)(n.p,{children:"To do this - you would need a background process outside of the browser to make\nthe underlying WebSocket connection that you can then communicate with and\ncontrol."}),"\n",(0,t.jsx)(n.p,{children:"You can do this in many ways and here is an example of using an HTTP server to\nact as the client and exposing a REST interface that enables us to control it."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"// Cypress tests\n\n// tell the http server at 8081 to connect to 8080\ncy.request('http://localhost:8081/connect?url=http://localhost:8080')\n\n// tell the http server at 8081 to send a message\ncy.request('http://localhost:8081/message?m=hello')\n\n// tell the http server at 8081 to disconnect\ncy.request('http://localhost:8081/disconnect')\n"})}),"\n",(0,t.jsx)(n.p,{children:"And the HTTP server code would look something like this..."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"const client = require('socket.io:client')\nconst express = require('express')\n\nconst app = express()\n\nlet socket\n\napp.get('/connect', (req, res) => {\n  const url = req.query.url\n\n  socket = client(url)\n\n  socket.on('connect', () => {\n    res.sendStatus(200)\n  })\n})\n\napp.get('/message', (req, res) => {\n  const msg = req.query.m\n\n  socket.send(msg, () => {\n    res.sendStatus(200)\n  })\n})\n\napp.get('/disconnect', (req, res) => {\n  socket.on('disconnect', () => {\n    res.sendStatus(200)\n  })\n\n  socket.disconnect()\n})\n\napp.listen(8081, () => {})\n"})}),"\n",(0,t.jsx)(n.p,{children:"This avoids ever needing a second open browser, but still gives you an\nend-to-end test that provides 100% confidence that the two clients can\ncommunicate with each other."})]})}function d(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},1151:(e,n,s)=>{s.d(n,{Z:()=>a,a:()=>i});var t=s(7294);const r={},o=t.createContext(r);function i(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);