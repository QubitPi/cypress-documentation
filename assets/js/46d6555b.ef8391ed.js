"use strict";(self.webpackChunkcypress_docusaurus_ts=self.webpackChunkcypress_docusaurus_ts||[]).push([[4834],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>g});var a=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function r(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},s=Object.keys(e);for(a=0;a<s.length;a++)t=s[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)t=s[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=a.createContext({}),m=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=m(e.components);return a.createElement(l.Provider,{value:n},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,s=e.originalType,l=e.parentName,p=r(e,["components","mdxType","originalType","parentName"]),c=m(t),u=o,g=c["".concat(l,".").concat(u)]||c[u]||d[u]||s;return t?a.createElement(g,i(i({ref:n},p),{},{components:t})):a.createElement(g,i({ref:n},p))}));function g(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var s=t.length,i=new Array(s);i[0]=u;var r={};for(var l in n)hasOwnProperty.call(n,l)&&(r[l]=n[l]);r.originalType=e,r[c]="string"==typeof e?e:o,i[1]=r;for(var m=2;m<s;m++)i[m]=t[m];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},7244:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>k,frontMatter:()=>s,metadata:()=>r,toc:()=>m});var a=t(7462),o=(t(7294),t(3905));const s={title:"Custom Commands",sidebar_position:20},i=void 0,r={unversionedId:"api/cypress-api/custom-commands",id:"api/cypress-api/custom-commands",title:"Custom Commands",description:"Cypress comes with its own API for creating custom commands and overwriting",source:"@site/docs/api/cypress-api/custom-commands.mdx",sourceDirName:"api/cypress-api",slug:"/api/cypress-api/custom-commands",permalink:"/cypress-documentation/api/cypress-api/custom-commands",draft:!1,editUrl:"https://github.com/cypress-io/cypress-documentation/tree/main/docs/api/cypress-api/custom-commands.mdx",tags:[],version:"current",lastUpdatedAt:1698216540,formattedLastUpdatedAt:"Oct 25, 2023",sidebarPosition:20,frontMatter:{title:"Custom Commands",sidebar_position:20},sidebar:"api",previous:{title:"Catalog of Events",permalink:"/cypress-documentation/api/cypress-api/catalog-of-events"},next:{title:"Custom Queries",permalink:"/cypress-documentation/api/cypress-api/custom-queries"}},l={},m=[{value:"Syntax",id:"Syntax",level:2},{value:"Usage",id:"Usage",level:3},{value:"Arguments",id:"Arguments",level:3},{value:"Examples",id:"Examples",level:2},{value:"Parent Commands",id:"Parent-Commands",level:3},{value:"Click link containing text",id:"Click-link-containing-text",level:4},{value:"Check a token",id:"Check-a-token",level:4},{value:"Download a file",id:"Download-a-file",level:4},{value:"Commands to work with <code>sessionStorage</code>",id:"Commands-to-work-with-sessionStorage",level:4},{value:"Log in command using UI",id:"Log-in-command-using-UI",level:4},{value:"Log in command using request",id:"Log-in-command-using-request",level:4},{value:"Log out command using UI",id:"Log-out-command-using-UI",level:4},{value:"Log out command using <code>localStorage</code> <E2EOnlyBadge />",id:"Log-out-command-using-localStorage",level:4},{value:"Create a user",id:"Create-a-user",level:4},{value:"Child Commands",id:"Child-Commands",level:3},{value:"Custom <code>console</code> command",id:"Custom-console-command",level:4},{value:"Dual Commands",id:"Dual-Commands",level:3},{value:"Custom Dual Command",id:"Custom-Dual-Command",level:4},{value:"Overwrite Existing Commands",id:"Overwrite-Existing-Commands",level:3},{value:"Overwrite <code>visit</code> command",id:"Overwrite-visit-command",level:4},{value:"Overwrite <code>type</code> command",id:"Overwrite-type-command",level:4},{value:"Overwrite <code>screenshot</code> command",id:"Overwrite-screenshot-command",level:4},{value:"Overwrite <code>click</code> command",id:"Overwrite-click-command",level:4},{value:"Set Browser Language",id:"Set-Browser-Language",level:3},{value:"Validations",id:"Validations",level:2},{value:"Require Element",id:"Require-Element",level:3},{value:"Allow Multiple Types",id:"Allow-Multiple-Types",level:3},{value:"<code>.trigger()</code>",id:"trigger",level:4},{value:"Optional with Types",id:"Optional-with-Types",level:3},{value:"Notes",id:"Notes",level:2},{value:"Command Logging",id:"Command-Logging",level:3},{value:"<code>cy.hover()</code> and <code>cy.mount()</code>",id:"cyhover-and-cymount",level:3},{value:"Best Practices",id:"Best-Practices",level:3},{value:"1. Don&#39;t make everything a custom command",id:"1-Dont-make-everything-a-custom-command",level:4},{value:"2. Don&#39;t overcomplicate things",id:"2-Dont-overcomplicate-things",level:4},{value:"3. Don&#39;t do too much in a single command",id:"3-Dont-do-too-much-in-a-single-command",level:4},{value:"4. Skip your UI as much as possible",id:"4-Skip-your-UI-as-much-as-possible",level:4},{value:"5. Write TypeScript definitions",id:"5-Write-TypeScript-definitions",level:4},{value:"6. Create a function that adds the custom command",id:"6-Create-a-function-that-adds-the-custom-command",level:4},{value:"History",id:"History",level:2},{value:"See also",id:"See-also",level:2}],p=e=>function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.kt)("div",n)},c=p("Icon"),d=p("E2EOnlyBadge"),u=p("DocsImage"),g={toc:m};function k(e){let{components:n,...t}=e;return(0,o.kt)("wrapper",(0,a.Z)({},g,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Cypress comes with its own API for creating custom commands and overwriting\nexisting commands. The built in Cypress commands use the very same API that's\ndefined below."),(0,o.kt)("p",null,"There are two API available for adding custom commands:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#Syntax"},(0,o.kt)("inlineCode",{parentName:"a"},"Cypress.Commands.add()"))," - use to add a custom command to use when\nwriting tests"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#Overwrite-Existing-Commands"},(0,o.kt)("inlineCode",{parentName:"a"},"Cypress.Command.overwrite()"))," - use to\noverride an existing built-in Cypress command or reserved internal function.\n",(0,o.kt)("strong",{parentName:"li"},"Caution:")," this overrides it for Cypress as well and could impact how\nCypress behaves.")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"If you want your method to have builtin\n",(0,o.kt)("a",{parentName:"p",href:"/guides/core-concepts/retry-ability"},"retry-ability"),", and especially if you\nreturn a DOM element for further commands to act on, consider writing a\n",(0,o.kt)("a",{parentName:"p",href:"/api/cypress-api/custom-queries"},"custom query")," instead.")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"We recommend defining queries is in your ",(0,o.kt)("inlineCode",{parentName:"p"},"cypress/support/commands.js")," file,\nsince it is loaded before any test files are evaluated via an import statement\nin the\n",(0,o.kt)("a",{parentName:"p",href:"/guides/core-concepts/writing-and-organizing-tests#Support-file"},"supportFile"),".")),(0,o.kt)("h2",{id:"Syntax"},"Syntax"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"Cypress.Commands.add(name, callbackFn)\nCypress.Commands.add(name, options, callbackFn)\nCypress.Commands.addAll(callbackObj)\nCypress.Commands.addAll(options, callbackObj)\nCypress.Commands.overwrite(name, callbackFn)\n")),(0,o.kt)("h3",{id:"Usage"},"Usage"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)(c,{name:"check-circle",color:"green",mdxType:"Icon"})," Correct Usage")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"Cypress.Commands.add('login', (email, pw) => {})\nCypress.Commands.addAll({\n  login(email, pw) {},\n  visit(orig, url, options) {},\n})\nCypress.Commands.overwrite('visit', (orig, url, options) => {})\n")),(0,o.kt)("h3",{id:"Arguments"},"Arguments"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)(c,{name:"angle-right",mdxType:"Icon"})," name")," ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"(String)"))),(0,o.kt)("p",null,"The name of the command you're either adding or overwriting."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)(c,{name:"angle-right",mdxType:"Icon"})," callbackFn")," ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"(Function)"))),(0,o.kt)("p",null,"Pass a function that receives the arguments passed to the command."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)(c,{name:"angle-right",mdxType:"Icon"})," callbackObj")," ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"(Object)"))),(0,o.kt)("p",null,"An object with ",(0,o.kt)("inlineCode",{parentName:"p"},"callbackFn"),"s as properties."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)(c,{name:"angle-right",mdxType:"Icon"})," options")," ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"(Object)"))),(0,o.kt)("p",null,"Pass in an options object to define the implicit behavior of the custom command."),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("inlineCode",{parentName:"p"},"options")," is only supported for use in ",(0,o.kt)("inlineCode",{parentName:"p"},"Cypress.Commands.add()")," and not\nsupported for use in ",(0,o.kt)("inlineCode",{parentName:"p"},"Cypress.Commands.overwrite()"))),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Option"),(0,o.kt)("th",{parentName:"tr",align:null},"Accepts"),(0,o.kt)("th",{parentName:"tr",align:null},"Default"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"prevSubject")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Boolean"),", ",(0,o.kt)("inlineCode",{parentName:"td"},"String")," or ",(0,o.kt)("inlineCode",{parentName:"td"},"Array")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"false")),(0,o.kt)("td",{parentName:"tr",align:null},"how to handle the previously yielded subject.")))),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"prevSubject")," accepts the following values:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"false"),": ignore any previous subjects: ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("em",{parentName:"strong"},"(parent command)"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"true"),": receives the previous subject: ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("em",{parentName:"strong"},"(child command)"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"optional"),": may start a chain, or use an existing chain: ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("em",{parentName:"strong"},"(dual command)")))),(0,o.kt)("p",null,"In addition to controlling the command's implicit behavior you can also add\ndeclarative subject validations such as:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"element"),": requires the previous subject be a DOM element"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"document"),": requires the previous subject be the document"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"window"),": requires the previous subject be the window")),(0,o.kt)("h2",{id:"Examples"},"Examples"),(0,o.kt)("h3",{id:"Parent-Commands"},"Parent Commands"),(0,o.kt)("p",null,"Parent commands always ",(0,o.kt)("strong",{parentName:"p"},"begin")," a new chain of commands. Even if you've chained\nit off of a previous command, parent commands will always start a new chain, and\nignore previously yielded subjects."),(0,o.kt)("p",null,"Examples of parent commands:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/api/commands/visit"},(0,o.kt)("inlineCode",{parentName:"a"},"cy.visit()"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/api/commands/request"},(0,o.kt)("inlineCode",{parentName:"a"},"cy.request()"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/api/commands/exec"},(0,o.kt)("inlineCode",{parentName:"a"},"cy.exec()"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/api/commands/intercept"},(0,o.kt)("inlineCode",{parentName:"a"},"cy.intercept()")))),(0,o.kt)("h4",{id:"Click-link-containing-text"},"Click link containing text"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"Cypress.Commands.add('clickLink', (label) => {\n  cy.get('a').contains(label).click()\n})\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"cy.clickLink('Buy Now')\n")),(0,o.kt)("h4",{id:"Check-a-token"},"Check a token"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"Cypress.Commands.add('checkToken', (token) => {\n  cy.window().its('localStorage.token').should('eq', token)\n})\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"cy.checkToken('abc123')\n")),(0,o.kt)("h4",{id:"Download-a-file"},"Download a file"),(0,o.kt)("p",null,"Originally used in\n",(0,o.kt)("a",{parentName:"p",href:"https://github.com/Xvier/cypress-downloadfile"},"cypress-downloadfile"),", this\ncommand calls other Cypress commands."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"Cypress.Commands.add('downloadFile', (url, directory, fileName) => {\n  return cy.getCookies().then((cookies) => {\n    return cy.task('downloadFile', {\n      url,\n      directory,\n      cookies,\n      fileName,\n    })\n  })\n})\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"cy.downloadFile('https://path_to_file.pdf', 'mydownloads', 'demo.pdf')\n")),(0,o.kt)("h4",{id:"Commands-to-work-with-sessionStorage"},"Commands to work with ",(0,o.kt)("inlineCode",{parentName:"h4"},"sessionStorage")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"Cypress.Commands.add('getSessionStorage', (key) => {\n  cy.window().then((window) => window.sessionStorage.getItem(key))\n})\n\nCypress.Commands.add('setSessionStorage', (key, value) => {\n  cy.window().then((window) => {\n    window.sessionStorage.setItem(key, value)\n  })\n})\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"cy.setSessionStorage('token', 'abc123')\ncy.getSessionStorage('token').should('eq', 'abc123')\n")),(0,o.kt)("h4",{id:"Log-in-command-using-UI"},"Log in command using UI"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"Cypress.Commands.add('loginViaUi', (user) => {\n  cy.session(\n    user,\n    () => {\n      cy.visit('/login')\n      cy.get('input[name=email]').type(user.email)\n      cy.get('input[name=password]').type(user.password)\n      cy.click('button#login')\n      cy.get('h1').contains(`Welcome back ${user.name}!`)\n    },\n    {\n      validate: () => {\n        cy.getCookie('auth_key').should('exist')\n      },\n    }\n  )\n})\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"cy.loginViaUi({ email: 'fake@email.com', password: '$ecret1', name: 'johndoe' })\n")),(0,o.kt)("h4",{id:"Log-in-command-using-request"},"Log in command using request"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"Cypress.Commands.add('loginViaApi', (userType, options = {}) => {\n  // this is an example of skipping your UI and logging in programmatically\n\n  // setup some basic types\n  // and user properties\n  const types = {\n    admin: {\n      name: 'Jane Lane',\n      admin: true,\n    },\n    user: {\n      name: 'Jim Bob',\n      admin: false,\n    },\n  }\n\n  // grab the user\n  const user = types[userType]\n\n  // create the user first in the DB\n  cy.request({\n    url: '/seed/users', // assuming you've exposed a seeds route\n    method: 'POST',\n    body: user,\n  })\n    .its('body')\n    .then((body) => {\n      // assuming the server sends back the user details\n      // including a randomly generated password\n      //\n      // we can now login as this newly created user\n      cy.request({\n        url: '/login',\n        method: 'POST',\n        body: {\n          email: body.email,\n          password: body.password,\n        },\n      })\n    })\n})\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"// can start a chain off of cy\ncy.loginViaApi('admin')\n\n// can be chained but will not receive the previous subject\ncy.get('button').loginViaApi('user')\n")),(0,o.kt)("h4",{id:"Log-out-command-using-UI"},"Log out command using UI"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"Cypress.Commands.add('logout', () => {\n  cy.contains('Login').should('not.exist')\n  cy.get('.avatar').click()\n  cy.contains('Logout').click()\n  cy.get('h1').contains('Login')\n  cy.getCookie('auth_key').should('not.exist')\n})\n")),(0,o.kt)("h4",{id:"Log-out-command-using-localStorage"},"Log out command using ",(0,o.kt)("inlineCode",{parentName:"h4"},"localStorage")," ",(0,o.kt)(d,{mdxType:"E2EOnlyBadge"})),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"Cypress.Commands.add('logout', () => {\n  cy.window().its('localStorage').invoke('removeItem', 'session')\n\n  cy.visit('/login')\n})\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"cy.logout()\n")),(0,o.kt)("h4",{id:"Create-a-user"},"Create a user"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"Cypress.Commands.add('createUser', (user) => {\n  cy.request({\n    method: 'POST',\n    url: 'https://www.example.com/tokens',\n    body: {\n      email: 'admin_username',\n      password: 'admin_password',\n    },\n  }).then((resp) => {\n    cy.request({\n      method: 'POST',\n      url: 'https://www.example.com/users',\n      headers: { Authorization: 'Bearer ' + resp.body.token },\n      body: user,\n    })\n  })\n})\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"cy.createUser({\n  id: 123,\n  name: 'Jane Lane',\n})\n")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("strong",null,"Command Log"),(0,o.kt)("p",{parentName:"admonition"},"Did you know that you can control how your custom commands appear in the Command\nLog? Read more about ",(0,o.kt)("a",{parentName:"p",href:"#Command-Logging"},"Command Logging"),".")),(0,o.kt)("h3",{id:"Child-Commands"},"Child Commands"),(0,o.kt)("p",null,"Child commands are always chained off of a ",(0,o.kt)("strong",{parentName:"p"},"parent")," command, or another\n",(0,o.kt)("strong",{parentName:"p"},"child")," command."),(0,o.kt)("p",null,"The previous subject will automatically be yielded to the callback function."),(0,o.kt)("p",null,"Examples of child commands:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/api/commands/click"},(0,o.kt)("inlineCode",{parentName:"a"},".click()"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/api/commands/submit"},(0,o.kt)("inlineCode",{parentName:"a"},".submit()"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/api/commands/trigger"},(0,o.kt)("inlineCode",{parentName:"a"},".trigger()")))),(0,o.kt)("h4",{id:"Custom-console-command"},"Custom ",(0,o.kt)("inlineCode",{parentName:"h4"},"console")," command"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"// not a super useful custom command\n// but demonstrates how subject is passed\n// and how the arguments are shifted\nCypress.Commands.add(\n  'console',\n  {\n    prevSubject: true,\n  },\n  (subject, method) => {\n    // the previous subject is automatically received\n    // and the commands arguments are shifted\n\n    // allow us to change the console method used\n    method = method || 'log'\n\n    // log the subject to the console\n    console[method]('The subject is', subject)\n\n    // whatever we return becomes the new subject\n    //\n    // we don't want to change the subject so\n    // we return whatever was passed in\n    return subject\n  }\n)\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"cy.get('button')\n  .console('info')\n  .then(($button) => {\n    // subject is still $button\n  })\n")),(0,o.kt)("p",null,"By setting the ",(0,o.kt)("inlineCode",{parentName:"p"},"{ prevSubject: true }"),", our new ",(0,o.kt)("inlineCode",{parentName:"p"},".console()")," command will\nrequire a subject."),(0,o.kt)("p",null,"Invoking it like this would error:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"cy.console() // error about how you can't call console without a subject\n")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Whenever you're using a child command you likely want to use\n",(0,o.kt)("a",{parentName:"p",href:"/api/commands/wrap"},"cy.wrap()")," on the subject. Wrapping it enables you to\nimmediately use more Cypress commands on that subject.")),(0,o.kt)("h3",{id:"Dual-Commands"},"Dual Commands"),(0,o.kt)("p",null,"A dual command can either start a chain of commands or be chained off of an\nexisting one. It is basically the hybrid between both a parent and a child\ncommand. You will likely rarely use this, and only a handful of our internal\ncommands use this."),(0,o.kt)("p",null,"Nevertheless, it is useful if your command can work in multiple ways - either\nwith an existing subject or without one."),(0,o.kt)("p",null,"Examples of dual commands:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/api/commands/screenshot"},(0,o.kt)("inlineCode",{parentName:"a"},"cy.screenshot()"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/api/commands/scrollto"},(0,o.kt)("inlineCode",{parentName:"a"},"cy.scrollTo()"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/api/commands/wait"},(0,o.kt)("inlineCode",{parentName:"a"},"cy.wait()")))),(0,o.kt)("h4",{id:"Custom-Dual-Command"},"Custom Dual Command"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"Cypress.Commands.add('dismiss', {\n  prevSubject: 'optional'\n}, (subject, arg1, arg2) => {\n  // subject may be defined or undefined\n  // so you likely want to branch the logic\n  // based off of that\n\n  if (subject) {\n    // wrap the existing subject\n    // and do something with it\n    cy.wrap(subject)\n    ...\n  } else {\n    ...\n  }\n})\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"cy.dismiss() // no subject\ncy.get('#dialog').dismiss() // with subject\n")),(0,o.kt)("h3",{id:"Overwrite-Existing-Commands"},"Overwrite Existing Commands"),(0,o.kt)("p",null,"You can also modify the behavior of existing Cypress commands. This is useful to\nalways set some defaults to avoid creating another command that ends up using\nthe original."),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("inlineCode",{parentName:"p"},"Cypress.Commands.overwrite")," can only overwrite commands, not queries. If you\nwant to modify the behavior of a query, you'll need to use\n",(0,o.kt)("a",{parentName:"p",href:"/api/cypress-api/custom-queries"},(0,o.kt)("inlineCode",{parentName:"a"},"Cypress.Commands.overwriteQuery"))," instead.")),(0,o.kt)("h4",{id:"Overwrite-visit-command"},"Overwrite ",(0,o.kt)("inlineCode",{parentName:"h4"},"visit")," command"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"Cypress.Commands.overwrite('visit', (originalFn, url, options) => {\n  const domain = Cypress.env('BASE_DOMAIN')\n\n  if (domain === '...') {\n    url = '...'\n  }\n\n  if (options.something === 'else') {\n    url = '...'\n  }\n\n  // originalFn is the existing `visit` command that you need to call\n  // and it will receive whatever you pass in here.\n  //\n  // make sure to add a return here!\n  return originalFn(url, options)\n})\n")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"We see many of our users creating their own ",(0,o.kt)("inlineCode",{parentName:"p"},"visitApp")," command. We commonly see\nthat all you're doing is swapping out base urls for ",(0,o.kt)("inlineCode",{parentName:"p"},"development")," vs\n",(0,o.kt)("inlineCode",{parentName:"p"},"production")," environments."),(0,o.kt)("p",{parentName:"admonition"},"This is usually unnecessary because Cypress is already configured to swap out a\n",(0,o.kt)("inlineCode",{parentName:"p"},"baseUrl")," that both ",(0,o.kt)("a",{parentName:"p",href:"/api/commands/visit"},"cy.visit()")," and\n",(0,o.kt)("a",{parentName:"p",href:"/api/commands/request"},"cy.request()")," use. Set the ",(0,o.kt)("inlineCode",{parentName:"p"},"baseUrl")," configuration\nproperty in your ",(0,o.kt)("a",{parentName:"p",href:"/guides/references/configuration"},"Cypress configuration")," and\noverride it with the ",(0,o.kt)("inlineCode",{parentName:"p"},"CYPRESS_BASE_URL")," environment variable."),(0,o.kt)("p",{parentName:"admonition"},"For more complex use cases feel free to overwrite existing commands.")),(0,o.kt)("h4",{id:"Overwrite-type-command"},"Overwrite ",(0,o.kt)("inlineCode",{parentName:"h4"},"type")," command"),(0,o.kt)("p",null,"If you are typing into a password field, the password input is masked\nautomatically within your application. But ",(0,o.kt)("a",{parentName:"p",href:"/api/commands/type"},".type()"),"\nautomatically logs any typed content into the Cypress Command Log."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"cy.get('#username').type('username@email.com')\ncy.get('#password').type('superSecret123')\n")),(0,o.kt)(u,{src:"/img/api/custom-commands/custom-command-type-no-masked-password.png",mdxType:"DocsImage"}),(0,o.kt)("p",null,"You may want to mask some values passed to the ",(0,o.kt)("a",{parentName:"p",href:"/api/commands/type"},".type()"),"\ncommand so that sensitive data does not display in screenshots or videos of your\ntest run. This example overwrites the ",(0,o.kt)("a",{parentName:"p",href:"/api/commands/type"},".type()")," command to\nallow you to mask sensitive data in the Cypress Command Log."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"Cypress.Commands.overwrite('type', (originalFn, element, text, options) => {\n  if (options && options.sensitive) {\n    // turn off original log\n    options.log = false\n    // create our own log with masked message\n    Cypress.log({\n      $el: element,\n      name: 'type',\n      message: '*'.repeat(text.length),\n    })\n  }\n\n  return originalFn(element, text, options)\n})\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"cy.get('#username').type('username@email.com')\ncy.get('#password').type('superSecret123', { sensitive: true })\n")),(0,o.kt)("p",null,"Now our sensitive password is not printed to the Cypress Command Log when\n",(0,o.kt)("inlineCode",{parentName:"p"},"sensitive: true")," is passed as an option to ",(0,o.kt)("a",{parentName:"p",href:"/api/commands/type"},".type()"),"."),(0,o.kt)(u,{src:"/img/api/custom-commands/custom-command-type-masked-password.png",mdxType:"DocsImage"}),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("strong",null,"Keep passwords secret blog"),(0,o.kt)("p",{parentName:"admonition"},"Check out\n",(0,o.kt)("a",{parentName:"p",href:"https://glebbahmutov.com/blog/keep-passwords-secret-in-e2e-tests/"},"this blog"),"\nto explore another way to keep passwords secret within your tests.")),(0,o.kt)("h4",{id:"Overwrite-screenshot-command"},"Overwrite ",(0,o.kt)("inlineCode",{parentName:"h4"},"screenshot")," command"),(0,o.kt)("p",null,"This example overwrites ",(0,o.kt)("a",{parentName:"p",href:"/api/commands/screenshot"},"cy.screenshot()")," to always\nwait until a certain element is visible."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"Cypress.Commands.overwrite(\n  'screenshot',\n  (originalFn, subject, fileName, options) => {\n    // call another command, no need to return as it is managed\n    cy.get('.app')\n      .should('be.visible')\n\n      // overwrite the default timeout, because screenshot does that internally\n      // otherwise the `then` is limited to the default command timeout\n      .then({ timeout: Cypress.config('responseTimeout') }, () => {\n        // return the original function so that cypress waits for it\n        return originalFn(subject, fileName, options)\n      })\n  }\n)\n")),(0,o.kt)("h4",{id:"Overwrite-click-command"},"Overwrite ",(0,o.kt)("inlineCode",{parentName:"h4"},"click")," command"),(0,o.kt)("p",null,"This example overwrites ",(0,o.kt)("a",{parentName:"p",href:"/api/commands/click"},".click()")," to always have the\n",(0,o.kt)("inlineCode",{parentName:"p"},"waitForAnimations")," option set to ",(0,o.kt)("inlineCode",{parentName:"p"},"false"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"Cypress.Commands.overwrite(\n  'click',\n  (originalFn, subject, positionOrX, y, options = {}) => {\n    options.waitForAnimations = false\n    return originalFn(subject, positionOrX, y, options)\n  }\n)\n")),(0,o.kt)("h3",{id:"Set-Browser-Language"},"Set Browser Language"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},'it("The i18n translates the text to English when the browser language is English", () => {\n  cy.setBrowserLanguage("en-US", ["en"], ["en"]);\n  cy.get("input[id=noteTitleInput]").should("have.value", "Untitled Note");\n});\n\nit("The i18n translates the text to Chinese when the browser language is Chinese", () => {\n  cy.setBrowserLanguage("zh-CN", ["zh"], ["zh"]);\n  cy.get("input[id=noteTitleInput]").should("have.value", "\u65e0\u6807\u9898\u7b14\u8bb0");\n});\n')),(0,o.kt)("p",null,"In ",(0,o.kt)("em",{parentName:"p"},"cypress/support/commands.ts"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},'Cypress.Commands.add("setBrowserLanguage", (language, languages, acceptLanguages) => {\n  cy.visit("http://localhost:3000/", {\n    onBeforeLoad(win) {\n      Object.defineProperty(win.navigator, "language", { value: language });\n      Object.defineProperty(win.navigator, "languages", { value: languages });\n      Object.defineProperty(win.navigator, "accept_languages", { value: acceptLanguages });\n    },\n  });\n});\n')),(0,o.kt)("p",null,"And in ",(0,o.kt)("a",{parentName:"p",href:"/guides/tooling/typescript-support#Types-for-Custom-Commands"},(0,o.kt)("strong",{parentName:"a"},"cypress.d.ts")," definition file"),", we add"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},'declare namespace Cypress {\n  interface Chainable<Subject> {\n    /**\n     * Login via UI\n     *\n     * @example cy.login({username: "user", password: "password"})\n     */\n    login({ username, password }: Record<string, string>): Chainable<void>;\n\n    ...\n    // highlight-start\n    setBrowserLanguage(language: string, languages: string[], acceptLanguages: string[]): Chainable<void>;\n    // highlight-end\n  }\n}\n')),(0,o.kt)("h2",{id:"Validations"},"Validations"),(0,o.kt)("p",null,"As noted in the ",(0,o.kt)("a",{parentName:"p",href:"#Arguments"},"Arguments")," above, you can also set ",(0,o.kt)("inlineCode",{parentName:"p"},"prevSubject")," to\none of:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"element")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"document")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"window"))),(0,o.kt)("p",null,"When doing so Cypress will automatically validate your subject to ensure it\nconforms to one of those types."),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Adding validations is optional. Passing ",(0,o.kt)("inlineCode",{parentName:"p"},"{ prevSubject: true }")," will require a\nsubject, but not validate its type.")),(0,o.kt)("h3",{id:"Require-Element"},"Require Element"),(0,o.kt)("p",null,"Require subject be of type: ",(0,o.kt)("inlineCode",{parentName:"p"},"element"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"// this is how .click() is implemented\nCypress.Commands.add(\n  'click',\n  {\n    prevSubject: 'element',\n  },\n  (subject, options) => {\n    // receives the previous subject and it's\n    // guaranteed to be an element\n  }\n)\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)(c,{name:"check-circle",color:"green",mdxType:"Icon"})," Valid Usage")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"cy.get('button').click() // has subject, and is `element`\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)(c,{name:"exclamation-triangle",color:"red",mdxType:"Icon"})," Invalid Usage")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"cy.click() // no subject, will error\ncy.wrap([]).click() // has subject, but not `element`, will error\n")),(0,o.kt)("h3",{id:"Allow-Multiple-Types"},"Allow Multiple Types"),(0,o.kt)("h4",{id:"trigger"},(0,o.kt)("inlineCode",{parentName:"h4"},".trigger()")),(0,o.kt)("p",null,"Require subject be one of the following types: ",(0,o.kt)("inlineCode",{parentName:"p"},"element"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"document")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"window")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"// this is how .trigger() is implemented\nCypress.Commands.add(\n  'trigger',\n  {\n    prevSubject: ['element', 'document', 'window'],\n  },\n  (subject, eventName, options) => {\n    // receives the previous subject and it's\n    // guaranteed to be an element, document, or window\n  }\n)\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)(c,{name:"check-circle",color:"green",mdxType:"Icon"})," Valid Usage")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"cy.get('button').trigger() // has subject, and is `element`\ncy.document().trigger() // has subject, and is `document`\ncy.window().trigger() // has subject, and is `window`\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)(c,{name:"exclamation-triangle",color:"red",mdxType:"Icon"})," Invalid Usage")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"cy.trigger() // no subject, will error\ncy.wrap(true).trigger() // has subject, but not `element`, will error\n")),(0,o.kt)("p",null,'Validations always work as "or" not "and".'),(0,o.kt)("h3",{id:"Optional-with-Types"},"Optional with Types"),(0,o.kt)("p",null,"You can also mix optional commands ",(0,o.kt)("strong",{parentName:"p"},"with")," validations."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"// this is how .scrollTo() is implemented\nCypress.Commands.add(\n  'scrollTo',\n  {\n    prevSubject: ['optional', 'element', 'window'],\n  },\n  (subject, ...args) => {\n    // subject could be undefined\n    // since it's optional.\n    //\n    // if it's present then it's and element or window.\n    // - when window, we'll scroll to a position on the page.\n    // - when element, we'll scroll to a position related to the element.\n    if (subject) {\n      // ...\n    } else {\n      // ...\n    }\n  }\n)\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)(c,{name:"check-circle",color:"green",mdxType:"Icon"})," Valid Usage")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"cy.scrollTo() // no subject, but valid because it's optional\ncy.get('#main').scrollTo() // has subject, and is `element`\ncy.visit().scrollTo() // has subject, and since visit yields `window` it's ok\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)(c,{name:"exclamation-triangle",color:"red",mdxType:"Icon"})," Invalid Usage")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"cy.document().scrollTo() // has subject, but it's a `document`, will error\ncy.wrap(null).scrollTo() // has subject, but it's `null`, will error\n")),(0,o.kt)("h2",{id:"Notes"},"Notes"),(0,o.kt)("h3",{id:"Command-Logging"},"Command Logging"),(0,o.kt)("p",null,"When creating your own custom command, you can control how it appears and\nbehaves in the Command Log."),(0,o.kt)("p",null,"Take advantage of the ",(0,o.kt)("a",{parentName:"p",href:"/api/cypress-api/cypress-log"},(0,o.kt)("inlineCode",{parentName:"a"},"Cypress.log()"))," API. When\nyou're issuing many internal Cypress commands, consider passing ",(0,o.kt)("inlineCode",{parentName:"p"},"{ log: false }"),"\nto those commands, and programmatically controlling your custom command. This\nwill cleanup the Command Log and be much more visually appealing and\nunderstandable."),(0,o.kt)("h3",{id:"cyhover-and-cymount"},(0,o.kt)("inlineCode",{parentName:"h3"},"cy.hover()")," and ",(0,o.kt)("inlineCode",{parentName:"h3"},"cy.mount()")),(0,o.kt)("p",null,"Cypress does not have ",(0,o.kt)("inlineCode",{parentName:"p"},"cy.hover()")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"cy.mount()")," commands out-of-the-box. See\nhow to craft your own ",(0,o.kt)("a",{parentName:"p",href:"/api/commands/hover"},(0,o.kt)("inlineCode",{parentName:"a"},"cy.hover()"))," and\n",(0,o.kt)("a",{parentName:"p",href:"/api/commands/mount"},(0,o.kt)("inlineCode",{parentName:"a"},"cy.mount()"))," custom commands."),(0,o.kt)("h3",{id:"Best-Practices"},"Best Practices"),(0,o.kt)("h4",{id:"1-Dont-make-everything-a-custom-command"},"1. Don't make everything a custom command"),(0,o.kt)("p",null,"Custom commands work well when you're needing to describe behavior that's\ndesirable across ",(0,o.kt)("strong",{parentName:"p"},"all of your tests"),". Examples would be a ",(0,o.kt)("inlineCode",{parentName:"p"},"cy.setup()")," or\n",(0,o.kt)("inlineCode",{parentName:"p"},"cy.login()")," or extending your application's behavior like\n",(0,o.kt)("inlineCode",{parentName:"p"},"cy.get('.dropdown').dropdown('Apples')"),". These are specific to your application\nand can be used everywhere."),(0,o.kt)("p",null,"However, this pattern can be used and abused. Let's not forget - writing Cypress\ntests is ",(0,o.kt)("strong",{parentName:"p"},"JavaScript"),", and it's often more efficient to write a function for\nrepeatable behavior that's specific to only ",(0,o.kt)("strong",{parentName:"p"},"a single spec file"),"."),(0,o.kt)("p",null,"If you're working on a ",(0,o.kt)("inlineCode",{parentName:"p"},"search.cy.js")," file and want to compose several\nrepeatable actions together, you should first ask yourself:"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Can this be written as a function?")),(0,o.kt)("p",null,"The answer is usually ",(0,o.kt)("strong",{parentName:"p"},"yes"),". Here's an example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"// There's no reason to create something like a cy.search() custom\n// command because this behavior is only applicable to a single spec file\n//\n// Use a regular ol' javascript function folks!\nconst search = (term, options = {}) => {\n  // example massaging to defaults\n  _.defaults(options, {\n    headers: {},\n  })\n\n  const { fixture, headers } = options\n\n  // return cy chain here so we can\n  // chain off this function below\n  return cy\n    .log(`Searching for: ${term} `)\n    .intercept('GET', '/search/**', (req) => {\n      req.reply({\n        statusCode: 200,\n        body: `fixture:${fixture}`,\n        headers: headers,\n      })\n    })\n    .as('getSearchResults')\n    .get('#search')\n    .type(term)\n    .wait('@getSearchResults')\n}\n\nit('displays a list of search results', () => {\n  cy.visit('/page')\n    .then(() => {\n      search('cypress.io', {\n        fixture: 'list',\n      }).then((reqRes) => {\n        // do something with the '@getSearchResults'\n        // request such as make assertions on the\n        // request body or url params\n        // {\n        //   url: 'http://app.com/search?cypress.io'\n        //   method: 'GET',\n        //   duration: 123,\n        //   request: {...},\n        //   response: {...},\n        // }\n      })\n    })\n    .get('#results li')\n    .should('have.length', 5)\n    .get('#pagination')\n    .should('not.exist')\n})\n\nit('displays no search results', () => {\n  cy.visit('/page')\n    .then(() => {\n      search('cypress.io', {\n        fixture: 'zero',\n      })\n    })\n    .get('#results')\n    .should('contain', 'No results found')\n})\n\nit('paginates many search results', () => {\n  cy.visit('/page')\n    .then(() => {\n      search('cypress.io', {\n        fixture: 'list',\n        headers: {\n          // trick our app into thinking\n          // there's a bunch of pages\n          'x-pagination-total': 3,\n        },\n      })\n    })\n    .get('#pagination')\n    .should(($pagination) => {\n      // should offer to goto next page\n      expect($pagination).to.contain('Next')\n\n      // should have provided 3 page links\n      expect($pagination.find('li.page')).to.have.length(3)\n    })\n})\n")),(0,o.kt)("h4",{id:"2-Dont-overcomplicate-things"},"2. Don't overcomplicate things"),(0,o.kt)("p",null,"Custom commands you write are generally an abstraction over a series of internal\ncommands. That means you and your team members exert much more mental effort to\nunderstand what your custom command does."),(0,o.kt)("p",null,"There's no reason to add this level of complexity when you're only wrapping a\ncouple commands."),(0,o.kt)("p",null,"Don't do things like:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},(0,o.kt)(c,{name:"exclamation-triangle",color:"red",mdxType:"Icon"}))," ",(0,o.kt)("inlineCode",{parentName:"li"},"cy.clickButton(selector)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},(0,o.kt)(c,{name:"exclamation-triangle",color:"red",mdxType:"Icon"}))," ",(0,o.kt)("inlineCode",{parentName:"li"},".shouldBeVisible()"))),(0,o.kt)("p",null,"This first custom command is wrapping ",(0,o.kt)("inlineCode",{parentName:"p"},"cy.get(selector).click()"),". Going down\nthis route would lead to creating dozens or even hundreds of custom commands to\ncover every possible combination of element interactions. It's completely\nunnecessary."),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},".shouldBeVisible()")," custom command isn't worth the trouble or abstraction\nwhen you can already use: ",(0,o.kt)("inlineCode",{parentName:"p"},".should('be.visible')")),(0,o.kt)("p",null,"Testing in Cypress is all about ",(0,o.kt)("strong",{parentName:"p"},"readability")," and ",(0,o.kt)("strong",{parentName:"p"},"simplicity"),". You don't\nhave to do that much actual programming to get a lot done. You also don't need\nto worry about keeping your code as DRY as possible. Test code serves a\ndifferent purpose than app code. Understandability and debuggability should be\nprioritized above all else."),(0,o.kt)("p",null,"Try not to overcomplicate things and create too many abstractions. When in\ndoubt, use a regular function for individual spec files."),(0,o.kt)("h4",{id:"3-Dont-do-too-much-in-a-single-command"},"3. Don't do too much in a single command"),(0,o.kt)("p",null,"Make your custom commands composable and as unopinionated as possible. Cramming\ntoo much into them makes them inflexible and requires more and more options\npassing to control their behavior."),(0,o.kt)("p",null,"Try to add either zero or as few assertions as possible in your custom command.\nThose tend to shape your command into a much more rigid structure. Sometimes\nthis is unavoidable, but a best practice is to let the calling code choose when\nand how to use assertions."),(0,o.kt)("h4",{id:"4-Skip-your-UI-as-much-as-possible"},"4. Skip your UI as much as possible"),(0,o.kt)("p",null,"Custom commands are a great way to abstract away setup (specific to your app).\nWhen doing those kinds of tasks, skip as much of the UI as possible. Use\n",(0,o.kt)("a",{parentName:"p",href:"/api/commands/request"},(0,o.kt)("inlineCode",{parentName:"a"},"cy.request()"))," to login, set cookies or localStorage\ndirectly, stub and mock your applications functions, and / or trigger events\nprogrammatically."),(0,o.kt)("p",null,"Having custom commands repeat the same UI actions over and over again is slow,\nand unnecessary. Try to take as many shortcuts as possible."),(0,o.kt)("h4",{id:"5-Write-TypeScript-definitions"},"5. Write TypeScript definitions"),(0,o.kt)("p",null,"You can describe the method signature for your custom command, allowing\nIntelliSense to show helpful documentation. See the\n",(0,o.kt)("a",{parentName:"p",href:"https://github.com/cypress-io/cypress-example-todomvc#cypress-intellisense"},(0,o.kt)("inlineCode",{parentName:"a"},"cypress-example-todomvc")),"\nrepository for a working example."),(0,o.kt)("h4",{id:"6-Create-a-function-that-adds-the-custom-command"},"6. Create a function that adds the custom command"),(0,o.kt)("p",null,"Cypress ",(0,o.kt)("a",{parentName:"p",href:"/guides/references/changelog#12-17-4"},"12.17.4")," includes a Webpack upgrade (v4 to v5), which ",(0,o.kt)("a",{parentName:"p",href:"https://webpack.js.org/blog/2020-10-10-webpack-5-release/#inner-module-tree-shaking"},"tree shakes out")," any side-effects or files that ",(0,o.kt)("em",{parentName:"p"},"only")," include side-effects."),(0,o.kt)("p",null,"If you are using TypeScript and have Webpack's ",(0,o.kt)("inlineCode",{parentName:"p"},"sideEffects:false")," set in your package.json, custom Cypress commands will not be registered by the common pattern of writing the commands in one file and having them be run as a side effect of importing the file. For example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},'// cypress/support/commands.ts\nCypress.Commands.add("login", (email, password) => { ... })\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"// cypress/support/e2e.ts\nimport './commands'\n")),(0,o.kt)("p",null,"To support ",(0,o.kt)("inlineCode",{parentName:"p"},"sideEffects:false"),", you can wrap the Cypress commands in a function that will be imported by the support file."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},'// cypress/support/commands.ts\nexport function registerCommands(){\n  Cypress.Commands.add("login", (email, password) => { ... })\n}\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"// cypress/support/e2e.ts\nimport { registerCommands } from './commands'\n\nregisterCommands()\n")),(0,o.kt)("h2",{id:"History"},"History"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Version"),(0,o.kt)("th",{parentName:"tr",align:null},"Changes"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"/guides/references/changelog#0-20-0"},"0.20.0")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Cypress.Commands")," API added")))),(0,o.kt)("h2",{id:"See-also"},"See also"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"See how to add\n",(0,o.kt)("a",{parentName:"li",href:"/guides/tooling/typescript-support#Types-for-Custom-Commands"},"TypeScript support for custom commands")),(0,o.kt)("li",{parentName:"ul"},"Blog posts\n",(0,o.kt)("a",{parentName:"li",href:"https://glebbahmutov.com/blog/writing-custom-cypress-command/"},"Writing a Custom Cypress Command"),"\nand\n",(0,o.kt)("a",{parentName:"li",href:"https://glebbahmutov.com/blog/publishing-cypress-command/"},"How to Publish Custom Cypress Command on NPM"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/plugins#custom-commands"},"Plugins using custom commands")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/api/cypress-api/cypress-log"},"Cypress.log()")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/examples/recipes#Logging-In"},"Recipe: Logging In"))))}k.isMDXComponent=!0}}]);