"use strict";(self.webpackChunkcypress_docusaurus_ts=self.webpackChunkcypress_docusaurus_ts||[]).push([[8275],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=a.createContext({}),m=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=m(e.components);return a.createElement(l.Provider,{value:t},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,p=r(e,["components","mdxType","originalType","parentName"]),c=m(n),d=i,h=c["".concat(l,".").concat(d)]||c[d]||u[d]||o;return n?a.createElement(h,s(s({ref:t},p),{},{components:n})):a.createElement(h,s({ref:t},p))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,s=new Array(o);s[0]=d;var r={};for(var l in t)hasOwnProperty.call(t,l)&&(r[l]=t[l]);r.originalType=e,r[c]="string"==typeof e?e:i,s[1]=r;for(var m=2;m<o;m++)s[m]=n[m];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},8559:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>k,frontMatter:()=>o,metadata:()=>r,toc:()=>m});var a=n(7462),i=(n(7294),n(3905));const o={title:"Introduction to Cypress",sidebar_position:10},s=void 0,r={unversionedId:"guides/core-concepts/introduction-to-cypress",id:"guides/core-concepts/introduction-to-cypress",title:"Introduction to Cypress",description:"What you'll learn",source:"@site/docs/guides/core-concepts/introduction-to-cypress.mdx",sourceDirName:"guides/core-concepts",slug:"/guides/core-concepts/introduction-to-cypress",permalink:"/cypress-documentation/guides/core-concepts/introduction-to-cypress",draft:!1,editUrl:"https://github.com/cypress-io/cypress-documentation/tree/main/docs/guides/core-concepts/introduction-to-cypress.mdx",tags:[],version:"current",lastUpdatedAt:1696480060,formattedLastUpdatedAt:"Oct 5, 2023",sidebarPosition:10,frontMatter:{title:"Introduction to Cypress",sidebar_position:10},sidebar:"guides",previous:{title:"Integrating with Cypress Component Testing",permalink:"/cypress-documentation/guides/component-testing/third-party-definitions"},next:{title:"Testing Types",permalink:"/cypress-documentation/guides/core-concepts/testing-types"}},l={},m=[{value:"Cypress Can Be Simple (Sometimes)",id:"Cypress-Can-Be-Simple-Sometimes",level:2},{value:"Querying Elements",id:"Querying-Elements",level:2},{value:"Cypress is Like jQuery",id:"Cypress-is-Like-jQuery",level:3},{value:"Cypress is <em>Not</em> Like jQuery",id:"Cypress-is-Not-Like-jQuery",level:3},{value:"1. The element is found",id:"1-The-element-is-found",level:4},{value:"2. A set timeout is reached",id:"2-A-set-timeout-is-reached",level:4},{value:"Querying by Text Content",id:"Querying-by-Text-Content",level:3},{value:"When Elements Are Missing",id:"When-Elements-Are-Missing",level:3},{value:"Chains of Commands",id:"Chains-of-Commands",level:2},{value:"Interacting With Elements",id:"Interacting-With-Elements",level:3},{value:"Asserting About Elements",id:"Asserting-About-Elements",level:3},{value:"Subject Management",id:"Subject-Management",level:3},{value:"All commands yield a value.",id:"All-commands-yield-a-value",level:4},{value:"Some commands require a previous subject.",id:"Some-commands-require-a-previous-subject",level:4},{value:"Examples:",id:"Examples",level:4},{value:"Using <code>.then()</code> To Act On A Subject",id:"Using-then-To-Act-On-A-Subject",level:4},{value:"Let&#39;s look at an example:",id:"Lets-look-at-an-example",level:4},{value:"Using Aliases to Refer to Previous Subjects",id:"Using-Aliases-to-Refer-to-Previous-Subjects",level:4},{value:"Commands Are Asynchronous",id:"Commands-Are-Asynchronous",level:3},{value:"Take this short test, for example:",id:"Take-this-short-test-for-example",level:4},{value:"Mixing Async and Sync code",id:"Mixing-Async-and-Sync-code",level:4},{value:"Avoid loops",id:"Avoid-loops",level:4},{value:"Commands Run Serially",id:"Commands-Run-Serially",level:3},{value:"Let&#39;s take another look at an example",id:"Lets-take-another-look-at-an-example",level:4},{value:"The Cypress Command Queue",id:"The-Cypress-Command-Queue",level:3},{value:"You cannot race or run multiple commands at the same time",id:"You-cannot-race-or-run-multiple-commands-at-the-same-time",level:4},{value:"You cannot add a <code>.catch</code> error handler to a failed command",id:"You-cannot-add-a-catch-error-handler-to-a-failed-command",level:4},{value:"Assertions",id:"Assertions",level:2},{value:"Asserting in English",id:"Asserting-in-English",level:3},{value:"When To Assert?",id:"When-To-Assert",level:3},{value:"Consider this example:",id:"Consider-this-example",level:4},{value:"Implicit Assertions",id:"Implicit-Assertions",level:3},{value:"For instance:",id:"For-instance",level:4},{value:"Example #1: Existence and Actionability",id:"Example-1-Existence-and-Actionability",level:4},{value:"Example #2: Reversing the Implicit Assertion",id:"Example-2-Reversing-the-Implicit-Assertion",level:4},{value:"Example #3: Other Implicit Assertions",id:"Example-3-Other-Implicit-Assertions",level:4},{value:"List of Assertions",id:"List-of-Assertions",level:3},{value:"Writing Assertions",id:"Writing-Assertions",level:3},{value:"Command Assertions",id:"Command-Assertions",level:3},{value:"Mocha Assertions",id:"Mocha-Assertions",level:3},{value:"Timeouts",id:"Timeouts",level:2},{value:"Applying Timeouts",id:"Applying-Timeouts",level:3},{value:"Example #1: Implicit Assertion",id:"Example-1-Implicit-Assertion",level:4},{value:"Example #2: Additional Assertions",id:"Example-2-Additional-Assertions",level:4},{value:"Example #3: Modifying Timeouts",id:"Example-3-Modifying-Timeouts",level:4},{value:"Default Values",id:"Default-Values",level:3}],p=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.kt)("div",t)},c=p("Icon"),u=p("E2EOrCtTabs"),d=p("DocsImage"),h={toc:m};function k(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("h2",{parentName:"admonition",id:"What-youll-learn"},(0,i.kt)(c,{name:"graduation-cap",mdxType:"Icon"})," What you'll learn"),(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},"How Cypress queries the DOM"),(0,i.kt)("li",{parentName:"ul"},"How Cypress manages subjects and chains of commands"),(0,i.kt)("li",{parentName:"ul"},"What assertions look like and how they work"),(0,i.kt)("li",{parentName:"ul"},"How timeouts are applied to commands"))),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("strong",null,"Important!"),(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("strong",{parentName:"p"},"This is the single most important guide")," for understanding how to test with\nCypress. Read it. Understand it. Ask questions about it so that we can improve\nit."),(0,i.kt)("p",{parentName:"admonition"},"After you're done, we suggest watching some of our ",(0,i.kt)(c,{name:"video",inline:"true",url:"/examples/tutorials",callout:"Tutorial Videos",mdxType:"Icon"}),".")),(0,i.kt)("h2",{id:"Cypress-Can-Be-Simple-Sometimes"},"Cypress Can Be Simple (Sometimes)"),(0,i.kt)("p",null,"Simplicity is all about getting more done with less typing. Let's look at an\nexample:"),(0,i.kt)("visit-mount-example",null,(0,i.kt)(u,{mdxType:"E2EOrCtTabs"},(0,i.kt)("pre",{parentName:"visit-mount-example"},(0,i.kt)("code",{parentName:"pre",className:"language-js"},'describe(\'Post Resource\', () => {\n  it(\'Creating a New Post\', () => {\n    cy.visit(\'/posts/new\') // 1.\n\n    cy.get("input.post-title") // 2.\n      .type("My First Post"); // 3.\n\n    cy.get("input.post-body") // 4.\n      .type("Hello, world!"); // 5.\n\n    cy.contains("Submit") // 6.\n      .click(); // 7.\n\n    cy.get("h1") // 8.\n      .should("contain", "My First Post");\n  });\n});\n')),(0,i.kt)("pre",{parentName:"visit-mount-example"},(0,i.kt)("code",{parentName:"pre",className:"language-js"},'describe(\'Post Resource\', () => {\n  it(\'Creating a New Post\', () => {\n    cy.mount(<PostBuilder />) // 1.\n\n    cy.get("input.post-title") // 2.\n      .type("My First Post"); // 3.\n\n    cy.get("input.post-body") // 4.\n      .type("Hello, world!"); // 5.\n\n    cy.contains("Submit") // 6.\n      .click(); // 7.\n\n    cy.get("h1") // 8.\n      .should("contain", "My First Post");\n  });\n});\n')))),(0,i.kt)("p",null,"Can you read this? If you did, it might sound something like this:"),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("ol",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("em",{parentName:"li"},"Visit page at ",(0,i.kt)("inlineCode",{parentName:"em"},"/posts/new")," (or mount the ",(0,i.kt)("inlineCode",{parentName:"em"},"PostBuilder")," component).")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("em",{parentName:"li"},"Find the ",(0,i.kt)("inlineCode",{parentName:"em"},"<input>")," with class ",(0,i.kt)("inlineCode",{parentName:"em"},"post-title"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("em",{parentName:"li"},'Type "My First Post" into it.')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("em",{parentName:"li"},"Find the ",(0,i.kt)("inlineCode",{parentName:"em"},"<input>")," with class ",(0,i.kt)("inlineCode",{parentName:"em"},"post-body"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("em",{parentName:"li"},'Type "Hello, world!" into it.')),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("em",{parentName:"li"},"Find the element containing the text ",(0,i.kt)("inlineCode",{parentName:"em"},"Submit"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("em",{parentName:"li"},"Click it.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("em",{parentName:"li"},"Find the ",(0,i.kt)("inlineCode",{parentName:"em"},"h1"),' tag, ensure it contains the text "My First Post".')))),(0,i.kt)("p",null,"This is a relatively straightforward test, but consider how much code has been\ncovered by it, both on the client and the server!"),(0,i.kt)("p",null,"For the remainder of this guide, we'll explore the basics of Cypress that make\nthis example work. We'll demystify the rules Cypress follows so you can\nproductively test your application to act as much like a user as possible, as\nwell as discuss how to take shortcuts when it's useful."),(0,i.kt)("h2",{id:"Querying-Elements"},"Querying Elements"),(0,i.kt)("h3",{id:"Cypress-is-Like-jQuery"},"Cypress is Like jQuery"),(0,i.kt)("p",null,"If you've used ",(0,i.kt)("a",{parentName:"p",href:"https://jquery.com/"},"jQuery")," before, you may be used to querying\nfor elements like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"$('.my-selector')\n")),(0,i.kt)("p",null,"In Cypress, querying elements is the same:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"cy.get('.my-selector')\n")),(0,i.kt)("p",null,"In fact, Cypress\n",(0,i.kt)("a",{parentName:"p",href:"/guides/references/bundled-libraries#Other-Library-Utilities"},"bundles jQuery"),"\nand exposes many of its DOM traversal methods to you so you can work with\ncomplex HTML structures with ease using APIs you're already familiar with."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// Each Cypress query is equivalent to its jQuery counterpart.\ncy.get('#main-content').find('.article').children('img[src^=\"/static\"]').first()\n")),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("strong",null,"Core Concept"),(0,i.kt)("p",{parentName:"admonition"},"Cypress leverages jQuery's powerful selector engine to help make tests familiar\nand readable for modern web developers."),(0,i.kt)("p",{parentName:"admonition"},"Interested in the best practices for selecting elements?\n",(0,i.kt)("a",{parentName:"p",href:"/guides/references/best-practices#Selecting-Elements"},"Read here"),".")),(0,i.kt)("p",null,"Accessing the DOM elements returned from the query works differently, however:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// This is fine, jQuery returns the element synchronously.\nconst $jqElement = $('.element')\n\n// This will not work! Cypress does not return the element synchronously.\nconst $cyElement = cy.get('.element')\n")),(0,i.kt)("p",null,"Let's look at why this is..."),(0,i.kt)("h3",{id:"Cypress-is-Not-Like-jQuery"},"Cypress is ",(0,i.kt)("em",{parentName:"h3"},"Not")," Like jQuery"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Question:")," What happens when jQuery can't find any matching DOM elements from\nits selector?"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Answer:")," ",(0,i.kt)("em",{parentName:"p"},"Oops!")," It returns an empty jQuery collection. We've got a real\nobject to work with, but it doesn't contain the element we wanted. So we start\nadding conditional checks and retrying our queries manually."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// $() returns immediately with an empty collection.\nconst $myElement = $('.element').first()\n\n// Leads to ugly conditional checks\n// and worse - flaky tests!\nif ($myElement.length) {\n  doSomething($myElement)\n}\n")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Question:")," What happens when Cypress can't find any matching DOM elements\nfrom its selector?"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Answer:")," ",(0,i.kt)("em",{parentName:"p"},"No big deal!")," Cypress automatically retries the query until either:"),(0,i.kt)("h4",{id:"1-The-element-is-found"},"1. The element is found"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"cy\n  // cy.get() looks for '#element', repeating the query until...\n  .get('#element')\n\n  // ...it finds the element!\n  // You can now work with it by using .then\n  .then(($myElement) => {\n    doSomething($myElement)\n  })\n")),(0,i.kt)("h4",{id:"2-A-set-timeout-is-reached"},"2. A set timeout is reached"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"cy\n  // cy.get() looks for '#element-does-not-exist', repeating the query until...\n  // ...it doesn't find the element before its timeout.\n  // Cypress halts and fails the test.\n  .get('#element-does-not-exist')\n\n  // ...this code is never run...\n  .then(($myElement) => {\n    doSomething($myElement)\n  })\n")),(0,i.kt)("p",null,"This makes Cypress robust and immune to dozens of common problems that occur in\nother testing tools. Consider all the circumstances that could cause querying a\nDOM element to fail:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The DOM has not loaded yet."),(0,i.kt)("li",{parentName:"ul"},"Your framework hasn't finished bootstrapping."),(0,i.kt)("li",{parentName:"ul"},"An XHR request hasn't responded."),(0,i.kt)("li",{parentName:"ul"},"An animation hasn't completed."),(0,i.kt)("li",{parentName:"ul"},"and on and on...")),(0,i.kt)("p",null,"Before, you'd be forced to write custom code to protect against any and all of\nthese issues: a nasty mashup of arbitrary waits, conditional retries, and null\nchecks littering your tests. Not in Cypress! With built-in retrying and\n",(0,i.kt)("a",{parentName:"p",href:"/guides/references/configuration#Timeouts"},"customizable timeouts"),", Cypress\nsidesteps all of these flaky issues."),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("strong",null,"Core Concept"),(0,i.kt)("p",{parentName:"admonition"},"Cypress wraps all DOM queries with robust retry-and-timeout logic that better\nsuits how real web apps work. We trade a minor change in how we find DOM\nelements for a major stability upgrade to all of our tests. Banishing flake for\ngood!")),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"In Cypress, when you want to interact with a DOM element directly, call\n",(0,i.kt)("a",{parentName:"p",href:"/api/commands/then"},(0,i.kt)("inlineCode",{parentName:"a"},".then()"))," with a callback function that receives the\nelement as its first argument. When you want to skip the retry-and-timeout\nfunctionality entirely and perform traditional synchronous work, use\n",(0,i.kt)("a",{parentName:"p",href:"/api/utilities/$"},(0,i.kt)("inlineCode",{parentName:"a"},"Cypress.$")),".")),(0,i.kt)("h3",{id:"Querying-by-Text-Content"},"Querying by Text Content"),(0,i.kt)("p",null,"Another way to locate things -- a more human way -- is to look them up by their\ncontent, by what the user would see on the page. For this, there's the handy\n",(0,i.kt)("a",{parentName:"p",href:"/api/commands/contains"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.contains()"))," command, for example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// Find an element in the document containing the text 'New Post'\ncy.contains('New Post')\n\n// Find an element within '.main' containing the text 'New Post'\ncy.get('.main').contains('New Post')\n")),(0,i.kt)("p",null,'This is helpful when writing tests from the perspective of a user interacting\nwith your app. They only know that they want to click the button labeled\n"Submit". They have no idea that it has a ',(0,i.kt)("inlineCode",{parentName:"p"},"type")," attribute of ",(0,i.kt)("inlineCode",{parentName:"p"},"submit"),", or a CSS\nclass of ",(0,i.kt)("inlineCode",{parentName:"p"},"my-submit-button"),"."),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("strong",null,"Internationalization"),(0,i.kt)("p",{parentName:"admonition"},"If your app is translated into multiple languages for i18n, make sure you\nconsider the implications of using user-facing text to find DOM elements!")),(0,i.kt)("h3",{id:"When-Elements-Are-Missing"},"When Elements Are Missing"),(0,i.kt)("p",null,"As we showed above, Cypress anticipates the asynchronous nature of web\napplications and doesn't fail immediately the first time an element is not\nfound. Instead, Cypress gives your app a window of time to finish whatever it\nmay be doing!"),(0,i.kt)("p",null,"This is known as a ",(0,i.kt)("inlineCode",{parentName:"p"},"timeout"),", and most commands can be customized with specific\ntimeout periods\n(",(0,i.kt)("a",{parentName:"p",href:"/guides/references/configuration#Timeouts"},"the default timeout is 4 seconds"),").\nThese Commands will list a ",(0,i.kt)("inlineCode",{parentName:"p"},"timeout")," option in their API documentation,\ndetailing how to set the number of milliseconds you want to continue to try\nfinding the element."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// Give this element 10 seconds to appear\ncy.get('.my-slow-selector', { timeout: 10000 })\n")),(0,i.kt)("p",null,"You can also set the timeout globally via the\n",(0,i.kt)("a",{parentName:"p",href:"/guides/references/configuration#Timeouts"},"configuration setting: ",(0,i.kt)("inlineCode",{parentName:"a"},"defaultCommandTimeout")),"."),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("strong",null,"Core Concept"),(0,i.kt)("p",{parentName:"admonition"},"To match the behavior of web applications, Cypress is asynchronous and relies on\ntimeouts to know when to stop waiting on an app to get into the expected state.\nTimeouts can be configured globally, or on a per-command basis.")),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("strong",null,"Timeouts and Performance"),(0,i.kt)("p",{parentName:"admonition"},"There is a performance tradeoff here: ",(0,i.kt)("strong",{parentName:"p"},"tests that have longer timeout periods\ntake longer to fail"),". Commands always proceed as soon as their expected\ncriteria is met, so working tests will be performed as fast as your application\nallows. A test that fails due to timeout will consume the entire timeout period,\nby design. This means that while you ",(0,i.kt)("em",{parentName:"p"},"may")," want to increase your timeout period\nto suit specific parts of your app, you ",(0,i.kt)("em",{parentName:"p"},"don't"),' want to make it "extra long,\njust in case".')),(0,i.kt)("p",null,"Later in this guide we'll go into much more detail about\n",(0,i.kt)("a",{parentName:"p",href:"#Implicit-Assertions"},"Implicit Assertions")," and ",(0,i.kt)("a",{parentName:"p",href:"#Timeouts"},"Timeouts"),"."),(0,i.kt)("h2",{id:"Chains-of-Commands"},"Chains of Commands"),(0,i.kt)("p",null,"It's very important to understand the mechanism Cypress uses to chain commands\ntogether. It manages a Promise chain on your behalf, with each command yielding\na 'subject' to the next command, until the chain ends or an error is\nencountered. The developer should not need to use Promises directly, but\nunderstanding how they work is helpful!"),(0,i.kt)("h3",{id:"Interacting-With-Elements"},"Interacting With Elements"),(0,i.kt)("p",null,"As we saw in the initial example, Cypress allows you to click on and type into\nelements on the page by using ",(0,i.kt)("a",{parentName:"p",href:"/api/commands/click"},(0,i.kt)("inlineCode",{parentName:"a"},".click()"))," and\n",(0,i.kt)("a",{parentName:"p",href:"/api/commands/type"},(0,i.kt)("inlineCode",{parentName:"a"},".type()"))," action commands with a\n",(0,i.kt)("a",{parentName:"p",href:"/api/commands/get"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.get()"))," or ",(0,i.kt)("a",{parentName:"p",href:"/api/commands/contains"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.contains()")),"\nquery command. This is a great example of chaining in action. Let's see it\nagain:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"cy.get('textarea.post-body').type('This is an excellent post.')\n")),(0,i.kt)("p",null,"We're chaining ",(0,i.kt)("a",{parentName:"p",href:"/api/commands/type"},(0,i.kt)("inlineCode",{parentName:"a"},".type()"))," onto\n",(0,i.kt)("a",{parentName:"p",href:"/api/commands/get"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.get()")),", telling it to type into the subject yielded\nfrom the ",(0,i.kt)("a",{parentName:"p",href:"/api/commands/get"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.get()"))," query, which will be a DOM element."),(0,i.kt)("p",null,"Here are even more action commands Cypress provides to interact with your app:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/blur"},(0,i.kt)("inlineCode",{parentName:"a"},".blur()"))," - Make a focused DOM element blur."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/focus"},(0,i.kt)("inlineCode",{parentName:"a"},".focus()"))," - Focus on a DOM element."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/clear"},(0,i.kt)("inlineCode",{parentName:"a"},".clear()"))," - Clear the value of an input or textarea."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/check"},(0,i.kt)("inlineCode",{parentName:"a"},".check()"))," - Check checkbox(es) or radio(s)."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/uncheck"},(0,i.kt)("inlineCode",{parentName:"a"},".uncheck()"))," - Uncheck checkbox(es)."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/select"},(0,i.kt)("inlineCode",{parentName:"a"},".select()"))," - Select an ",(0,i.kt)("inlineCode",{parentName:"li"},"<option>")," within a\n",(0,i.kt)("inlineCode",{parentName:"li"},"<select>"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/dblclick"},(0,i.kt)("inlineCode",{parentName:"a"},".dblclick()"))," - Double-click a DOM element."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/rightclick"},(0,i.kt)("inlineCode",{parentName:"a"},".rightclick()"))," - Right-click a DOM element.")),(0,i.kt)("p",null,"These commands ensure\n",(0,i.kt)("a",{parentName:"p",href:"/guides/core-concepts/interacting-with-elements"},"some guarantees")," about what\nthe state of the elements should be prior to performing their actions."),(0,i.kt)("p",null,"For example, when writing a ",(0,i.kt)("a",{parentName:"p",href:"/api/commands/click"},(0,i.kt)("inlineCode",{parentName:"a"},".click()")),' command, Cypress\nensures that the element is able to be interacted with (like a real user would).\nIt will automatically wait until the element reaches an "actionable" state by:'),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Not being hidden"),(0,i.kt)("li",{parentName:"ul"},"Not being covered"),(0,i.kt)("li",{parentName:"ul"},"Not being disabled"),(0,i.kt)("li",{parentName:"ul"},"Not animating")),(0,i.kt)("p",null,"This also helps prevent flake when interacting with your application in tests.\nYou can usually override this behavior with a ",(0,i.kt)("inlineCode",{parentName:"p"},"force")," option."),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("strong",null,"Core Concept"),(0,i.kt)("p",{parentName:"admonition"},"Cypress provides a simple but powerful algorithm when\n",(0,i.kt)("a",{parentName:"p",href:"/guides/core-concepts/interacting-with-elements"}," interacting with elements."))),(0,i.kt)("h3",{id:"Asserting-About-Elements"},"Asserting About Elements"),(0,i.kt)("p",null,"Assertions let you do things like ensuring an element is visible or has a\nparticular attribute, CSS class, or state. Assertions are commands that enable\nyou to describe the ",(0,i.kt)("em",{parentName:"p"},"desired")," state of your application. Cypress will\nautomatically wait until your elements reach this state, or fail the test if the\nassertions don't pass. Here's a quick look at assertions in action:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"cy.get(':checkbox').should('be.disabled')\n\ncy.get('form').should('have.class', 'form-horizontal')\n\ncy.get('input').should('not.have.value', 'US')\n")),(0,i.kt)("p",null,"In each of these examples, it's important to note that Cypress will\nautomatically ",(0,i.kt)("em",{parentName:"p"},"wait")," until these assertions pass. This prevents you from having\nto know or care about the precise moment your elements eventually do reach this\nstate."),(0,i.kt)("p",null,"We will learn more about ",(0,i.kt)("a",{parentName:"p",href:"#Assertions"},"assertions")," later in this guide."),(0,i.kt)("h3",{id:"Subject-Management"},"Subject Management"),(0,i.kt)("p",null,"A new Cypress chain always starts with ",(0,i.kt)("inlineCode",{parentName:"p"},"cy.[command]"),", where what is yielded by\nthe ",(0,i.kt)("inlineCode",{parentName:"p"},"command")," establishes what other commands can be called next (chained)."),(0,i.kt)("h4",{id:"All-commands-yield-a-value"},"All commands yield a value."),(0,i.kt)("p",null,"Each command specifies what value it yields. For example,"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/clearcookies"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.clearCookies()"))," yields ",(0,i.kt)("inlineCode",{parentName:"li"},"null"),". You can chain\noff commands that yield ",(0,i.kt)("inlineCode",{parentName:"li"},"null"),", as long as the next command doesn't expect to\nreceive a subject."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/contains"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.contains()"))," yields a DOM element, allowing\nfurther commands to be chained (assuming they expect a DOM subject) like\n",(0,i.kt)("a",{parentName:"li",href:"/api/commands/click"},(0,i.kt)("inlineCode",{parentName:"a"},".click()"))," or even\n",(0,i.kt)("a",{parentName:"li",href:"/api/commands/contains"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.contains()"))," again."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/click"},(0,i.kt)("inlineCode",{parentName:"a"},".click()"))," yields the same subject it was originally\ngiven.")),(0,i.kt)("h4",{id:"Some-commands-require-a-previous-subject"},"Some commands require a previous subject."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/click"},(0,i.kt)("inlineCode",{parentName:"a"},".click()"))," requires a DOM element from the previous\ncommand."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/its"},(0,i.kt)("inlineCode",{parentName:"a"},".its()"))," requires a subject, but it can be of any type."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/contains"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.contains()"))," behaves differently depending on the\nprevious subject. If chained directly off of ",(0,i.kt)("inlineCode",{parentName:"li"},"cy"),", or if the previous command\nyielded ",(0,i.kt)("inlineCode",{parentName:"li"},"null"),", it will look at the entire document. But if the subject is a\nDOM element, it will only look inside that container."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/clearcookies"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.clearCookies()"))," does not require a previous\nsubject - it can be chained off of anything, even\n",(0,i.kt)("a",{parentName:"li",href:"/api/commands/end"},(0,i.kt)("inlineCode",{parentName:"a"},".end()")),".")),(0,i.kt)("h4",{id:"Examples"},"Examples:"),(0,i.kt)("p",null,"This is actually much more intuitive than it sounds."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"cy.clearCookies() // Yields null\n  .visit('/fixtures/dom.html') // Does not care about the previous subject.\n\ncy.get('.main-container') // Yields an array of matching DOM elements\n  .contains('Headlines') // Yields the first DOM element containing content\n  .click() // Yields same DOM element from previous command.\n")),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("strong",null,"Core Concept"),(0,i.kt)("p",{parentName:"admonition"},"Cypress commands do not ",(0,i.kt)("strong",{parentName:"p"},"return")," their subjects, they ",(0,i.kt)("strong",{parentName:"p"},"yield")," them.\nRemember: Cypress commands are asynchronous and get queued for execution at a\nlater time. During execution, subjects are yielded from one command to the next,\nand a lot of helpful Cypress code runs between each command to ensure everything\nis in order.")),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("strong",null,"Don't continue a chain after acting on the DOM"),(0,i.kt)("p",{parentName:"admonition"},"While it's possible in Cypress to act on the DOM and then continue chaining,\nthis is usually unsafe, and can lead to stale elements. See the\n",(0,i.kt)("a",{parentName:"p",href:"/guides/core-concepts/retry-ability"},"Retry-ability Guide")," for more details."),(0,i.kt)("p",{parentName:"admonition"},"But the rule of thumb is simple: If you perform an action, like navigating the\npage, clicking a button or scrolling the viewport, end the chain of commands\nthere and start fresh from ",(0,i.kt)("inlineCode",{parentName:"p"},"cy"),".")),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"To work around the need to reference elements, Cypress has a feature\n",(0,i.kt)("a",{parentName:"p",href:"/guides/core-concepts/variables-and-aliases"},"known as aliasing"),". Aliasing helps\nyou to ",(0,i.kt)("strong",{parentName:"p"},"store")," and ",(0,i.kt)("strong",{parentName:"p"},"save")," references for future use.")),(0,i.kt)("h4",{id:"Using-then-To-Act-On-A-Subject"},"Using ",(0,i.kt)("a",{parentName:"h4",href:"/api/commands/then"},(0,i.kt)("inlineCode",{parentName:"a"},".then()"))," To Act On A Subject"),(0,i.kt)("p",null,"Want to jump into the command flow and get your hands on the subject directly?\nNo problem, add a ",(0,i.kt)("a",{parentName:"p",href:"/api/commands/then"},".then()")," to your command chain. When the\nprevious command resolves, it will call your callback function with the yielded\nsubject as the first argument."),(0,i.kt)("p",null,"If you wish to continue chaining commands after your\n",(0,i.kt)("a",{parentName:"p",href:"/api/commands/then"},(0,i.kt)("inlineCode",{parentName:"a"},".then()")),", you'll need to specify the subject you want to\nyield to those commands, which you can achieve with a return value other than\n",(0,i.kt)("inlineCode",{parentName:"p"},"null")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"undefined"),". Cypress will yield that to the next command for you."),(0,i.kt)("h4",{id:"Lets-look-at-an-example"},"Let's look at an example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"cy\n  // Find the el with id 'some-link'\n  .get('#some-link')\n\n  .then(($myElement) => {\n    // ...massage the subject with some arbitrary code\n\n    // grab its href property\n    const href = $myElement.prop('href')\n\n    // strip out the 'hash' character and everything after it\n    return href.replace(/(#.*)/, '')\n  })\n  .then((href) => {\n    // href is now the new subject\n    // which we can work with now\n  })\n")),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("strong",null,"Core Concept"),(0,i.kt)("p",{parentName:"admonition"},"We have many more examples and use cases of ",(0,i.kt)("a",{parentName:"p",href:"/api/commands/then"},"cy.then()")," in\nour ",(0,i.kt)("a",{parentName:"p",href:"/guides/core-concepts/variables-and-aliases"},"Core Concept Guide")," that\nteaches you how to properly deal with asynchronous code, when to use variables,\nand what aliasing is.")),(0,i.kt)("h4",{id:"Using-Aliases-to-Refer-to-Previous-Subjects"},"Using Aliases to Refer to Previous Subjects"),(0,i.kt)("p",null,"Cypress has some added functionality for quickly referring back to past subjects\ncalled ",(0,i.kt)("a",{parentName:"p",href:"/guides/core-concepts/variables-and-aliases"},"Aliases"),". It looks\nsomething like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"cy.get('.my-selector')\n  .as('myElement') // sets the alias\n  .click()\n\n/* many more actions */\n\ncy.get('@myElement') // re-queries the DOM as before\n  .click()\n")),(0,i.kt)("p",null,"This lets us reuse our queries for more readable tests, and it automatically\nhandles re-querying the DOM for us as it updates. This is particularly helpful\nwhen dealing with front end frameworks that do a lot of re-rendering!"),(0,i.kt)("h3",{id:"Commands-Are-Asynchronous"},"Commands Are Asynchronous"),(0,i.kt)("p",null,"It is very important to understand that Cypress commands don't do anything at\nthe moment they are invoked, but rather enqueue themselves to be run later. This\nis what we mean when we say Cypress commands are asynchronous."),(0,i.kt)("h4",{id:"Take-this-short-test-for-example"},"Take this short test, for example:"),(0,i.kt)("visit-mount-example",null,(0,i.kt)(u,{mdxType:"E2EOrCtTabs"},(0,i.kt)("pre",{parentName:"visit-mount-example"},(0,i.kt)("code",{parentName:"pre",className:"language-js"},"it('hides the thing when it is clicked', () => {\n  cy.visit('/my/resource/path') // Nothing happens yet\n\n  cy.get(\".hides-when-clicked\") // Still nothing happening\n    .should(\"be.visible\") // Still absolutely nothing\n    .click() // Nope, nothing\n\n  cy.get('.hides-when-clicked') // Still nothing happening\n    .should('not.be.visible') // Definitely nothing happening yet\n})\n\n// Ok, the test function has finished executing...\n// We've queued all of these commands and now\n// Cypress will begin running them in order!\n")),(0,i.kt)("pre",{parentName:"visit-mount-example"},(0,i.kt)("code",{parentName:"pre",className:"language-js"},"it('hides the thing when it is clicked', () => {\n  cy.mount(<MyComponent />) // Nothing happens yet\n\n  cy.get(\".hides-when-clicked\") // Still nothing happening\n    .should(\"be.visible\") // Still absolutely nothing\n    .click() // Nope, nothing\n\n  cy.get('.hides-when-clicked') // Still nothing happening\n    .should('not.be.visible') // Definitely nothing happening yet\n})\n\n// Ok, the test function has finished executing...\n// We've queued all of these commands and now\n// Cypress will begin running them in order!\n")))),(0,i.kt)("p",null,"Cypress doesn't kick off the browser automation until the test function exits."),(0,i.kt)("h4",{id:"Mixing-Async-and-Sync-code"},"Mixing Async and Sync code"),(0,i.kt)("p",null,"Remembering that Cypress commands run asynchronously is important if you are\nattempting to mix Cypress commands with synchronous code. Synchronous code will\nexecute immediately - not waiting for the Cypress commands above it to execute."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},(0,i.kt)(c,{name:"exclamation-triangle",color:"red",mdxType:"Icon"})," Incorrect usage")),(0,i.kt)("p",null,"In the example below, the ",(0,i.kt)("inlineCode",{parentName:"p"},"el")," evaluates immediately, before the ",(0,i.kt)("inlineCode",{parentName:"p"},"cy.visit()"),"\nhas executed, so will always evaluate to an empty array."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"it('does not work as we expect', () => {\n  cy.visit('/my/resource/path') // Nothing happens yet\n\n  cy.get('.awesome-selector') // Still nothing happening\n    .click() // Nope, nothing\n\n  // Cypress.$ is synchronous, so evaluates immediately\n  // there is no element to find yet because\n  // the cy.visit() was only queued to visit\n  // and did not actually visit the application\n  let el = Cypress.$('.new-el') // evaluates immediately as []\n\n  if (el.length) {\n    // evaluates immediately as 0\n    cy.get('.another-selector')\n  } else {\n    // this will always run\n    // because the 'el.length' is 0\n    // when the code executes\n    cy.get('.optional-selector')\n  }\n})\n\n// Ok, the test function has finished executing...\n// We've queued all of these commands and now\n// Cypress will begin running them in order!\n")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},(0,i.kt)(c,{name:"check-circle",color:"green",mdxType:"Icon"})," Correct usage")),(0,i.kt)("p",null,"Below is one way the code above could be rewritten in order to ensure the\ncommands run as expected."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"it('does not work as we expect', () => {\n  cy.visit('/my/resource/path') // Nothing happens yet\n\n  cy.get('.awesome-selector') // Still nothing happening\n    .click() // Nope, nothing\n    .then(() => {\n      // placing this code inside the .then() ensures\n      // it runs after the cypress commands 'execute'\n      let el = Cypress.$('.new-el') // evaluates after .then()\n\n      if (el.length) {\n        cy.get('.another-selector')\n      } else {\n        cy.get('.optional-selector')\n      }\n    })\n})\n\n// Ok, the test function has finished executing...\n// We've queued all of these commands and now\n// Cypress will begin running them in order!\n")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},(0,i.kt)(c,{name:"exclamation-triangle",color:"red",mdxType:"Icon"})," Incorrect usage")),(0,i.kt)("p",null,"In the example below, the check on the ",(0,i.kt)("inlineCode",{parentName:"p"},"username")," value gets evaluated\nimmediately, before the ",(0,i.kt)("inlineCode",{parentName:"p"},"cy.visit()")," has executed, so will always evaluate to\n",(0,i.kt)("inlineCode",{parentName:"p"},"undefined"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"it('test', () => {\n  let username = undefined // evaluates immediately as undefined\n\n  cy.visit('https://example.cypress.io') // Nothing happens yet\n  cy.get('.user-name') // Still, nothing happens yet\n    .then(($el) => {\n      // Nothing happens yet\n      // this line evaluates after the .then executes\n      username = $el.text()\n    })\n\n  // this evaluates before the .then() above\n  // so the username is still undefined\n  if (username) {\n    // evaluates immediately as undefined\n    cy.contains(username).click()\n  } else {\n    // this will always run\n    // because username will always\n    // evaluate to undefined\n    cy.contains('My Profile').click()\n  }\n})\n\n// Ok, the test function has finished executing...\n// We've queued all of these commands and now\n// Cypress will begin running them in order!\n")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},(0,i.kt)(c,{name:"check-circle",color:"green",mdxType:"Icon"})," Correct usage")),(0,i.kt)("p",null,"Below is one way the code above could be rewritten in order to ensure the\ncommands run as expected."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"it('test', () => {\n  let username = undefined // evaluates immediately as undefined\n\n  cy.visit('https://example.cypress.io') // Nothing happens yet\n  cy.get('.user-name') // Still, nothing happens yet\n    .then(($el) => {\n      // Nothing happens yet\n      // this line evaluates after the .then() executes\n      username = $el.text()\n\n      // evaluates after the .then() executes\n      // it's the correct value gotten from the $el.text()\n      if (username) {\n        cy.contains(username).click()\n      } else {\n        cy.get('My Profile').click()\n      }\n    })\n})\n\n// Ok, the test function has finished executing...\n// We've queued all of these commands and now\n// Cypress will begin running them in order!\n")),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("strong",null,"Core Concept"),(0,i.kt)("p",{parentName:"admonition"},"Each Cypress command (and chain of commands) returns immediately, having only\nbeen appended to a queue to be executed at a later time."),(0,i.kt)("p",{parentName:"admonition"},"You purposefully ",(0,i.kt)("strong",{parentName:"p"},"cannot")," do anything useful with the return value from a\ncommand. Commands are enqueued and managed entirely behind the scenes."),(0,i.kt)("p",{parentName:"admonition"},"We've designed our API this way because the DOM is a highly mutable object that\nconstantly goes stale. For Cypress to prevent flake, and know when to proceed,\nwe manage commands in a highly controlled deterministic way.")),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("strong",null,"Why can't I use async / await?"),(0,i.kt)("p",{parentName:"admonition"},'If you\'re a modern JS programmer you might hear "asynchronous" and think: ',(0,i.kt)("strong",{parentName:"p"},"why\ncan't I just use ",(0,i.kt)("inlineCode",{parentName:"strong"},"async/await"))," instead of learning some proprietary API?"),(0,i.kt)("p",{parentName:"admonition"},"Cypress's APIs are built very differently from what you're likely used to: but\nthese design patterns are incredibly intentional. We'll go into more detail\nlater in this guide.")),(0,i.kt)("h4",{id:"Avoid-loops"},"Avoid loops"),(0,i.kt)("p",null,"Using JavaScript loop commands like ",(0,i.kt)("inlineCode",{parentName:"p"},"while")," can have unexpected effects. Let's\nsay our application shows a random number on load."),(0,i.kt)(d,{src:"/img/guides/core-concepts/reload-page.gif",alt:"Manually reloading the browser page until the number 7 appears",mdxType:"DocsImage"}),(0,i.kt)("p",null,"We want the test to stop when it finds the number 7. If any other number is\ndisplayed the test reloads the page and checks again."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Note:")," you can find this application and the correct test in our\n",(0,i.kt)("a",{parentName:"p",href:"https://github.com/cypress-io/cypress-example-recipes#testing-the-dom"},"Recipes"),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},(0,i.kt)(c,{name:"exclamation-triangle",color:"red",mdxType:"Icon"})," Incorrect test")),(0,i.kt)("p",null,"The test written below WILL NOT work and most likely will crash your browser."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"let found7 = false\n\nwhile (!found7) {\n  // this schedules an infinite number\n  // of \"cy.get...\" commands, eventually crashing\n  // before any of them have a chance to run\n  // and set found7 to true\n  cy.get('#result')\n    .should('not.be.empty')\n    .invoke('text')\n    .then(parseInt)\n    .then((number) => {\n      if (number === 7) {\n        found7 = true\n        cy.log('lucky **7**')\n      } else {\n        cy.reload()\n      }\n    })\n}\n")),(0,i.kt)("p",null,"The above test keeps adding more ",(0,i.kt)("inlineCode",{parentName:"p"},"cy.get('#result')")," commands to the test chain\nwithout executing any! The chain of commands keeps growing, but never executes -\nsince the test function never finishes running. The ",(0,i.kt)("inlineCode",{parentName:"p"},"while")," loop never allows\nCypress to start executing even the very first ",(0,i.kt)("inlineCode",{parentName:"p"},"cy.get(...)")," command."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},(0,i.kt)(c,{name:"check-circle",color:"green",mdxType:"Icon"})," Correct test")),(0,i.kt)("p",null,"We need to give the test a chance to run a few commands before deciding if it\nneeds to continue. Thus the correct test would use recursion."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const checkAndReload = () => {\n  // get the element's text, convert into a number\n  cy.get('#result')\n    .should('not.be.empty')\n    .invoke('text')\n    .then(parseInt)\n    .then((number) => {\n      // if the expected number is found\n      // stop adding any more commands\n      if (number === 7) {\n        cy.log('lucky **7**')\n\n        return\n      }\n\n      // otherwise insert more Cypress commands\n      // by calling the function after reload\n      cy.wait(500, { log: false })\n      cy.reload()\n      checkAndReload()\n    })\n}\n\ncy.visit('public/index.html')\ncheckAndReload()\n")),(0,i.kt)("p",null,"The test runs and correctly finishes."),(0,i.kt)(d,{src:"/img/guides/core-concepts/lucky-7.gif",alt:"Test reloads the page until the number 7 appears",mdxType:"DocsImage"}),(0,i.kt)("p",null,"You can see a short video going through this example at"),(0,i.kt)(c,{name:"play-circle",url:"https://www.youtube.com/watch?v=5Z8BaPNDfvA",mdxType:"Icon"}),(0,i.kt)("h3",{id:"Commands-Run-Serially"},"Commands Run Serially"),(0,i.kt)("p",null,"After a test function is finished running, Cypress goes to work executing the\ncommands that were enqueued using the ",(0,i.kt)("inlineCode",{parentName:"p"},"cy.*")," command chains."),(0,i.kt)("h4",{id:"Lets-take-another-look-at-an-example"},"Let's take another look at an example"),(0,i.kt)("visit-mount-example",null,(0,i.kt)(u,{mdxType:"E2EOrCtTabs"},(0,i.kt)("pre",{parentName:"visit-mount-example"},(0,i.kt)("code",{parentName:"pre",className:"language-js"},"it('hides the thing when it is clicked', () => {\n  cy.visit('/my/resource/path') // 1.\n\n  cy.get('.hides-when-clicked') // 2\n    .should('be.visible') // 3\n    .click() // 4\n\n  cy.get('.hides-when-clicked') // 5\n    .should('not.be.visible') // 6\n});\n")),(0,i.kt)("pre",{parentName:"visit-mount-example"},(0,i.kt)("code",{parentName:"pre",className:"language-js"},"it('hides the thing when it is clicked', () => {\n  cy.mount(<MyComponent />) // 1.\n\n  cy.get('.hides-when-clicked') // 2\n    .should('be.visible') // 3\n    .click() // 4\n\n  cy.get('.hides-when-clicked') // 5\n    .should('not.be.visible') // 6\n});\n")))),(0,i.kt)("p",null,"The test above would cause an execution in this order:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Visit the URL (or mount the component)."),(0,i.kt)("li",{parentName:"ol"},"Find an element by its selector."),(0,i.kt)("li",{parentName:"ol"},"Assert that the element is visible."),(0,i.kt)("li",{parentName:"ol"},"Perform a click action on that element."),(0,i.kt)("li",{parentName:"ol"},"Find an element by its selector."),(0,i.kt)("li",{parentName:"ol"},"Assert that the element is no longer visible.")),(0,i.kt)("p",null,"These actions will always happen serially (one after the other), never in\nparallel (at the same time). Why?"),(0,i.kt)("p",null,"To illustrate this, let's revisit that list of actions and expose some of the\nhidden ",(0,i.kt)("strong",{parentName:"p"},"\u2728 magic \u2728")," Cypress does for us at each step:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Visit the URL \u2728 ",(0,i.kt)("strong",{parentName:"li"},"and wait for the page load event to fire after all\nexternal resources have loaded")," \u2728 (or mount the component \u2728 ",(0,i.kt)("strong",{parentName:"li"},"and wait for\nthe component to finish mounting")," \u2728)"),(0,i.kt)("li",{parentName:"ol"},"Find an element by its selector \u2728 ",(0,i.kt)("strong",{parentName:"li"},"and retry until it is found in the DOM"),"\n\u2728"),(0,i.kt)("li",{parentName:"ol"},"Assert that the element is visible \u2728 ",(0,i.kt)("strong",{parentName:"li"},"and retry until the assertion\npasses")," \u2728"),(0,i.kt)("li",{parentName:"ol"},"Perform a click action on that element \u2728 ",(0,i.kt)("strong",{parentName:"li"},"after we wait for the element to\nreach an actionable state")," \u2728"),(0,i.kt)("li",{parentName:"ol"},"Find an element by its selector \u2728 ",(0,i.kt)("strong",{parentName:"li"},"and retry until it is found in the DOM"),"\n\u2728"),(0,i.kt)("li",{parentName:"ol"},"Assert that the element is no longer visible \u2728 ",(0,i.kt)("strong",{parentName:"li"},"and retry until the\nassertion passes")," \u2728")),(0,i.kt)("p",null,"As you can see, Cypress does a lot of extra work to ensure the state of the\napplication matches what our commands expect about it. Each command may resolve\nquickly (so fast you won't see them in a pending state) but others may take\nseconds, or even dozens of seconds to resolve."),(0,i.kt)("p",null,"While most commands time out after a few seconds, other specialized commands\nthat expect particular things to take much longer like\n",(0,i.kt)("a",{parentName:"p",href:"/api/commands/visit"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.visit()"))," will naturally wait longer before timing\nout."),(0,i.kt)("p",null,"These commands have their own particular timeout values which are documented in\nthe ",(0,i.kt)("a",{parentName:"p",href:"/guides/references/configuration"},"Cypress configuration"),"."),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("strong",null,"Core Concept"),(0,i.kt)("p",{parentName:"admonition"},"Any waiting or retrying that is necessary to ensure a step was successful must\ncomplete before the next step begins. If they don't complete successfully before\nthe timeout is reached, the test will fail.")),(0,i.kt)("h3",{id:"The-Cypress-Command-Queue"},"The Cypress Command Queue"),(0,i.kt)("p",null,"While the API may look similar to Promises, with it's ",(0,i.kt)("inlineCode",{parentName:"p"},"then()")," syntax, Cypress\ncommands and queries are not promises - they are serial commands passed into a\ncentral queue, to be executed asynchronously at a later date. These commands are\ndesigned to deliver deterministic, repeatable and consistent tests."),(0,i.kt)("p",null,"Almost all commands come with built-in\n",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"/guides/core-concepts/retry-ability"},"retry-ability")),". Without\n",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"/guides/core-concepts/retry-ability"},"retry-ability")),", assertions would\nrandomly fail. This would lead to flaky, inconsistent results."),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"While Cypress does have a ",(0,i.kt)("a",{parentName:"p",href:"/api/commands/then"},(0,i.kt)("inlineCode",{parentName:"a"},".then()"))," command, Cypress\ncommands are not Promises and cannot be ",(0,i.kt)("inlineCode",{parentName:"p"},"await"),"ed. If you'd like to learn more\nabout handling asynchronous Cypress Commands please read our\n",(0,i.kt)("a",{parentName:"p",href:"/guides/core-concepts/variables-and-aliases"},"Variables and Aliases Guide"),".")),(0,i.kt)("p",null,"Commands also have some design choices that developers who are used to\npromise-based testing may find unexpected. They are intentional decisions on\nCypress' part, not technical limitations."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"You cannot ",(0,i.kt)("strong",{parentName:"li"},"race")," or run multiple commands at the same time (in parallel)."),(0,i.kt)("li",{parentName:"ol"},"You cannot add a ",(0,i.kt)("inlineCode",{parentName:"li"},".catch")," error handler to a failed command.")),(0,i.kt)("p",null,"The whole purpose of Cypress (and what makes it very different from other\ntesting tools) is to create consistent, non-flaky tests that perform identically\nfrom one run to the next. Making this happen isn't free - there are some\ntrade-offs we make that may initially seem unfamiliar to developers accustomed\nto working with Promises or other libraries."),(0,i.kt)("p",null,"Let's take a look at each trade-off in depth:"),(0,i.kt)("h4",{id:"You-cannot-race-or-run-multiple-commands-at-the-same-time"},"You cannot race or run multiple commands at the same time"),(0,i.kt)("p",null,"Cypress guarantees that it will execute all of its commands and queries\n",(0,i.kt)("em",{parentName:"p"},"deterministically")," and identically every time they are run."),(0,i.kt)("p",null,"A lot of Cypress commands ",(0,i.kt)("em",{parentName:"p"},"mutate")," the state of the browser in some way."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/request"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.request()"))," automatically gets + sets cookies to\nand from the remote server."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/clearcookies"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.clearCookies()"))," clears all of the browser\ncookies."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/click"},(0,i.kt)("inlineCode",{parentName:"a"},".click()"))," causes your application to react to click\nevents.")),(0,i.kt)("p",null,"None of the above commands are ",(0,i.kt)("em",{parentName:"p"},"idempotent"),"; they all cause side effects. Racing\ncommands is not possible because commands must be run in a controlled, serial\nmanner in order to create consistency. Because integration and e2e tests\nprimarily mimic the actions of a real user, Cypress models its command execution\nmodel after a real user working step by step."),(0,i.kt)("h4",{id:"You-cannot-add-a-catch-error-handler-to-a-failed-command"},"You cannot add a ",(0,i.kt)("inlineCode",{parentName:"h4"},".catch")," error handler to a failed command"),(0,i.kt)("p",null,"In Cypress there is no built in error recovery from a failed command. A command\n",(0,i.kt)("em",{parentName:"p"},"eventually")," passes, or if it fails, all remaining commands are not executed,\nand the test as a whole fails."),(0,i.kt)("p",null,"You might be wondering:"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"How do I create conditional control flow, using if/else? So that if an element\ndoes (or doesn't) exist, I choose what to do?")),(0,i.kt)("p",null,"Cypress does not support this type of conditional control flow because it leads\nto non-deterministic tests - different runs may behave differently, which makes\nthem less consistent and useful for verifying your application's correctness. In\ngeneral, there are only a handful of very specific situations where you can or\nshould create control flow using Cypress commands."),(0,i.kt)("p",null,"With that said, as long as you are aware of the potential pitfalls with control\nflow, it is possible to do this in Cypress! You can read all about how to do\n",(0,i.kt)("a",{parentName:"p",href:"/guides/core-concepts/conditional-testing"},"conditional testing")," here."),(0,i.kt)("h2",{id:"Assertions"},"Assertions"),(0,i.kt)("p",null,"As we mentioned previously in this guide:"),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Assertions describe the ",(0,i.kt)("strong",{parentName:"p"},"desired")," state of your ",(0,i.kt)("strong",{parentName:"p"},"elements"),", your\n",(0,i.kt)("strong",{parentName:"p"},"objects"),", and your ",(0,i.kt)("strong",{parentName:"p"},"application"),".")),(0,i.kt)("p",null,"What makes Cypress unique from other testing tools is that assertions\n",(0,i.kt)("strong",{parentName:"p"},"automatically retry"),". Think of them as ",(0,i.kt)("strong",{parentName:"p"},"guards")," - assertions describe what\nyour application should look like, and Cypress will automatically ",(0,i.kt)("strong",{parentName:"p"},"block, wait,\nand retry")," until it reaches that state."),(0,i.kt)("h3",{id:"Asserting-in-English"},"Asserting in English"),(0,i.kt)("p",null,"Let's look at how you'd describe an assertion in English:"),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"After clicking on this ",(0,i.kt)("inlineCode",{parentName:"p"},"<button>"),", I expect its class to be ",(0,i.kt)("inlineCode",{parentName:"p"},"active"),".")),(0,i.kt)("p",null,"To express this in Cypress you'd write:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"cy.get('button').click()\ncy.get('button').should('have.class', 'active')\n")),(0,i.kt)("p",null,"This above test will pass even if the ",(0,i.kt)("inlineCode",{parentName:"p"},".active")," class is applied to the button\nasynchronously, after an indeterminate period of time or even if the button is\nremoved from the DOM entirely for a while (replaced with a waiting spinner, for\nexample)."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"// even though we are adding the class\n// after two seconds...\n// this test will still pass!\n$('button').on('click', (e) => {\n  setTimeout(() => {\n    $(e.target).addClass('active')\n  }, 2000)\n})\n")),(0,i.kt)("p",null,"Here's another example."),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"After making an HTTP request to my server, I expect the response body to equal\n",(0,i.kt)("inlineCode",{parentName:"p"},"{name: 'Jane'}"))),(0,i.kt)("p",null,"To express this with an assertion you'd write:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"cy.request('/users/1').its('body').should('deep.eq', { name: 'Jane' })\n")),(0,i.kt)("h3",{id:"When-To-Assert"},"When To Assert?"),(0,i.kt)("p",null,"Despite the dozens of assertions Cypress makes available to you, sometimes the\nbest test may make no assertions at all! How can this be? Aren't assertions a\nbasic part of testing?"),(0,i.kt)("h4",{id:"Consider-this-example"},"Consider this example:"),(0,i.kt)("visit-mount-example",null,(0,i.kt)(u,{mdxType:"E2EOrCtTabs"},(0,i.kt)("pre",{parentName:"visit-mount-example"},(0,i.kt)("code",{parentName:"pre",className:"language-js"},"cy.visit('/home')\n\ncy.get('.main-menu').contains('New Project').click()\n\ncy.get('.title').type('My Awesome Project')\n\ncy.get('form').submit()\n")),(0,i.kt)("pre",{parentName:"visit-mount-example"},(0,i.kt)("code",{parentName:"pre",className:"language-js"},"cy.mount(<MyComponent />)\n\ncy.get('.main-menu').contains('New Project').click()\n\ncy.get('.title').type('My Awesome Project')\n\ncy.get('form').submit()\n")))),(0,i.kt)("p",null,"Without a single explicit assertion, there are dozens of ways this test can\nfail. Here's a few:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The initial ",(0,i.kt)("a",{parentName:"li",href:"/api/commands/mount"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.mount()"))," or\n",(0,i.kt)("a",{parentName:"li",href:"/api/commands/visit"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.visit()"))," could respond with something other than\nsuccess."),(0,i.kt)("li",{parentName:"ul"},"Any of the ",(0,i.kt)("a",{parentName:"li",href:"/api/commands/get"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.get()"))," queries could fail to find their\nelements in the DOM."),(0,i.kt)("li",{parentName:"ul"},"The element we want to ",(0,i.kt)("a",{parentName:"li",href:"/api/commands/click"},(0,i.kt)("inlineCode",{parentName:"a"},".click()"))," on could be covered\nby another element."),(0,i.kt)("li",{parentName:"ul"},"The input we want to ",(0,i.kt)("a",{parentName:"li",href:"/api/commands/type"},(0,i.kt)("inlineCode",{parentName:"a"},".type()"))," into could be disabled."),(0,i.kt)("li",{parentName:"ul"},"Form submission could result in a non-success status code."),(0,i.kt)("li",{parentName:"ul"},"The in-page JS (the application under test) or the component could throw an\nerror.")),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("strong",null,"Core Concept"),(0,i.kt)("p",{parentName:"admonition"},"With Cypress, you don't have to write explicit assertions to have a useful test.\nWithout a single ",(0,i.kt)("inlineCode",{parentName:"p"},"expect()")," or ",(0,i.kt)("inlineCode",{parentName:"p"},".should()"),", a few lines of Cypress can ensure\nthousands of lines of code are working properly across the client and server."),(0,i.kt)("p",{parentName:"admonition"},"This is because many commands have built in Implicit Assertions which offer\nyou a high level of confidence that your application is working as expected.")),(0,i.kt)("h3",{id:"Implicit-Assertions"},"Implicit Assertions"),(0,i.kt)("p",null,"Many commands have default, built-in assertions, or rather have requirements\nthat may cause it to fail without needing an explicit assertion you've added."),(0,i.kt)("h4",{id:"For-instance"},"For instance:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/visit"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.visit()"))," expects the page to send ",(0,i.kt)("inlineCode",{parentName:"li"},"text/html"),"\ncontent with a ",(0,i.kt)("inlineCode",{parentName:"li"},"200")," status code."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/request"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.request()"))," expects the remote server to exist and\nprovide a response."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/contains"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.contains()"))," expects the element with content to\neventually exist in the DOM."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/get"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.get()"))," expects the element to eventually exist in the\nDOM."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/find"},(0,i.kt)("inlineCode",{parentName:"a"},".find()"))," also expects the element to eventually exist\nin the DOM."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/type"},(0,i.kt)("inlineCode",{parentName:"a"},".type()"))," expects the element to eventually be in a\n",(0,i.kt)("em",{parentName:"li"},"typeable")," state."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/click"},(0,i.kt)("inlineCode",{parentName:"a"},".click()"))," expects the element to eventually be in an\n",(0,i.kt)("em",{parentName:"li"},"actionable")," state."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/its"},(0,i.kt)("inlineCode",{parentName:"a"},".its()"))," expects to eventually find a property on the\ncurrent subject.")),(0,i.kt)("p",null,"Certain commands may have a specific requirement that causes them to immediately\nfail without retrying, such as ",(0,i.kt)("a",{parentName:"p",href:"/api/commands/request"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.request()")),"."),(0,i.kt)("p",null,"Others, such as DOM queries automatically\n",(0,i.kt)("a",{parentName:"p",href:"/guides/core-concepts/retry-ability"},"retry")," and wait for their corresponding\nelements to exist before failing."),(0,i.kt)("p",null,"Action commands automatically wait for their element to reach an\n",(0,i.kt)("a",{parentName:"p",href:"/guides/core-concepts/interacting-with-elements"},"actionable state")," before\nfailing."),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("strong",null,"Core Concept"),(0,i.kt)("p",{parentName:"admonition"},"All DOM commands automatically wait for their elements to exist in the DOM."),(0,i.kt)("p",{parentName:"admonition"},"You ",(0,i.kt)("strong",{parentName:"p"},"never")," need to write ",(0,i.kt)("a",{parentName:"p",href:"/api/commands/should"},(0,i.kt)("inlineCode",{parentName:"a"},".should('exist')"))," after\nquerying the DOM.")),(0,i.kt)("p",null,"Most commands give you the flexibility to override or bypass the default ways\nthey can fail, typically by passing a ",(0,i.kt)("inlineCode",{parentName:"p"},"{force: true}")," option."),(0,i.kt)("h4",{id:"Example-1-Existence-and-Actionability"},"Example #1: Existence and Actionability"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"cy\n  // there is an implicit assertion that this\n  // button must exist in the DOM before proceeding\n  .get('button')\n\n  // before issuing the click, this button must be \"actionable\"\n  // it cannot be disabled, covered, or hidden from view.\n  .click()\n")),(0,i.kt)("p",null,"Cypress will automatically ",(0,i.kt)("em",{parentName:"p"},"wait")," for elements to pass their implicit\nassertions. See ",(0,i.kt)("a",{parentName:"p",href:"#Timeouts"},"Timeouts")," below for more on how timeouts are\ndetermined."),(0,i.kt)("h4",{id:"Example-2-Reversing-the-Implicit-Assertion"},"Example #2: Reversing the Implicit Assertion"),(0,i.kt)("p",null,"Most of the time, when querying for elements, you expect them to eventually\nexist. But sometimes you wish to wait until they ",(0,i.kt)("em",{parentName:"p"},"don't")," exist."),(0,i.kt)("p",null,"All you have to do is add that assertion and Cypress will ",(0,i.kt)("strong",{parentName:"p"},"skip")," implicitly\nwaiting for elements to exist."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"cy.get('button.close').click()\n\n// now Cypress will wait until this\n// <button> is not in the DOM\ncy.get('button.close').should('not.exist')\n\n// and now make sure this #modal does not exist in the DOM\n// and automatically wait until it's gone!\ncy.get('#modal').should('not.exist')\n")),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("strong",null,"Core Concept"),(0,i.kt)("p",{parentName:"admonition"},"If you want to disable the default existence assertion, you can add\n",(0,i.kt)("a",{parentName:"p",href:"/api/commands/should"},(0,i.kt)("inlineCode",{parentName:"a"},".should('not.exist')"))," to any DOM command.")),(0,i.kt)("h4",{id:"Example-3-Other-Implicit-Assertions"},"Example #3: Other Implicit Assertions"),(0,i.kt)("p",null,"Other commands have other implicit assertions not related to the DOM."),(0,i.kt)("p",null,"For instance, ",(0,i.kt)("a",{parentName:"p",href:"/api/commands/its"},(0,i.kt)("inlineCode",{parentName:"a"},".its()"))," requires that the property you're\nasking about exists on the object."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// create an empty object\nconst obj = {}\n\n// set the 'foo' property after 1 second\nsetTimeout(() => {\n  obj.foo = 'bar'\n}, 1000)\n\n// .its() will wait until the 'foo' property is on the object\ncy.wrap(obj).its('foo')\n")),(0,i.kt)("h3",{id:"List-of-Assertions"},"List of Assertions"),(0,i.kt)("p",null,"Cypress bundles ",(0,i.kt)("a",{parentName:"p",href:"/guides/references/bundled-libraries#Chai"},"Chai"),",\n",(0,i.kt)("a",{parentName:"p",href:"/guides/references/bundled-libraries#Chai-jQuery"},"Chai-jQuery"),", and\n",(0,i.kt)("a",{parentName:"p",href:"/guides/references/bundled-libraries#Sinon-Chai"},"Sinon-Chai")," to provide\nbuilt-in assertions. You can see a comprehensive list of them in\n",(0,i.kt)("a",{parentName:"p",href:"/guides/references/assertions"},"the list of assertions reference"),". You can also\n",(0,i.kt)("a",{parentName:"p",href:"/examples/recipes#Fundamentals"},"write your own assertions as Chai plugins")," and\nuse them in Cypress."),(0,i.kt)("h3",{id:"Writing-Assertions"},"Writing Assertions"),(0,i.kt)("p",null,"There are two ways to write assertions in Cypress:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"As Cypress Commands:")," Using ",(0,i.kt)("a",{parentName:"li",href:"/api/commands/should"},(0,i.kt)("inlineCode",{parentName:"a"},".should()"))," or\n",(0,i.kt)("a",{parentName:"li",href:"/api/commands/and"},(0,i.kt)("inlineCode",{parentName:"a"},".and()")),"."),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"As Mocha Assertions:")," Using ",(0,i.kt)("inlineCode",{parentName:"li"},"expect"),".")),(0,i.kt)("h3",{id:"Command-Assertions"},"Command Assertions"),(0,i.kt)("p",null,"Using ",(0,i.kt)("a",{parentName:"p",href:"/api/commands/should"},(0,i.kt)("inlineCode",{parentName:"a"},".should()"))," or ",(0,i.kt)("a",{parentName:"p",href:"/api/commands/and"},(0,i.kt)("inlineCode",{parentName:"a"},".and()")),"\ncommands is the preferred way of making assertions in Cypress. These are typical\nCypress commands, which means they apply to the currently yielded subject in the\ncommand chain."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"// The subject here is the first <tr>.\n// This asserts that the <tr> has an .active class\ncy.get('tbody tr:first').should('have.class', 'active')\n")),(0,i.kt)("p",null,"You can chain multiple assertions together using ",(0,i.kt)("a",{parentName:"p",href:"/api/commands/and"},(0,i.kt)("inlineCode",{parentName:"a"},".and()")),",\nwhich is another name for ",(0,i.kt)("a",{parentName:"p",href:"/api/commands/should"},(0,i.kt)("inlineCode",{parentName:"a"},".should()"))," that makes things\nmore readable:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"cy.get('#header a')\n  .should('have.class', 'active')\n  .and('have.attr', 'href', '/users')\n")),(0,i.kt)("p",null,"Because ",(0,i.kt)("a",{parentName:"p",href:"/api/commands/should"},(0,i.kt)("inlineCode",{parentName:"a"},".should('have.class')"))," does not change the\nsubject, ",(0,i.kt)("a",{parentName:"p",href:"/api/commands/and"},(0,i.kt)("inlineCode",{parentName:"a"},".and('have.attr')"))," is executed against the same\nelement. This is handy when you need to assert multiple things against a single\nsubject quickly."),(0,i.kt)("h3",{id:"Mocha-Assertions"},"Mocha Assertions"),(0,i.kt)("p",null,"Using ",(0,i.kt)("inlineCode",{parentName:"p"},"expect")," allows you to assert on any JavaScript object, not just the\ncurrent subject. This is probably how you're used to seeing assertions written\nin unit tests:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// the explicit subject here is the boolean: true\nexpect(true).to.be.true\n")),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("strong",null,"Did you know you can write Unit Tests in Cypress?"),(0,i.kt)("p",{parentName:"admonition"},"Check out our example recipes for ",(0,i.kt)("a",{parentName:"p",href:"/examples/recipes"},"unit testing")," and\n",(0,i.kt)("a",{parentName:"p",href:"/examples/recipes#Unit-Testing"},"unit testing React components"),".")),(0,i.kt)("p",null,"Mocha assertions are great when you want to:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Perform custom logic prior to making the assertion."),(0,i.kt)("li",{parentName:"ul"},"Make multiple assertions against the same subject.")),(0,i.kt)("p",null,"The ",(0,i.kt)("a",{parentName:"p",href:"/api/commands/should"},(0,i.kt)("inlineCode",{parentName:"a"},".should()"))," assertion allows us to pass a callback\nfunction that takes the yielded subject as its first argument. This works like\n",(0,i.kt)("a",{parentName:"p",href:"/api/commands/then"},(0,i.kt)("inlineCode",{parentName:"a"},".then()")),", except Cypress automatically ",(0,i.kt)("strong",{parentName:"p"},"waits and\nretries")," for everything inside of the callback function to pass."),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("strong",null,"Complex Assertions"),(0,i.kt)("p",{parentName:"admonition"},"The example below is a use case where we are asserting across multiple elements.\nUsing a ",(0,i.kt)("a",{parentName:"p",href:"/api/commands/should"},(0,i.kt)("inlineCode",{parentName:"a"},".should()"))," callback function is a great way to\nquery from a ",(0,i.kt)("strong",{parentName:"p"},"parent")," into multiple children elements and assert something\nabout their state."),(0,i.kt)("p",{parentName:"admonition"},"Doing so enables you to ",(0,i.kt)("strong",{parentName:"p"},"block")," and ",(0,i.kt)("strong",{parentName:"p"},"guard")," Cypress by ensuring the state of\ndescendants matches what you expect without needing to query them individually\nwith regular Cypress DOM commands.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"cy.get('p').should(($p) => {\n  // massage our subject from a DOM element\n  // into an array of texts from all of the p's\n  let texts = $p.map((i, el) => {\n    return Cypress.$(el).text()\n  })\n\n  // jQuery map returns jQuery object\n  // and .get() converts this to an array\n  texts = texts.get()\n\n  // array should have length of 3\n  expect(texts).to.have.length(3)\n\n  // with this specific content\n  expect(texts).to.deep.eq([\n    'Some text from first p',\n    'More text from second p',\n    'And even more text from third p',\n  ])\n})\n")),(0,i.kt)("admonition",{type:"danger"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("strong",{parentName:"p"},"Make sure ",(0,i.kt)("inlineCode",{parentName:"strong"},".should()")," is safe")),(0,i.kt)("p",{parentName:"admonition"},"When using a callback function with ",(0,i.kt)("a",{parentName:"p",href:"/api/commands/should"},(0,i.kt)("inlineCode",{parentName:"a"},".should()")),", be sure\nthat the entire function can be executed multiple times without side effects.\nCypress applies its ",(0,i.kt)("a",{parentName:"p",href:"/guides/core-concepts/retry-ability"},"retry logic")," to these\nfunctions: if there's a failure, it will repeatedly rerun the assertions until\nthe timeout is reached. That means your code should be retry-safe. The technical\nterm for this means your code must be ",(0,i.kt)("strong",{parentName:"p"},"idempotent"),".")),(0,i.kt)("h2",{id:"Timeouts"},"Timeouts"),(0,i.kt)("p",null,"Almost all commands can time out in some way."),(0,i.kt)("p",null,"All assertions, whether they're the default ones or whether they've been added\nby you all share the same timeout values."),(0,i.kt)("h3",{id:"Applying-Timeouts"},"Applying Timeouts"),(0,i.kt)("p",null,"You can modify a commands's timeout. This timeout affects both its default\nassertions (if any) and any specific assertions you've added."),(0,i.kt)("p",null,"Remember because assertions are used to describe a condition of the previous\ncommands - the ",(0,i.kt)("inlineCode",{parentName:"p"},"timeout")," modification goes on the previous commands ",(0,i.kt)("em",{parentName:"p"},"not the\nassertions"),"."),(0,i.kt)("h4",{id:"Example-1-Implicit-Assertion"},"Example #1: Implicit Assertion"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// because .get() has an implicit assertion\n// that this element exists, it can time out and fail\ncy.get('.mobile-nav')\n")),(0,i.kt)("p",null,"Under the hood Cypress:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Queries for the element ",(0,i.kt)("inlineCode",{parentName:"p"},".mobile-nav")),(0,i.kt)("p",{parentName:"li"},"\u2728",(0,i.kt)("strong",{parentName:"p"},"and waits up to 4 seconds for it to exist in the DOM"),"\u2728"))),(0,i.kt)("h4",{id:"Example-2-Additional-Assertions"},"Example #2: Additional Assertions"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// we've added 2 assertions to our test\ncy.get('.mobile-nav').should('be.visible').and('contain', 'Home')\n")),(0,i.kt)("p",null,"Under the hood Cypress:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Queries for the element ",(0,i.kt)("inlineCode",{parentName:"p"},".mobile-nav")),(0,i.kt)("p",{parentName:"li"},"\u2728",(0,i.kt)("strong",{parentName:"p"},"and waits up to 4 seconds for it to exist in the DOM"),"\u2728 \u2728",(0,i.kt)("strong",{parentName:"p"},"and be\nvisible"),"\u2728 \u2728",(0,i.kt)("strong",{parentName:"p"},"and contain the text: Home"),"\u2728"))),(0,i.kt)("p",null,"The ",(0,i.kt)("em",{parentName:"p"},"total")," amount of time Cypress will wait for ",(0,i.kt)("em",{parentName:"p"},"all")," of the assertions to pass\nis for the duration of the ",(0,i.kt)("a",{parentName:"p",href:"/api/commands/get"},"cy.get()")," ",(0,i.kt)("inlineCode",{parentName:"p"},"timeout")," (which is 4\nseconds)."),(0,i.kt)("p",null,"Timeouts can be modified per command and this will affect all implicit\nassertions and any assertions chained after that command."),(0,i.kt)("h4",{id:"Example-3-Modifying-Timeouts"},"Example #3: Modifying Timeouts"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// we've modified the timeout which affects the implicit\n// assertions as well as all explicit ones.\ncy.get('.mobile-nav', { timeout: 10000 })\n  .should('be.visible')\n  .and('contain', 'Home')\n")),(0,i.kt)("p",null,"Under the hood Cypress:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Gets the element ",(0,i.kt)("inlineCode",{parentName:"p"},".mobile-nav")),(0,i.kt)("p",{parentName:"li"},"\u2728",(0,i.kt)("strong",{parentName:"p"},"and waits up to 10 seconds for it to exist in the DOM"),"\u2728 \u2728",(0,i.kt)("strong",{parentName:"p"},"and be\nvisible"),"\u2728 \u2728",(0,i.kt)("strong",{parentName:"p"},"and contain the text: Home"),"\u2728"))),(0,i.kt)("p",null,"Notice that this timeout has flowed down to all assertions and Cypress will now\nwait ",(0,i.kt)("em",{parentName:"p"},"up to 10 seconds total")," for all of them to pass."),(0,i.kt)("admonition",{type:"danger"},(0,i.kt)("p",{parentName:"admonition"},"Note that you ",(0,i.kt)("em",{parentName:"p"},"never")," change the timeout inside the assertion. The ",(0,i.kt)("inlineCode",{parentName:"p"},"timeout"),"\nparameter ",(0,i.kt)("strong",{parentName:"p"},"always")," goes inside the command."),(0,i.kt)("pre",{parentName:"admonition"},(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// \ud83d\udea8 DOES NOT WORK\ncy.get('.selector').should('be.visible', { timeout: 1000 })\n// \u2705 THE CORRECT WAY\ncy.get('.selector', { timeout: 1000 }).should('be.visible')\n")),(0,i.kt)("p",{parentName:"admonition"},"Remember, you are retrying the command with attached assertions, not just the\nassertions!")),(0,i.kt)("h3",{id:"Default-Values"},"Default Values"),(0,i.kt)("p",null,"Cypress offers several different timeout values based on the type of command."),(0,i.kt)("p",null,"We've set their default timeout durations based on how long we expect certain\nactions to take."),(0,i.kt)("p",null,"For instance:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/visit"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.visit()"))," loads a remote page and does not resolve\n",(0,i.kt)("em",{parentName:"li"},"until all of the external resources complete their loading phase"),". This may\ntake awhile, so its default timeout is set to ",(0,i.kt)("inlineCode",{parentName:"li"},"60000ms"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/exec"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.exec()"))," runs a system command such as ",(0,i.kt)("em",{parentName:"li"},"seeding a\ndatabase"),". We expect this to potentially take a long time, and its default\ntimeout is set to ",(0,i.kt)("inlineCode",{parentName:"li"},"60000ms"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/commands/wait"},(0,i.kt)("inlineCode",{parentName:"a"},"cy.wait()"))," actually uses 2 different timeouts. When\nwaiting for a\n",(0,i.kt)("a",{parentName:"li",href:"/guides/core-concepts/variables-and-aliases#Routes"},"routing alias"),", we wait\nfor a matching request for ",(0,i.kt)("inlineCode",{parentName:"li"},"5000ms"),", and then additionally for the server's\nresponse for ",(0,i.kt)("inlineCode",{parentName:"li"},"30000ms"),". We expect your application to make a matching request\nquickly, but we expect the server's response to potentially take much longer.")),(0,i.kt)("p",null,"That leaves most other commands including all DOM queries to time out by default\nafter 4000ms."))}k.isMDXComponent=!0}}]);