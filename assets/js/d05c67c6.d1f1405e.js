"use strict";(self.webpackChunkcypress_docusaurus_ts=self.webpackChunkcypress_docusaurus_ts||[]).push([[8116],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>f});var r=n(7294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var l=r.createContext({}),u=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=u(e.components);return r.createElement(l.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,s=e.mdxType,a=e.originalType,l=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),d=u(n),m=s,f=d["".concat(l,".").concat(m)]||d[m]||c[m]||a;return n?r.createElement(f,i(i({ref:t},p),{},{components:n})):r.createElement(f,i({ref:t},p))}));function f(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var a=n.length,i=new Array(a);i[0]=m;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[d]="string"==typeof e?e:s,i[1]=o;for(var u=2;u<a;u++)i[u]=n[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},6293:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>k,frontMatter:()=>a,metadata:()=>o,toc:()=>u});var r=n(7462),s=(n(7294),n(3905));const a={title:"Test Retries"},i=void 0,o={unversionedId:"guides/guides/test-retries",id:"guides/guides/test-retries",title:"Test Retries",description:"What you'll learn",source:"@site/docs/guides/guides/test-retries.mdx",sourceDirName:"guides/guides",slug:"/guides/guides/test-retries",permalink:"/cypress-documentation/guides/guides/test-retries",draft:!1,editUrl:"https://github.com/cypress-io/cypress-documentation/tree/main/docs/guides/guides/test-retries.mdx",tags:[],version:"current",lastUpdatedAt:1696481464,formattedLastUpdatedAt:"Oct 5, 2023",frontMatter:{title:"Test Retries"},sidebar:"guides",previous:{title:"Stubs, Spies, and Clocks",permalink:"/cypress-documentation/guides/guides/stubs-spies-and-clocks"},next:{title:"Web Security",permalink:"/cypress-documentation/guides/guides/web-security"}},l={},u=[{value:"Introduction",id:"Introduction",level:2},{value:"How It Works",id:"How-It-Works",level:2},{value:"Configure Test Retries",id:"Configure-Test-Retries",level:2},{value:"Global Configuration",id:"Global-Configuration",level:3},{value:"Configure retry attempts for all modes",id:"Configure-retry-attempts-for-all-modes",level:4},{value:"Custom Configurations",id:"Custom-Configurations",level:3},{value:"Individual Test(s)",id:"Individual-Tests",level:4},{value:"Test Suite(s)",id:"Test-Suites",level:4},{value:"Screenshots",id:"Screenshots",level:2},{value:"Videos",id:"Videos",level:2},{value:"Only upload videos for specs with failing or retried tests",id:"Only-upload-videos-for-specs-with-failing-or-retried-tests",level:3},{value:"Cypress Cloud",id:"Cypress-Cloud",level:2},{value:"Frequently Asked Questions (FAQs)",id:"Frequently-Asked-Questions-FAQs",level:2},{value:"Will retried tests be counted as more than one test result in my billing?",id:"Will-retried-tests-be-counted-as-more-than-one-test-result-in-my-billing",level:3},{value:"Can I access the current attempt counter from the test?",id:"Can-I-access-the-current-attempt-counter-from-the-test",level:3}],p=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,s.kt)("div",t)},d=p("Icon"),c=p("DocsImage"),m=p("E2EOrCtTabs"),f=p("CypressConfigFileTabs"),h=p("DocsVideo"),g=p("TestReplayInfo"),y={toc:u};function k(e){let{components:t,...n}=e;return(0,s.kt)("wrapper",(0,r.Z)({},y,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("admonition",{type:"info"},(0,s.kt)("h2",{parentName:"admonition",id:"What-youll-learn"},(0,s.kt)(d,{name:"graduation-cap",mdxType:"Icon"})," What you'll learn"),(0,s.kt)("ul",{parentName:"admonition"},(0,s.kt)("li",{parentName:"ul"},"What are test retries?"),(0,s.kt)("li",{parentName:"ul"},"Why are test retries important?"),(0,s.kt)("li",{parentName:"ul"},"How to configure test retries"))),(0,s.kt)("h2",{id:"Introduction"},"Introduction"),(0,s.kt)("p",null,"End-to-end (E2E) tests excel at testing complex systems. However, there are\nstill behaviors that are hard to verify and make tests flaky (i.e., unreliable)\nand fail sometimes due to unpredictable conditions (eg., temporary outages in\nexternal dependencies, random network errors, etc.). Some other common race\nconditions that could result in unreliable tests include:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Animations"),(0,s.kt)("li",{parentName:"ul"},"API calls"),(0,s.kt)("li",{parentName:"ul"},"Test server / database availability"),(0,s.kt)("li",{parentName:"ul"},"Resource dependencies availability"),(0,s.kt)("li",{parentName:"ul"},"Network issues")),(0,s.kt)("p",null,"With test retries, Cypress is able to retry failed tests to help reduce test\nflakiness and continuous integration (CI) build failures. By doing so, this will\nsave your team valuable time and resources so you can focus on what matters most\nto you."),(0,s.kt)("h2",{id:"How-It-Works"},"How It Works"),(0,s.kt)("p",null,"By default, tests will not retry when they fail. You will need to\n",(0,s.kt)("a",{parentName:"p",href:"#Configure-Test-Retries"},"enable test retries in your configuration")," to use this\nfeature."),(0,s.kt)("p",null,"Once test retries are enabled, tests can be configured to have X number of retry\nattempts. For example, if test retries has been configured with ",(0,s.kt)("inlineCode",{parentName:"p"},"2")," retry\nattempts, Cypress will retry tests up to 2 additional times (for a total of 3\nattempts) before potentially being marked as a failed test."),(0,s.kt)("p",null,"When each test is run again, the following\n",(0,s.kt)("a",{parentName:"p",href:"/guides/core-concepts/writing-and-organizing-tests#Hooks"},"hooks")," will be re-run\nalso:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"beforeEach")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"afterEach"))),(0,s.kt)("admonition",{type:"caution"},(0,s.kt)("p",{parentName:"admonition"},"However, failures in ",(0,s.kt)("inlineCode",{parentName:"p"},"before")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"after")," hooks will not trigger a retry.")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"The following is a detailed step-by-step example of how test retries works:")),(0,s.kt)("p",null,"Assuming we have configured test retries with ",(0,s.kt)("inlineCode",{parentName:"p"},"2")," retry attempts (for a total of\n3 attempts), here is how the tests might run:"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("p",{parentName:"li"},"A test runs for the first time. If the"),(0,s.kt)(d,{name:"check-circle",color:"green",mdxType:"Icon"})," test passes, Cypress will move forward with any remaining tests as usual."),(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("p",{parentName:"li"},"If the ",(0,s.kt)(d,{name:"times",color:"red",mdxType:"Icon"})," test fails, Cypress will tell you\nthat the first attempt failed and will attempt to run the test a second time."))),(0,s.kt)(c,{src:"/img/guides/test-retries/v10/attempt-2-start.png",mdxType:"DocsImage"}),(0,s.kt)("ol",{start:3},(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("p",{parentName:"li"},"If the ",(0,s.kt)(d,{name:"check-circle",color:"green",mdxType:"Icon"})," test passes after the\nsecond attempt, Cypress will continue with any remaining tests.")),(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("p",{parentName:"li"},"If the ",(0,s.kt)(d,{name:"times",color:"red",mdxType:"Icon"})," test fails a second time, Cypress\nwill make the final third attempt to re-run the test."))),(0,s.kt)(c,{src:"/img/guides/test-retries/v10/attempt-3-start.png",mdxType:"DocsImage"}),(0,s.kt)("ol",{start:5},(0,s.kt)("li",{parentName:"ol"},"If the ",(0,s.kt)(d,{name:"times",color:"red",mdxType:"Icon"})," test fails a third time, Cypress\nwill mark the test as failed and then move on to run any remaining tests.")),(0,s.kt)(c,{src:"/img/guides/test-retries/v10/attempt-3-fail.png",mdxType:"DocsImage"}),(0,s.kt)("p",null,"The following is a screen capture of what test retries looks like on the same\nfailed test when run via ",(0,s.kt)("a",{parentName:"p",href:"/guides/guides/command-line#cypress-run"},"cypress run"),"."),(0,s.kt)(c,{src:"/img/guides/test-retries/cli-error-message.png",mdxType:"DocsImage"}),(0,s.kt)("p",null,"During ",(0,s.kt)("a",{parentName:"p",href:"/guides/guides/command-line#cypress-open"},"cypress open")," you will be able\nto see the number of attempts made in the\n",(0,s.kt)("a",{parentName:"p",href:"/guides/core-concepts/cypress-app#Command-Log"},"Command Log")," and expand each\nattempt for review and debugging if desired."),(0,s.kt)("h2",{id:"Configure-Test-Retries"},"Configure Test Retries"),(0,s.kt)("h3",{id:"Global-Configuration"},"Global Configuration"),(0,s.kt)("p",null,"Typically you will want to define different retry attempts for ",(0,s.kt)("inlineCode",{parentName:"p"},"cypress run"),"\nversus ",(0,s.kt)("inlineCode",{parentName:"p"},"cypress open"),". You can configure this in the\n",(0,s.kt)("a",{parentName:"p",href:"/guides/references/configuration#Global"},"Cypress configuration"),"\nby passing the ",(0,s.kt)("inlineCode",{parentName:"p"},"retries")," option an object with the following options:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"runMode")," allows you to define the number of test retries when running\n",(0,s.kt)("inlineCode",{parentName:"li"},"cypress run")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"openMode")," allows you to define the number of test retries when running\n",(0,s.kt)("inlineCode",{parentName:"li"},"cypress open"))),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx"},'{\n  "retries": {\n    // Configure retry attempts for `cypress run`\n    // Default is 0\n    "runMode": 2,\n    // Configure retry attempts for `cypress open`\n    // Default is 0\n    "openMode": 0\n  }\n}\n')),(0,s.kt)("h4",{id:"Configure-retry-attempts-for-all-modes"},"Configure retry attempts for all modes"),(0,s.kt)("p",null,"If you want to configure the retry attempts for all tests run in both\n",(0,s.kt)("inlineCode",{parentName:"p"},"cypress run")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"cypress open"),", you can configure this in the\n",(0,s.kt)("a",{parentName:"p",href:"/guides/references/configuration#Global"},"Cypress configuration"),"\nby defining the ",(0,s.kt)("inlineCode",{parentName:"p"},"retries")," property and setting the desired number of retries."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx"},'{\n  "retries": 1\n}\n')),(0,s.kt)("h3",{id:"Custom-Configurations"},"Custom Configurations"),(0,s.kt)("h4",{id:"Individual-Tests"},"Individual Test(s)"),(0,s.kt)("p",null,"If you want to configure retry attempts on a specific test, you can set this by\nusing the\n",(0,s.kt)("a",{parentName:"p",href:"/guides/core-concepts/writing-and-organizing-tests#Test-Configuration"},"test's configuration"),"."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx"},"// Customize retry attempts for an individual test\ndescribe('User sign-up and login', () => {\n  // `it` test block with no custom configuration\n  it('should redirect unauthenticated user to sign-in page', () => {\n    // ...\n  })\n\n  // `it` test block with custom configuration\n  it(\n    'allows user to login',\n    {\n      retries: {\n        runMode: 2,\n        openMode: 1,\n      },\n    },\n    () => {\n      // ...\n    }\n  )\n})\n")),(0,s.kt)("h4",{id:"Test-Suites"},"Test Suite(s)"),(0,s.kt)("p",null,"If you want to configure try attempts for a suite of tests, you can do this by\nsetting the suite's configuration."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx"},"// Customizing retry attempts for a suite of tests\ndescribe(\n  'User bank accounts',\n  {\n    retries: {\n      runMode: 2,\n      openMode: 1,\n    },\n  },\n  () => {\n    // The per-suite configuration is applied to each test\n    // If a test fails, it will be retried\n    it('allows a user to view their transactions', () => {\n      // ...\n    })\n\n    it('allows a user to edit their transactions', () => {\n      // ...\n    })\n  }\n)\n")),(0,s.kt)("p",null,"You can find more information about custom configurations here:\n",(0,s.kt)("a",{parentName:"p",href:"/guides/references/configuration#Test-Configuration"},"Test Configuration")),(0,s.kt)("h2",{id:"Screenshots"},"Screenshots"),(0,s.kt)("p",null,"When a test retries, Cypress will continue to take screenshots for each failed\nattempt or ",(0,s.kt)("a",{parentName:"p",href:"/api/commands/screenshot"},"cy.screenshot()")," and suffix each new\nscreenshot with ",(0,s.kt)("inlineCode",{parentName:"p"},"(attempt n)"),", corresponding to the current retry attempt\nnumber."),(0,s.kt)("p",null,"With the following test code, you would see the below screenshot filenames when\nall 3 attempts fail:"),(0,s.kt)("visit-mount-example",null,(0,s.kt)(m,{mdxType:"E2EOrCtTabs"},(0,s.kt)("pre",{parentName:"visit-mount-example"},(0,s.kt)("code",{parentName:"pre",className:"language-js"},"describe('User Login', () => {\n  it('displays login errors', () => {\n    cy.visit('/')\n    cy.screenshot('user-login-errors')\n    // ...\n  })\n})\n")),(0,s.kt)("pre",{parentName:"visit-mount-example"},(0,s.kt)("code",{parentName:"pre",className:"language-js"},"describe('User Login', () => {\n  it('displays login errors', () => {\n    cy.mount(<Login />)\n    cy.screenshot('user-login-errors')\n    // ...\n  })\n})\n")))),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"// screenshot filename from cy.screenshot() on 1st attempt\n'user-login-errors.png'\n// screenshot filename on 1st failed attempt\n'user-login-errors (failed).png'\n// screenshot filename from cy.screenshot() on 2nd attempt\n'user-login-errors (attempt 2).png'\n// screenshot filename on 2nd failed attempt\n'user-login-errors (failed) (attempt 2).png'\n// screenshot filename from cy.screenshot() on 3rd attempt\n'user-login-errors (attempt 3).png'\n// screenshot filename on 3rd failed attempt\n'user-login-errors (failed) (attempt 3).png'\n")),(0,s.kt)("h2",{id:"Videos"},"Videos"),(0,s.kt)("p",null,"You can use Cypress's ",(0,s.kt)("a",{parentName:"p",href:"/api/plugins/after-spec-api"},(0,s.kt)("inlineCode",{parentName:"a"},"after:spec"))," event listener\nthat fires after each spec file is run to delete the recorded video for specs\nthat had no retry attempts or failures. Deleting passing and non-retried videos\nafter the run can save resource space on the machine as well as skip the time\nused to process, compress, and upload the video to\n",(0,s.kt)("a",{parentName:"p",href:"/guides/cloud/introduction"},"Cypress Cloud"),"."),(0,s.kt)("h3",{id:"Only-upload-videos-for-specs-with-failing-or-retried-tests"},"Only upload videos for specs with failing or retried tests"),(0,s.kt)("p",null,"The example below shows how to delete the recorded video for specs that had no\nretry attempts or failures when using Cypress test retries."),(0,s.kt)("cypress-config-plugin-example",null,(0,s.kt)(f,{mdxType:"CypressConfigFileTabs"},(0,s.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,s.kt)("code",{parentName:"pre",className:"language-js"},"const { defineConfig } = require('cypress')\n// need to install these dependencies\n// npm i lodash del --save-dev\nconst _ = require('lodash')\nconst del = require('del')\n\nmodule.exports = defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('after:spec', (spec, results) => {\n        if (results && results.video) {\n          // Do we have failures for any retry attempts?\n          const failures = _.some(results.tests, (test) => {\n            return _.some(test.attempts, { state: 'failed' })\n          })\n          if (!failures) {\n            // delete the video if the spec passed and no tests retried\n            return del(results.video)\n          }\n        }\n      })\n    },\n  },\n})\n")),(0,s.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,s.kt)("code",{parentName:"pre",className:"language-typescript"},"import { defineConfig } from 'cypress'\n// need to install these dependencies\n// npm i lodash del --save-dev\nimport _ from 'lodash'\nimport del from 'del'\n\nexport default defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('after:spec', (spec, results) => {\n        if (results && results.video) {\n          // Do we have failures for any retry attempts?\n          const failures = _.some(results.tests, (test) => {\n            return _.some(test.attempts, { state: 'failed' })\n          })\n          if (!failures) {\n            // delete the video if the spec passed and no tests retried\n            return del(results.video)\n          }\n        }\n      })\n    },\n  },\n})\n")))),(0,s.kt)("h2",{id:"Cypress-Cloud"},"Cypress Cloud"),(0,s.kt)("p",null,"If you are using ",(0,s.kt)("a",{parentName:"p",href:"/guides/cloud/introduction"},"Cypress Cloud"),", information\nrelated to test retries is displayed on the Test Results tab for a run.\nSelecting the Flaky filter will show tests that retried and then passed during\nthe run."),(0,s.kt)("p",null,'These tests are also indicated with a "Flaky" badge on the Latest Runs page and\nTest Results tab on the Run Details page.'),(0,s.kt)(h,{src:"/img/guides/test-retries/flaky-test-filter.mp4",title:"Flaky test filter",mdxType:"DocsVideo"}),(0,s.kt)("p",null,"Clicking on a Test Result will open the Test Case History screen. This\ndemonstrates the number of failed attempts, the screenshots and/or videos of\nfailed attempts, and the error for failed attempts."),(0,s.kt)(c,{src:"/img/guides/test-retries/flake-artifacts-and-errors.png",alt:"Flake artifacts and errors",mdxType:"DocsImage"}),(0,s.kt)("p",null,"You can also see the Flaky Rate for a given test."),(0,s.kt)(c,{src:"/img/guides/test-retries/flaky-rate.png",alt:"Flaky rate",mdxType:"DocsImage"}),(0,s.kt)("p",null,"For a comprehensive view of how flake is affecting your overall test suite, you\ncan review the\n",(0,s.kt)("a",{parentName:"p",href:"/guides/cloud/flaky-test-management#Flake-Detection"},"Flake Detection")," and\n",(0,s.kt)("a",{parentName:"p",href:"/guides/cloud/flaky-test-management#Flake-Alerting"},"Flake Alerting")," features\nhighlighted in the Test Flake Management Guide."),(0,s.kt)(g,{mdxType:"TestReplayInfo"}),(0,s.kt)("h2",{id:"Frequently-Asked-Questions-FAQs"},"Frequently Asked Questions (FAQs)"),(0,s.kt)("h3",{id:"Will-retried-tests-be-counted-as-more-than-one-test-result-in-my-billing"},"Will retried tests be counted as more than one test result in my billing?"),(0,s.kt)("p",null,"No. Tests recorded during ",(0,s.kt)("inlineCode",{parentName:"p"},"cypress run")," with the ",(0,s.kt)("inlineCode",{parentName:"p"},"--record")," flag will be counted\nthe same with or without test retries."),(0,s.kt)("p",null,"We consider each time the ",(0,s.kt)("inlineCode",{parentName:"p"},"it()")," function is called to be a single test for\nbilling purposes. The test retrying will not count as extra test results in your\nbilling."),(0,s.kt)("p",null,"You can always see how many tests you've recorded from your organization's\nBilling & Usage page within ",(0,s.kt)("a",{parentName:"p",href:"https://on.cypress.io/cloud"},"Cypress Cloud"),"."),(0,s.kt)("h3",{id:"Can-I-access-the-current-attempt-counter-from-the-test"},"Can I access the current attempt counter from the test?"),(0,s.kt)("p",null,"Yes, although ordinarily you would not have to, since this is a low-level\ndetail. But if you want to use the current attempt number, you can use\n",(0,s.kt)("a",{parentName:"p",href:"/api/cypress-api/currentretry"},(0,s.kt)("inlineCode",{parentName:"a"},"Cypress.currentRetry")),". If you want to\ndetermine the total allowed attempts you can do the following:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-javascript"},"it('does something differently on retry', { retries: 3 }, () => {\n  // Cypress.currentRetry returns the current test retry count\n  const attempt = Cypress.currentRetry\n  // cy.state('runnable') returns the current test object\n  // we can grab the total allowed attempts from its properties\n  const retries = cy.state('runnable')._retries\n  // use the \"attempt\" and \"retries\" values somehow\n})\n")),(0,s.kt)("p",null,"The above ",(0,s.kt)("inlineCode",{parentName:"p"},"attempt")," variable will have values 0 through 3 (the first default\ntest execution plus three allowed retries). The ",(0,s.kt)("inlineCode",{parentName:"p"},"retries")," constant in this case\nis always 3."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Tip:")," Cypress ",(0,s.kt)("a",{parentName:"p",href:"/api/utilities/_"},"bundles Lodash")," library. Use its helper\nmethods to safely access a property of an object. Let's make sure the function\nsupports different Cypress versions by falling back to the default values."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-javascript"},"it('does something differently on retry', { retries: 3 }, () => {\n  // _.get: if the object or property is missing use the provided default value\n  const attempt = Cypress.currentRetry\n  const retries = Cypress._.get(cy.state('runnable'), '_retries', 0)\n  // use the \"attempt\" and \"retries\" values somehow\n})\n")))}k.isMDXComponent=!0}}]);