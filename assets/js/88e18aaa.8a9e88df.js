"use strict";(self.webpackChunkcypress_docusaurus_ts=self.webpackChunkcypress_docusaurus_ts||[]).push([[3866],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>f});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=r.createContext({}),p=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},c=function(e){var n=p(e.components);return r.createElement(l.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),u=p(t),m=o,f=u["".concat(l,".").concat(m)]||u[m]||d[m]||a;return t?r.createElement(f,s(s({ref:n},c),{},{components:t})):r.createElement(f,s({ref:n},c))}));function f(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,s=new Array(a);s[0]=m;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i[u]="string"==typeof e?e:o,s[1]=i;for(var p=2;p<a;p++)s[p]=t[p];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},4287:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>g,frontMatter:()=>a,metadata:()=>i,toc:()=>p});var r=t(7462),o=(t(7294),t(3905));const a={title:"Browser Launch API"},s=void 0,i={unversionedId:"api/plugins/browser-launch-api",id:"api/plugins/browser-launch-api",title:"Browser Launch API",description:"Before Cypress launches a browser, it gives you the opportunity to modify the",source:"@site/docs/api/plugins/browser-launch-api.mdx",sourceDirName:"api/plugins",slug:"/api/plugins/browser-launch-api",permalink:"/cypress-documentation/api/plugins/browser-launch-api",draft:!1,editUrl:"https://github.com/cypress-io/cypress-documentation/tree/main/docs/api/plugins/browser-launch-api.mdx",tags:[],version:"current",lastUpdatedAt:1698215491,formattedLastUpdatedAt:"Oct 25, 2023",frontMatter:{title:"Browser Launch API"},sidebar:"api",previous:{title:"Before Spec API",permalink:"/cypress-documentation/api/plugins/before-spec-api"},next:{title:"Configuration API",permalink:"/cypress-documentation/api/plugins/configuration-api"}},l={},p=[{value:"Syntax",id:"Syntax",level:2},{value:"Usage",id:"Usage",level:2},{value:"Modify browser launch arguments, preferences, extensions, and environment",id:"Modify-browser-launch-arguments-preferences-extensions-and-environment",level:3},{value:"Modify browser launch arguments:",id:"Modify-browser-launch-arguments",level:4},{value:"Open devtools by default",id:"Open-devtools-by-default",level:5},{value:"Add browser extensions:",id:"Add-browser-extensions",level:4},{value:"Configure browser environment:",id:"Configure-browser-environment",level:4},{value:"Changing browser preferences:",id:"Changing-browser-preferences",level:4},{value:"Modify Electron app switches",id:"Modify-Electron-app-switches",level:3},{value:"Linux/OSX",id:"LinuxOSX",level:4},{value:"Windows",id:"Windows",level:4},{value:"See all Chrome browser switches",id:"See-all-Chrome-browser-switches",level:3},{value:"Examples",id:"Examples",level:2},{value:"Set screen size when running headless",id:"Set-screen-size-when-running-headless",level:3},{value:"Override the device pixel ratio",id:"Override-the-device-pixel-ratio",level:3},{value:"Start fullscreen",id:"Start-fullscreen",level:3},{value:"Use fake video for webcam testing",id:"Use-fake-video-for-webcam-testing",level:3},{value:"Support unique file download mime types",id:"Support-unique-file-download-mime-types",level:3},{value:"Disable <code>--headless=new</code> for Chrome",id:"Disable---headlessnew-for-Chrome",level:3},{value:"Set a Firefox flag",id:"Set-a-Firefox-flag",level:3},{value:"History",id:"History",level:2}],c=e=>function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.kt)("div",n)},u=c("WarningSetupNodeEvents"),d=c("CypressConfigFileTabs"),m=c("Icon"),f=c("DocsImage"),h={toc:p};function g(e){let{components:n,...t}=e;return(0,o.kt)("wrapper",(0,r.Z)({},h,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Before Cypress launches a browser, it gives you the opportunity to modify the\nbrowser preferences, install extensions, add and remove command-line arguments,\nand modify other options from the\n",(0,o.kt)("a",{parentName:"p",href:"/guides/tooling/plugins-guide#Using-a-plugin"},"setupNodeEvents")," function."),(0,o.kt)("h2",{id:"Syntax"},"Syntax"),(0,o.kt)(u,{mdxType:"WarningSetupNodeEvents"}),(0,o.kt)("cypress-config-plugin-example",null,(0,o.kt)(d,{mdxType:"CypressConfigFileTabs"},(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const { defineConfig } = require('cypress')\n\nmodule.exports = defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser = {}, launchOptions) => {\n        /* ... */\n      })\n    },\n  },\n})\n")),(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"import { defineConfig } from 'cypress'\n\nexport default defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser = {}, launchOptions) => {\n        /* ... */\n      })\n    },\n  },\n})\n")))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)(m,{name:"angle-right",mdxType:"Icon"})," browser")," ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"(object)"))),(0,o.kt)("p",null,"An object describing the browser being launched, with the following properties:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Property"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"name")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"string")),(0,o.kt)("td",{parentName:"tr",align:null},"Machine-friendly name, like ",(0,o.kt)("inlineCode",{parentName:"td"},"chrome"),", ",(0,o.kt)("inlineCode",{parentName:"td"},"electron"),", ",(0,o.kt)("inlineCode",{parentName:"td"},"edge"),", or ",(0,o.kt)("inlineCode",{parentName:"td"},"firefox"),".")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"family")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"string")),(0,o.kt)("td",{parentName:"tr",align:null},"Rendering engine being used. ",(0,o.kt)("inlineCode",{parentName:"td"},"chromium")," or ",(0,o.kt)("inlineCode",{parentName:"td"},"firefox"),".")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"channel")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"string")),(0,o.kt)("td",{parentName:"tr",align:null},"Release channel of the browser, such as ",(0,o.kt)("inlineCode",{parentName:"td"},"stable"),", ",(0,o.kt)("inlineCode",{parentName:"td"},"dev"),", or ",(0,o.kt)("inlineCode",{parentName:"td"},"canary"),".")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"displayName")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"string")),(0,o.kt)("td",{parentName:"tr",align:null},"Human-readable display name for the browser.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"version")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"string")),(0,o.kt)("td",{parentName:"tr",align:null},"Full version.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"path")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"string")),(0,o.kt)("td",{parentName:"tr",align:null},"Path to the browser on disk. Blank for Electron.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"info")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"string")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("em",{parentName:"td"},"(Optional)")," Extra information about the browser (used for display in the browser selector)")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"majorVersion")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"number")),(0,o.kt)("td",{parentName:"tr",align:null},"The major version number of the browser.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"isHeadless")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"boolean")),(0,o.kt)("td",{parentName:"tr",align:null},"Whether the browser is running headlessly.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"isHeaded")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"boolean")),(0,o.kt)("td",{parentName:"tr",align:null},"Whether the browser displays headed.")))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)(m,{name:"angle-right",mdxType:"Icon"})," launchOptions")," ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"(object)"))),(0,o.kt)("p",null,"Options that can be modified to control how the browser is launched, with the\nfollowing properties:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Property"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"preferences")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"object")),(0,o.kt)("td",{parentName:"tr",align:null},"An object describing browser preferences. Differs between browsers. See ",(0,o.kt)("a",{parentName:"td",href:"#Changing-browser-preferences"},"Changing browser preferences")," for details.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"args")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"string[]")),(0,o.kt)("td",{parentName:"tr",align:null},"An array of strings that will be passed as command-line args when the browser is launched. Has no effect on Electron. See ",(0,o.kt)("a",{parentName:"td",href:"#Modify-browser-launch-arguments"},"Modify browser launch arguments")," for details.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"extensions")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"string[]")),(0,o.kt)("td",{parentName:"tr",align:null},"An array of paths to folders containing unpacked WebExtensions to be loaded before the browser starts. Note: Electron currently only supports Chrome DevTools extensions. See ",(0,o.kt)("a",{parentName:"td",href:"#Add-browser-extensions"},"Add browser extensions")," for details.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"env")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"object")),(0,o.kt)("td",{parentName:"tr",align:null},"An object of environment variables to pass to the launched browser. See ",(0,o.kt)("a",{parentName:"td",href:"#Configure-browser-environment"},"Configure browser environment")," for details.")))),(0,o.kt)("h2",{id:"Usage"},"Usage"),(0,o.kt)("h3",{id:"Modify-browser-launch-arguments-preferences-extensions-and-environment"},"Modify browser launch arguments, preferences, extensions, and environment"),(0,o.kt)("p",null,"Using the ",(0,o.kt)("a",{parentName:"p",href:"/guides/tooling/plugins-guide#Using-a-plugin"},"setupNodeEvents"),"\nfunction you can tap into the ",(0,o.kt)("inlineCode",{parentName:"p"},"before:browser:launch")," event and modify how\nCypress launches the browser (e.g. modify arguments, user preferences, and\nextensions)."),(0,o.kt)("p",null,"This event will yield you the ",(0,o.kt)("inlineCode",{parentName:"p"},"browser")," object, which gives you information\nabout the browser, and the ",(0,o.kt)("inlineCode",{parentName:"p"},"launchOptions")," object, which allows you to modify\nhow the browser is launched."),(0,o.kt)("p",null,"The returned ",(0,o.kt)("inlineCode",{parentName:"p"},"launchOptions")," object will become the new launch options for the\nbrowser."),(0,o.kt)("h4",{id:"Modify-browser-launch-arguments"},"Modify browser launch arguments:"),(0,o.kt)("p",null,"Here are args available for the currently supported browsers:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://peter.sh/experiments/chromium-command-line-switches/"},"Chromium-based browsers")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/docs/Mozilla/Command_Line_Options"},"Firefox"))),(0,o.kt)("h5",{id:"Open-devtools-by-default"},"Open devtools by default"),(0,o.kt)("cypress-config-plugin-example",null,(0,o.kt)(d,{mdxType:"CypressConfigFileTabs"},(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const { defineConfig } = require('cypress')\n\nmodule.exports = defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser = {}, launchOptions) => {\n        // `args` is an array of all the arguments that will\n        // be passed to browsers when it launches\n        console.log(launchOptions.args) // print all current args\n\n        if (browser.family === 'chromium' && browser.name !== 'electron') {\n          // auto open devtools\n          launchOptions.args.push('--auto-open-devtools-for-tabs')\n        }\n\n        if (browser.family === 'firefox') {\n          // auto open devtools\n          launchOptions.args.push('-devtools')\n        }\n\n        if (browser.name === 'electron') {\n          // auto open devtools\n          launchOptions.preferences.devTools = true\n        }\n\n        // whatever you return here becomes the launchOptions\n        return launchOptions\n      })\n    },\n  },\n})\n")),(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"import { defineConfig } from 'cypress'\n\nexport default defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser = {}, launchOptions) => {\n        // `args` is an array of all the arguments that will\n        // be passed to browsers when it launches\n        console.log(launchOptions.args) // print all current args\n\n        if (browser.family === 'chromium' && browser.name !== 'electron') {\n          // auto open devtools\n          launchOptions.args.push('--auto-open-devtools-for-tabs')\n        }\n\n        if (browser.family === 'firefox') {\n          // auto open devtools\n          launchOptions.args.push('-devtools')\n        }\n\n        if (browser.name === 'electron') {\n          // auto open devtools\n          launchOptions.preferences.devTools = true\n        }\n\n        // whatever you return here becomes the launchOptions\n        return launchOptions\n      })\n    },\n  },\n})\n")))),(0,o.kt)("h4",{id:"Add-browser-extensions"},"Add browser extensions:"),(0,o.kt)("cypress-config-plugin-example",null,(0,o.kt)(d,{mdxType:"CypressConfigFileTabs"},(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const { defineConfig } = require('cypress')\n\nmodule.exports = defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser, launchOptions) => {\n        // supply the absolute path to an unpacked extension's folder\n        // NOTE: extensions cannot be loaded in headless Chrome\n        launchOptions.extensions.push('Users/jane/path/to/extension')\n\n        return launchOptions\n      })\n    },\n  },\n})\n")),(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"import { defineConfig } from 'cypress'\n\nexport default defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser, launchOptions) => {\n        // supply the absolute path to an unpacked extension's folder\n        // NOTE: extensions cannot be loaded in headless Chrome\n        launchOptions.extensions.push('Users/jane/path/to/extension')\n\n        return launchOptions\n      })\n    },\n  },\n})\n")))),(0,o.kt)("h4",{id:"Configure-browser-environment"},"Configure browser environment:"),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)(m,{name:"exclamation-triangle",mdxType:"Icon"})," This option is not supported when targeting Electron."),(0,o.kt)("cypress-config-plugin-example",null,(0,o.kt)(d,{mdxType:"CypressConfigFileTabs"},(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const { defineConfig } = require('cypress')\n\nmodule.exports = defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser, launchOptions) => {\n        launchOptions.env.CUSTOM_ENV_VALUE = '1'\n\n        return launchOptions\n      })\n    },\n  },\n})\n")),(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"import { defineConfig } from 'cypress'\n\nexport default defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser, launchOptions) => {\n        launchOptions.env.CUSTOM_ENV_VALUE = '1'\n\n        return launchOptions\n      })\n    },\n  },\n})\n")))),(0,o.kt)("h4",{id:"Changing-browser-preferences"},"Changing browser preferences:"),(0,o.kt)("p",null,"Here are preferences available for the currently supported browsers:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://src.chromium.org/viewvc/chrome/trunk/src/chrome/common/pref_names.cc?view=markup"},"Chromium-based browsers")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://github.com/electron/electron/blob/master/docs/api/browser-window.md#new-browserwindowoptions"},"Electron")),(0,o.kt)("li",{parentName:"ul"},"Firefox: visit ",(0,o.kt)("inlineCode",{parentName:"li"},"about:config")," URL within your Firefox browser to see all\navailable preferences.")),(0,o.kt)("cypress-config-plugin-example",null,(0,o.kt)(d,{mdxType:"CypressConfigFileTabs"},(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const { defineConfig } = require('cypress')\n\nmodule.exports = defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser, launchOptions) => {\n        if (browser.family === 'chromium' && browser.name !== 'electron') {\n          // in Chromium, preferences can exist in Local State, Preferences, or Secure Preferences\n          // via launchOptions.preferences, these can be acccssed as `localState`, `default`, and `secureDefault`\n\n          // for example, to set `somePreference: true` in Preferences:\n          launchOptions.preferences.default['preference'] = true\n\n          return launchOptions\n        }\n\n        if (browser.family === 'firefox') {\n          // launchOptions.preferences is a map of preference names to values\n          launchOptions.preferences['some.preference'] = true\n\n          return launchOptions\n        }\n\n        if (browser.name === 'electron') {\n          // launchOptions.preferences is a `BrowserWindow` `options` object\n          launchOptions.preferences.darkTheme = true\n\n          return launchOptions\n        }\n      })\n    },\n  },\n})\n")),(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"import { defineConfig } from 'cypress'\n\nexport default defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser, launchOptions) => {\n        if (browser.family === 'chromium' && browser.name !== 'electron') {\n          // in Chromium, preferences can exist in Local State, Preferences, or Secure Preferences\n          // via launchOptions.preferences, these can be acccssed as `localState`, `default`, and `secureDefault`\n\n          // for example, to set `somePreference: true` in Preferences:\n          launchOptions.preferences.default['preference'] = true\n\n          return launchOptions\n        }\n\n        if (browser.family === 'firefox') {\n          // launchOptions.preferences is a map of preference names to values\n          launchOptions.preferences['some.preference'] = true\n\n          return launchOptions\n        }\n\n        if (browser.name === 'electron') {\n          // launchOptions.preferences is a `BrowserWindow` `options` object\n          launchOptions.preferences.darkTheme = true\n\n          return launchOptions\n        }\n      })\n    },\n  },\n})\n")))),(0,o.kt)("h3",{id:"Modify-Electron-app-switches"},"Modify Electron app switches"),(0,o.kt)("p",null,"The Cypress Launchpad is an Electron application, and its behavior (and the\nbehavior of the bundled-in Electron browser) can be customized using command\nline switches. The supported switches depend on the Electron version, see\n",(0,o.kt)("a",{parentName:"p",href:"https://www.electronjs.org/docs/api/command-line-switches"},"Electron documentation"),"."),(0,o.kt)("p",null,"You can pass Electron-specific launch arguments using the\n",(0,o.kt)("inlineCode",{parentName:"p"},"ELECTRON_EXTRA_LAUNCH_ARGS")," environment variable. For example, to disable HTTP\nbrowser cache and ignore certificate errors, you can set the environment\nvariables before running Cypress like below:"),(0,o.kt)("h4",{id:"LinuxOSX"},"Linux/OSX"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"export ELECTRON_EXTRA_LAUNCH_ARGS=--disable-http-cache --lang=es\n")),(0,o.kt)("h4",{id:"Windows"},"Windows"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"set ELECTRON_EXTRA_LAUNCH_ARGS=--disable-http-cache --lang=es\n")),(0,o.kt)("p",null,"Cypress already sets some the Electron command line switches internally. See\nfile\n",(0,o.kt)("a",{parentName:"p",href:"https://github.com/cypress-io/cypress/blob/develop/packages/server/lib/environment.js"},"packages/server/lib/environment.js"),".\nThere is no way to see all currently set switches after Electron's launch."),(0,o.kt)("h3",{id:"See-all-Chrome-browser-switches"},"See all Chrome browser switches"),(0,o.kt)("p",null,"If you are running Cypress tests using a Chromium-based browser, you can see ALL\ncurrently set command line switches and the browser version information by\nopening a new tab and typing ",(0,o.kt)("inlineCode",{parentName:"p"},"chrome://version")," url."),(0,o.kt)(f,{src:"/img/api/chrome-switches.png",alt:"See all Chrome switches",mdxType:"DocsImage"}),(0,o.kt)("h2",{id:"Examples"},"Examples"),(0,o.kt)("h3",{id:"Set-screen-size-when-running-headless"},"Set screen size when running headless"),(0,o.kt)("p",null,"When a browser runs headless, there is no physical display. You can override the\ndefault screen size of 1280x720 when running headless as shown below. This will\naffect the size of screenshots and videos taken during the run."),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"This setting changes the display size of the screen and does not affect the\n",(0,o.kt)("inlineCode",{parentName:"p"},"viewportWidth")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"viewportHeight")," set in the\n",(0,o.kt)("a",{parentName:"p",href:"/guides/references/configuration"},"Cypress configuration"),". The ",(0,o.kt)("inlineCode",{parentName:"p"},"viewportWidth"),"\nand ",(0,o.kt)("inlineCode",{parentName:"p"},"viewportHeight")," only affect the size of the application under test\ndisplayed inside the Cypress Test Runner. Read the blog post\n",(0,o.kt)("a",{parentName:"p",href:"https://www.cypress.io/blog/2021/03/01/generate-high-resolution-videos-and-screenshots/"},"Generate High-Resolution Videos and Screenshots"),"\nfor details.")),(0,o.kt)("cypress-config-plugin-example",null,(0,o.kt)(d,{mdxType:"CypressConfigFileTabs"},(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const { defineConfig } = require('cypress')\n\nmodule.exports = defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser, launchOptions) => {\n        if (browser.name === 'chrome' && browser.isHeadless) {\n          // fullPage screenshot size is 1400x1200 on non-retina screens\n          // and 2800x2400 on retina screens\n          launchOptions.args.push('--window-size=1400,1200')\n\n          // force screen to be non-retina (1400x1200 size)\n          launchOptions.args.push('--force-device-scale-factor=1')\n\n          // force screen to be retina (2800x2400 size)\n          // launchOptions.args.push('--force-device-scale-factor=2')\n        }\n\n        if (browser.name === 'electron' && browser.isHeadless) {\n          // fullPage screenshot size is 1400x1200\n          launchOptions.preferences.width = 1400\n          launchOptions.preferences.height = 1200\n        }\n\n        if (browser.name === 'firefox' && browser.isHeadless) {\n          // menubars take up height on the screen\n          // so fullPage screenshot size is 1400x1126\n          launchOptions.args.push('--width=1400')\n          launchOptions.args.push('--height=1200')\n        }\n\n        return launchOptions\n      })\n    },\n  },\n})\n")),(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"import { defineConfig } from 'cypress'\n\nexport default defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser, launchOptions) => {\n        if (browser.name === 'chrome' && browser.isHeadless) {\n          // fullPage screenshot size is 1400x1200 on non-retina screens\n          // and 2800x2400 on retina screens\n          launchOptions.args.push('--window-size=1400,1200')\n\n          // force screen to be non-retina (1400x1200 size)\n          launchOptions.args.push('--force-device-scale-factor=1')\n\n          // force screen to be retina (2800x2400 size)\n          // launchOptions.args.push('--force-device-scale-factor=2')\n        }\n\n        if (browser.name === 'electron' && browser.isHeadless) {\n          // fullPage screenshot size is 1400x1200\n          launchOptions.preferences.width = 1400\n          launchOptions.preferences.height = 1200\n        }\n\n        if (browser.name === 'firefox' && browser.isHeadless) {\n          // menubars take up height on the screen\n          // so fullPage screenshot size is 1400x1126\n          launchOptions.args.push('--width=1400')\n          launchOptions.args.push('--height=1200')\n        }\n\n        return launchOptions\n      })\n    },\n  },\n})\n")))),(0,o.kt)("h3",{id:"Override-the-device-pixel-ratio"},"Override the device pixel ratio"),(0,o.kt)("cypress-config-plugin-example",null,(0,o.kt)(d,{mdxType:"CypressConfigFileTabs"},(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const { defineConfig } = require('cypress')\n\nmodule.exports = defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser, launchOptions) => {\n        if (browser.name === 'chrome' && browser.isHeadless) {\n          // force screen to behave like retina\n          // when running Chrome headless browsers\n          // (2560x1440 in size by default)\n          launchOptions.args.push('--force-device-scale-factor=2')\n        }\n\n        return launchOptions\n      })\n    },\n  },\n})\n")),(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"import { defineConfig } from 'cypress'\n\nexport default defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser, launchOptions) => {\n        if (browser.name === 'chrome' && browser.isHeadless) {\n          // force screen to behave like retina\n          // when running Chrome headless browsers\n          // (2560x1440 in size by default)\n          launchOptions.args.push('--force-device-scale-factor=2')\n        }\n\n        return launchOptions\n      })\n    },\n  },\n})\n")))),(0,o.kt)("h3",{id:"Start-fullscreen"},"Start fullscreen"),(0,o.kt)("cypress-config-plugin-example",null,(0,o.kt)(d,{mdxType:"CypressConfigFileTabs"},(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const { defineConfig } = require('cypress')\n\nmodule.exports = defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser = {}, launchOptions) => {\n        if (browser.family === 'chromium' && browser.name !== 'electron') {\n          launchOptions.args.push('--start-fullscreen')\n\n          return launchOptions\n        }\n\n        if (browser.name === 'electron') {\n          launchOptions.preferences.fullscreen = true\n\n          return launchOptions\n        }\n      })\n    },\n  },\n})\n")),(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"import { defineConfig } from 'cypress'\n\nexport default defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser = {}, launchOptions) => {\n        if (browser.family === 'chromium' && browser.name !== 'electron') {\n          launchOptions.args.push('--start-fullscreen')\n\n          return launchOptions\n        }\n\n        if (browser.name === 'electron') {\n          launchOptions.preferences.fullscreen = true\n\n          return launchOptions\n        }\n      })\n    },\n  },\n})\n")))),(0,o.kt)("h3",{id:"Use-fake-video-for-webcam-testing"},"Use fake video for webcam testing"),(0,o.kt)("p",null,"By default, Cypress passes the Chrome command line switch to enable a fake video\nfor a media stream. This is to better enable testing webcam functionality\nwithout having to have the necessary hardware to test."),(0,o.kt)(f,{src:"/img/api/browser-launch-fake-video.gif",alt:"Enable fake video for testing",mdxType:"DocsImage"}),(0,o.kt)("p",null,"You can however send your own video file for testing by passing a Chrome command\nline switch pointing to a video file."),(0,o.kt)("cypress-config-plugin-example",null,(0,o.kt)(d,{mdxType:"CypressConfigFileTabs"},(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const { defineConfig } = require('cypress')\n\nmodule.exports = defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser = {}, launchOptions) => {\n        if (browser.family === 'chromium' && browser.name !== 'electron') {\n          // Mac/Linux\n          launchOptions.args.push(\n            '--use-file-for-fake-video-capture=cypress/fixtures/my-video.y4m'\n          )\n\n          // Windows\n          // launchOptions.args.push('--use-file-for-fake-video-capture=c:\\\\path\\\\to\\\\video\\\\my-video.y4m')\n        }\n\n        return launchOptions\n      })\n    },\n  },\n})\n")),(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"import { defineConfig } from 'cypress'\n\nexport default defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser = {}, launchOptions) => {\n        if (browser.family === 'chromium' && browser.name !== 'electron') {\n          // Mac/Linux\n          launchOptions.args.push(\n            '--use-file-for-fake-video-capture=cypress/fixtures/my-video.y4m'\n          )\n\n          // Windows\n          // launchOptions.args.push('--use-file-for-fake-video-capture=c:\\\\path\\\\to\\\\video\\\\my-video.y4m')\n        }\n\n        return launchOptions\n      })\n    },\n  },\n})\n")))),(0,o.kt)("h3",{id:"Support-unique-file-download-mime-types"},"Support unique file download mime types"),(0,o.kt)("p",null,"Cypress supports a myriad of mime types when testing file downloads, but in case\nyou have a unique one, you can add support for it."),(0,o.kt)("cypress-config-plugin-example",null,(0,o.kt)(d,{mdxType:"CypressConfigFileTabs"},(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const { defineConfig } = require('cypress')\n\nmodule.exports = defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser, options) => {\n        // only Firefox requires all mime types to be listed\n        if (browser.family === 'firefox') {\n          const existingMimeTypes =\n            options.preferences['browser.helperApps.neverAsk.saveToDisk']\n          const myMimeType = 'my/mimetype'\n\n          // prevents the browser download prompt\n          options.preferences[\n            'browser.helperApps.neverAsk.saveToDisk'\n          ] = `${existingMimeTypes},${myMimeType}`\n\n          return options\n        }\n      })\n    },\n  },\n})\n")),(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"import { defineConfig } from 'cypress'\n\nexport default defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser, options) => {\n        // only Firefox requires all mime types to be listed\n        if (browser.family === 'firefox') {\n          const existingMimeTypes =\n            options.preferences['browser.helperApps.neverAsk.saveToDisk']\n          const myMimeType = 'my/mimetype'\n\n          // prevents the browser download prompt\n          options.preferences[\n            'browser.helperApps.neverAsk.saveToDisk'\n          ] = `${existingMimeTypes},${myMimeType}`\n\n          return options\n        }\n      })\n    },\n  },\n})\n")))),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("a",{parentName:"p",href:"/examples/recipes#Testing-the-DOM"},"Check out our example recipe showing how to download and validate CSV and Excel files."))),(0,o.kt)("h3",{id:"Disable---headlessnew-for-Chrome"},"Disable ",(0,o.kt)("inlineCode",{parentName:"h3"},"--headless=new")," for Chrome"),(0,o.kt)("p",null,"Starting in Chrome 112, you can change the value of the ",(0,o.kt)("inlineCode",{parentName:"p"},"--headless")," flag to the\nold value before the ",(0,o.kt)("inlineCode",{parentName:"p"},"--headless=new")," flag was introduced."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"on('before:browser:launch', (browser = {}, launchOptions) => {\n  if (browser.name === 'chrome' && browser.isHeadless) {\n    launchOptions.args = launchOptions.args.map((arg) => {\n      if (arg === '--headless=new') {\n        return '--headless'\n      }\n\n      return arg\n    })\n  }\n\n  return launchOptions\n})\n")),(0,o.kt)("h3",{id:"Set-a-Firefox-flag"},"Set a Firefox flag"),(0,o.kt)("p",null,"If we need to set a particular Firefox flag, like ",(0,o.kt)("inlineCode",{parentName:"p"},"browser.send_pings")," we can do\nit via preferences"),(0,o.kt)("cypress-config-plugin-example",null,(0,o.kt)(d,{mdxType:"CypressConfigFileTabs"},(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const { defineConfig } = require('cypress')\n\nmodule.exports = defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser = {}, launchOptions) => {\n        if (browser.family === 'firefox') {\n          launchOptions.preferences['browser.send_pings'] = true\n        }\n\n        return launchOptions\n      })\n    },\n  },\n})\n")),(0,o.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"import { defineConfig } from 'cypress'\n\nexport default defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      on('before:browser:launch', (browser = {}, launchOptions) => {\n        if (browser.family === 'firefox') {\n          launchOptions.preferences['browser.send_pings'] = true\n        }\n\n        return launchOptions\n      })\n    },\n  },\n})\n")))),(0,o.kt)("p",null,"The above example comes from the blog post\n",(0,o.kt)("a",{parentName:"p",href:"https://glebbahmutov.com/blog/anchor-ping/"},"How to Test Anchor Ping"),"."),(0,o.kt)("h2",{id:"History"},"History"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Version"),(0,o.kt)("th",{parentName:"tr",align:null},"Changes"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"/guides/references/changelog#4-0-0"},"4.0.0")),(0,o.kt)("td",{parentName:"tr",align:null},"New ",(0,o.kt)("inlineCode",{parentName:"td"},"options")," object replaces old ",(0,o.kt)("inlineCode",{parentName:"td"},"args")," as second argument to ",(0,o.kt)("inlineCode",{parentName:"td"},"before:browser:launch"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"/guides/references/changelog#4-0-0"},"4.0.0")),(0,o.kt)("td",{parentName:"tr",align:null},"All Chromium-based browsers, including Electron, have ",(0,o.kt)("inlineCode",{parentName:"td"},"chromium")," set as their ",(0,o.kt)("inlineCode",{parentName:"td"},"family")," property.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"/guides/references/changelog#4-0-0"},"4.0.0")),(0,o.kt)("td",{parentName:"tr",align:null},"Added ",(0,o.kt)("inlineCode",{parentName:"td"},"channel")," property to browser.")))))}g.isMDXComponent=!0}}]);