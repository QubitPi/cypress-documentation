"use strict";(self.webpackChunkcypress_docusaurus_ts=self.webpackChunkcypress_docusaurus_ts||[]).push([[1334],{3905:(e,n,t)=>{t.d(n,{Zo:()=>d,kt:()=>h});var a=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=a.createContext({}),p=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},d=function(e){var n=p(e.components);return a.createElement(l.Provider,{value:n},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),c=p(t),m=r,h=c["".concat(l,".").concat(m)]||c[m]||u[m]||o;return t?a.createElement(h,s(s({ref:n},d),{},{components:t})):a.createElement(h,s({ref:n},d))}));function h(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=t.length,s=new Array(o);s[0]=m;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i[c]="string"==typeof e?e:r,s[1]=i;for(var p=2;p<o;p++)s[p]=t[p];return a.createElement.apply(null,s)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},6939:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>N,frontMatter:()=>o,metadata:()=>i,toc:()=>p});var a=t(7462),r=(t(7294),t(3905));const o={title:"Migration Guide"},s=void 0,i={unversionedId:"guides/references/migration-guide",id:"guides/references/migration-guide",title:"Migration Guide",description:"Migrating to Cypress 12.0",source:"@site/docs/guides/references/migration-guide.mdx",sourceDirName:"guides/references",slug:"/guides/references/migration-guide",permalink:"/cypress-documentation/guides/references/migration-guide",draft:!1,editUrl:"https://github.com/cypress-io/cypress-documentation/tree/main/docs/guides/references/migration-guide.mdx",tags:[],version:"current",frontMatter:{title:"Migration Guide"},sidebar:"guides",previous:{title:"Experiments",permalink:"/cypress-documentation/guides/references/experiments"},next:{title:"Proxy Configuration",permalink:"/cypress-documentation/guides/references/proxy-configuration"}},l={},p=[{value:"Migrating to Cypress 12.0",id:"Migrating-to-Cypress-120",level:2},{value:"Node.js 14+ support",id:"Nodejs-14-support",level:3},{value:"Test Isolation",id:"Test-Isolation",level:3},{value:"Simulating Pre-Test Isolation Behavior",id:"Simulating-Pre-Test-Isolation-Behavior",level:4},{value:"Behavior Changes in Alias Resolution",id:"Behavior-Changes-in-Alias-Resolution",level:3},{value:"Command / Cypress API Changes",id:"Command--Cypress-API-Changes",level:3},{value:"<code>Cypress.Cookies.defaults</code> and <code>Cypress.Cookies.preserveOnce</code>",id:"CypressCookiesdefaults-and-CypressCookiespreserveOnce",level:4},{value:"<code>cy.server()</code>, <code>cy.route()</code> and <code>Cypress.Server.defaults</code>",id:"cyserver-cyroute-and-CypressServerdefaults",level:4},{value:"<code>.invoke()</code>",id:"invoke",level:4},{value:"<code>.should()</code>",id:"should",level:4},{value:"<code>.within()</code>",id:"within",level:4},{value:"<code>Cypress.Commands.overwrite()</code>",id:"CypressCommandsoverwrite",level:4},{value:"Migrating to Cypress 11.0",id:"Migrating-to-Cypress-110",level:2},{value:"Component Testing Updates",id:"Component-Testing-Updates",level:3},{value:"Changes to Mounting Options",id:"Changes-to-Mounting-Options",level:4},{value:"Before (Cypress 10)",id:"Before-Cypress-10",level:4},{value:"After (Cypress 11)",id:"After-Cypress-11",level:4},{value:"React - <code>mountHook</code> Removed",id:"React---mountHook-Removed",level:3},{value:"Before - Cypress 10 and <code>mountHook</code>",id:"Before---Cypress-10-and-mountHook",level:4},{value:"After - Cypress 11 and <code>mount</code>",id:"After---Cypress-11-and-mount",level:4},{value:"React - <code>unmount</code> Removed",id:"React---unmount-Removed",level:3},{value:"Before - Cypress 10 and <code>unmount</code>",id:"Before---Cypress-10-and-unmount",level:4},{value:"After - Cypress 11 and <code>unmountComponentAtNode</code>",id:"After---Cypress-11-and-unmountComponentAtNode",level:4},{value:"Vue - <code>mountCallback</code> Removed",id:"Vue---mountCallback-Removed",level:3},{value:"Before - Cypress 10 and <code>mountCallback</code>",id:"Before---Cypress-10-and-mountCallback",level:4},{value:"After - Cypress 11 and <code>mount</code>",id:"After---Cypress-11-and-mount-1",level:4},{value:"Angular - Providers Mounting Options Change",id:"Angular---Providers-Mounting-Options-Change",level:3},{value:"Vite Dev Server (<code>cypress/vite-dev-server</code>)",id:"Vite-Dev-Server-cypressvite-dev-server",level:3},{value:"Before - Cypress 10 and <code>viteConfig</code>",id:"Before---Cypress-10-and-viteConfig",level:4},{value:"After - Cypress 11 and <code>viteConfig</code>",id:"After---Cypress-11-and-viteConfig",level:4},{value:"Migrating to Cypress 10.0",id:"Migrating-to-Cypress-100",level:2},{value:"Cypress Changes",id:"Cypress-Changes",level:3},{value:"Configuration File Changes",id:"Configuration-File-Changes",level:3},{value:"Plugins File Removed",id:"Plugins-File-Removed",level:3},{value:"Config Option Changes",id:"Config-Option-Changes",level:3},{value:"<code>baseUrl</code>",id:"baseUrl",level:4},{value:"<code>componentFolder</code>",id:"componentFolder",level:4},{value:"<code>devServer</code>",id:"devServer",level:4},{value:"<code>experimentalStudio</code>",id:"experimentalStudio",level:4},{value:"<code>ignoreTestFiles</code> \u2192 <code>excludeSpecPattern</code>",id:"ignoreTestFiles--excludeSpecPattern",level:4},{value:"<code>integrationFolder</code>",id:"integrationFolder",level:4},{value:"<code>pluginsFile</code>",id:"pluginsFile",level:4},{value:"<code>setupNodeEvents()</code>",id:"setupNodeEvents",level:4},{value:"<code>slowTestThreshold</code>",id:"slowTestThreshold",level:4},{value:"<code>supportFile</code>",id:"supportFile",level:4},{value:"<code>testFiles</code> \u2192 <code>specPattern</code>",id:"testFiles--specPattern",level:4},{value:"Updated Test File Locations",id:"Updated-Test-File-Locations",level:3},{value:"Generated Files",id:"Generated-Files",level:3},{value:"Command / Cypress API Changes",id:"Command--Cypress-API-Changes-1",level:3},{value:"<code>cy.mount()</code>",id:"cymount",level:4},{value:"<code>Cypress.Commands.add()</code>",id:"CypressCommandsadd",level:4},{value:"Component Testing Changes",id:"Component-Testing-Changes",level:3},{value:"Code Coverage Plugin",id:"Code-Coverage-Plugin",level:3},{value:"Migrating from <code>cypress-file-upload</code> to <code>.selectFile()</code>",id:"Migrating-from-cypress-file-upload-to-selectFile",level:2},{value:"Quick guide",id:"Quick-guide",level:3},{value:"Examples",id:"Examples",level:3},{value:"Read and attach a fixture",id:"Read-and-attach-a-fixture",level:4},{value:"Using drag-n-drop",id:"Using-drag-n-drop",level:4},{value:"Overriding the file name",id:"Overriding-the-file-name",level:4},{value:"Working with file contents",id:"Working-with-file-contents",level:4},{value:"Specifying a custom mimeType",id:"Specifying-a-custom-mimeType",level:4},{value:"Migrating to Cypress 8.0",id:"Migrating-to-Cypress-80",level:2},{value:"<code>cypress run</code> runs all browsers <code>--headless</code>",id:"cypress-run-runs-all-browsers---headless",level:3},{value:"Default screen size during <code>--headless</code>",id:"Default-screen-size-during---headless",level:3},{value:"Migrating to Cypress 7.0",id:"Migrating-to-Cypress-70",level:2},{value:"cy.intercept() changes",id:"cyintercept-changes",level:3},{value:"Handler ordering is reversed",id:"Handler-ordering-is-reversed",level:4},{value:"URL matching is stricter",id:"URL-matching-is-stricter",level:4},{value:"Deprecated <code>cy.route2()</code> command removed",id:"Deprecated-cyroute2-command-removed",level:4},{value:"<code>res.delay()</code> and <code>res.throttle()</code> have been renamed",id:"resdelay-and-resthrottle-have-been-renamed",level:4},{value:"Falsy values are no longer dropped in <code>StaticResponse</code> bodies",id:"Falsy-values-are-no-longer-dropped-in-StaticResponse-bodies",level:4},{value:"Errors thrown by request and response handlers are no longer wrapped",id:"Errors-thrown-by-request-and-response-handlers-are-no-longer-wrapped",level:4},{value:"Component Testing",id:"Component-Testing",level:3},{value:"1. Remove <code>experimentalComponentTesting</code> config",id:"1-Remove-experimentalComponentTesting-config",level:4},{value:"2. Install component testing dependencies",id:"2-Install-component-testing-dependencies",level:4},{value:"3. Update plugins file to use <code>dev-server:start</code>",id:"3-Update-plugins-file-to-use-dev-serverstart",level:4},{value:"4. Use CLI commands to launch",id:"4-Use-CLI-commands-to-launch",level:4},{value:"5. Update the support file (optionally)",id:"5-Update-the-support-file-optionally",level:4},{value:"Expanded stylesheet support",id:"Expanded-stylesheet-support",level:4},{value:"Desktop GUI no longer displays component tests",id:"Desktop-GUI-no-longer-displays-component-tests",level:4},{value:"Executing all or some component tests",id:"Executing-all-or-some-component-tests",level:4},{value:"Coverage",id:"Coverage",level:4},{value:"cypress-react-selector",id:"cypress-react-selector",level:4},{value:"HTML Side effects",id:"HTML-Side-effects",level:4},{value:"Legacy <code>cypress-react-unit-test</code> and <code>cypress-vue-unit-test</code> packages",id:"Legacy-cypress-react-unit-test-and-cypress-vue-unit-test-packages",level:4},{value:"Uncaught exception and unhandled rejections",id:"Uncaught-exception-and-unhandled-rejections",level:3},{value:"Turn off all uncaught exception handling",id:"Turn-off-all-uncaught-exception-handling",level:4},{value:"Turn off uncaught exception handling unhandled promise rejections",id:"Turn-off-uncaught-exception-handling-unhandled-promise-rejections",level:4},{value:"Node.js 12+ support",id:"Nodejs-12-support",level:3},{value:"Migrating <code>cy.route()</code> to cy.intercept()",id:"Migrating-cyroute-to-cyintercept",level:2},{value:"Match simple route",id:"Match-simple-route",level:3},{value:"Match against <code>url</code> and <code>path</code>",id:"Match-against-url-and-path",level:3},{value:"<code>cy.wait()</code> object",id:"cywait-object",level:3},{value:"Fixtures",id:"Fixtures",level:3},{value:"Override intercepts",id:"Override-intercepts",level:3},{value:"Migrating to Cypress 6.0",id:"Migrating-to-Cypress-60",level:2},{value:"Non-existent element assertions",id:"Non-existent-element-assertions",level:3},{value:"Assertions on non-existent elements",id:"Assertions-on-non-existent-elements",level:4},{value:"Opacity visibility",id:"Opacity-visibility",level:3},{value:"Assert visibility of <code>opacity: 0</code> element",id:"Assert-visibility-of-opacity-0-element",level:4},{value:"Perform actions on <code>opacity: 0</code> element",id:"Perform-actions-on-opacity-0-element",level:4},{value:"<code>cy.wait(alias)</code> type",id:"cywaitalias-type",level:3},{value:"Restore old behavior",id:"Restore-old-behavior",level:4},{value:"<code>\u2014disable-dev-shm-usage</code>",id:"disable-dev-shm-usage",level:3},{value:"Restore old behavior",id:"Restore-old-behavior-1",level:4},{value:"Migrating to Cypress 5.0",id:"Migrating-to-Cypress-50",level:2},{value:"Tests retries",id:"Tests-retries",level:3},{value:"Configure test retries via the CLI",id:"Configure-test-retries-via-the-CLI",level:4},{value:"Configure test retries in the configuration file",id:"Configure-test-retries-in-the-configuration-file",level:4},{value:"Configure test retries per test",id:"Configure-test-retries-per-test",level:4},{value:"Module API results",id:"Module-API-results",level:3},{value:"Cookies <code>whitelist</code> option renamed",id:"Cookies-whitelist-option-renamed",level:3},{value:"<code>blacklistHosts</code> configuration renamed",id:"blacklistHosts-configuration-renamed",level:3},{value:"Return type of <code>Cypress.Blob</code> changed",id:"Return-type-of-CypressBlob-changed",level:3},{value:"<code>cy.server()</code> <code>whitelist</code> option renamed",id:"cyserver-whitelist-option-renamed",level:3},{value:"Cookies <code>sameSite</code> property",id:"Cookies-sameSite-property",level:3},{value:"dirname / filename",id:"dirname--filename",level:3},{value:"Linux dependencies",id:"Linux-dependencies",level:3},{value:"TypeScript esModuleInterop",id:"TypeScript-esModuleInterop",level:3},{value:"TypeScript 3.4+ support",id:"TypeScript-34-support",level:3},{value:"Node.js 10+ support",id:"Nodejs-10-support",level:3},{value:"Migrating to Cypress 4.0",id:"Migrating-to-Cypress-40",level:2},{value:"Mocha upgrade",id:"Mocha-upgrade",level:3},{value:'<Icon name="exclamation-triangle" color="red" /> Breaking Change: invoke <code>done</code> callback and return a promise',id:"Breaking-Change-invoke-done-callback-and-return-a-promise",level:4},{value:"Example #1",id:"Example-1",level:5},{value:"Example #2",id:"Example-2",level:5},{value:"Example #3",id:"Example-3",level:5},{value:'<Icon name="exclamation-triangle" color="red" /> Tests require a title',id:"Tests-require-a-title",level:4},{value:"Chai upgrade",id:"Chai-upgrade",level:3},{value:'<Icon name="exclamation-triangle" color="red" /> Breaking Change: assertions expecting numbers',id:"Breaking-Change-assertions-expecting-numbers",level:4},{value:'<Icon name="exclamation-triangle" color="red" /> Breaking Change: <code>empty</code> assertions',id:"Breaking-Change-empty-assertions",level:4},{value:'<Icon name="exclamation-triangle" color="red" /> Breaking Change: non-existent properties',id:"Breaking-Change-non-existent-properties",level:4},{value:'<Icon name="exclamation-triangle" color="red" /> Breaking Change: <code>include</code> checks strict equality',id:"Breaking-Change-include-checks-strict-equality",level:4},{value:"Sinon.JS upgrade",id:"SinonJS-upgrade",level:3},{value:'<Icon name="exclamation-triangle" color="red" /> Breaking Change: stub non-existent properties',id:"Breaking-Change-stub-non-existent-properties",level:4},{value:'<Icon name="exclamation-triangle" color="red" /> Breaking Change: <code>reset()</code> replaced by <code>resetHistory()</code>',id:"Breaking-Change-reset-replaced-by-resetHistory",level:4},{value:"Plugin Event <code>before:browser:launch</code>",id:"Plugin-Event-beforebrowserlaunch",level:3},{value:"Electron options in <code>before:browser:launch</code>",id:"Electron-options-in-beforebrowserlaunch",level:3},{value:"Launching Chrome Canary with <code>--browser</code>",id:"Launching-Chrome-Canary-with---browser",level:3},{value:"Chromium-based browser <code>family</code>",id:"Chromium-based-browser-family",level:3},{value:"Example #1 (Finding Electron)",id:"Example-1-Finding-Electron",level:4},{value:"Example #2 (Finding Chromium-based browsers)",id:"Example-2-Finding-Chromium-based-browsers",level:4},{value:"<code>cy.writeFile()</code> yields <code>null</code>",id:"cywriteFile-yields-null",level:3},{value:"cy.contains() ignores invisible whitespaces",id:"cycontains-ignores-invisible-whitespaces",level:3},{value:"Node.js 8+ support",id:"Nodejs-8-support",level:3},{value:"CJSX is no longer supported",id:"CJSX-is-no-longer-supported",level:3}],d=e=>function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",n)},c=d("Badge"),u=d("DocsVideo"),m=d("CypressConfigFileTabs"),h=d("Tabs"),g=d("TabItem"),k=d("DocsImage"),y=d("Icon"),f={toc:p};function N(e){let{components:n,...t}=e;return(0,r.kt)("wrapper",(0,a.Z)({},f,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"Migrating-to-Cypress-120"},"Migrating to Cypress 12.0"),(0,r.kt)("p",null,"This guide details the changes and how to change your code to migrate to Cypress\nversion 12.0.\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/changelog#12-0-0"},"See the full changelog for version 12.0"),"."),(0,r.kt)("p",null,"The Session and Origin experiment has been released as General Availability\n(GA), meaning that we have deemed this experiment to be feature complete and\nfree of issues in the majority of use cases. With releasing this as GA, the\n",(0,r.kt)("inlineCode",{parentName:"p"},"experimentalSessionAndOrigin")," flag has been removed, the\n",(0,r.kt)("a",{parentName:"p",href:"/api/commands/origin"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.origin()"))," and\n",(0,r.kt)("a",{parentName:"p",href:"/api/commands/session"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.session()"))," commands are generally available and\n",(0,r.kt)("a",{parentName:"p",href:"/guides/core-concepts/writing-and-organizing-tests#Test-Isolation"},"Test Isolation"),"\nis enabled by default."),(0,r.kt)("h3",{id:"Nodejs-14-support"},"Node.js 14+ support"),(0,r.kt)("p",null,"Cypress comes bundled with its own\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/cypress-io/cypress/blob/develop/.node-version"},"Node.js version"),".\nHowever, installing the ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress")," npm package uses the Node.js version installed\non your system."),(0,r.kt)("p",null,"Node.js 12 reached its end of life on April 30, 2022.\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/nodejs/Release"},"See Node's release schedule"),". This Node.js\nversion will no longer be supported when installing Cypress. The minimum Node.js\nversion supported to install Cypress is Node.js 14+."),(0,r.kt)("h3",{id:"Test-Isolation"},"Test Isolation"),(0,r.kt)("p",null,"The\n",(0,r.kt)("a",{parentName:"p",href:"/guides/core-concepts/writing-and-organizing-tests#Test-Isolation"},(0,r.kt)("inlineCode",{parentName:"a"},"testIsolation")),"\nconfig option is enabled by default. This means Cypress resets the browser\ncontext ",(0,r.kt)("em",{parentName:"p"},"before")," each test by:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"clearing the dom state by visiting ",(0,r.kt)("inlineCode",{parentName:"li"},"about:blank")),(0,r.kt)("li",{parentName:"ul"},"clearing ",(0,r.kt)("a",{parentName:"li",href:"/api/cypress-api/cookies"},"cookies")," in all domains"),(0,r.kt)("li",{parentName:"ul"},"clearing\n",(0,r.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage"},(0,r.kt)("inlineCode",{parentName:"a"},"localStorage")),"\nin all domains"),(0,r.kt)("li",{parentName:"ul"},"clearing\n",(0,r.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/API/Window/sessionStorage"},(0,r.kt)("inlineCode",{parentName:"a"},"sessionStorage")),"\nin all domains")),(0,r.kt)("p",null,"Test suites that relied on the application to persist between tests may have to\nbe updated to revisit their application and rebuild the browser state for each\ntest that needs it."),(0,r.kt)("p",null,"Before this change, it was possible to write tests such that you could rely on\nthe application (i.e. DOM state) to persist between tests. For example you could\nlog in to a CMS in the first test, change some content in the second test,\nverify the new version is displayed on a different URL in the third, and log out\nin the fourth."),(0,r.kt)("p",null,"Here's a simplified example of such a test strategy."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," Multiple small tests against different origins",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"it('logs in', () => {\n  cy.visit('https://example.cypress.io')\n  cy.get('input#password').type('Password123!')\n  cy.get('button#submit').click()\n})\n\nit('updates the content', () => {\n  // already on page redirect from clicking button#submit\n  cy.get('#current-user').contains('logged in')\n  cy.get('button#edit-1').click()\n  cy.get('input#title').type('Updated title')\n  cy.get('button#submit').click()\n  cy.get('.toast').contains('Changes saved!')\n})\n\nit('validates the change', () => {\n  cy.visit('/items/1')\n  cy.get('h1').contains('Updated title')\n})\n")),(0,r.kt)("p",null,"After migrating, when ",(0,r.kt)("inlineCode",{parentName:"p"},"testIsolation=true")," by default, this flow would need to\nbe contained within a single test. While the above practice has always been\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/best-practices#Having-tests-rely-on-the-state-of-previous-tests"},"discouraged"),"\nwe know some users have historically written tests this way, often to get around\nthe ",(0,r.kt)("inlineCode",{parentName:"p"},"same-origin")," restrictions. But with ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/origin"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.origin()")),"\nyou no longer need these kind of brittle hacks, as your multi-origin logic can\nall reside in a single test, like the following."),(0,r.kt)("p",null,"\xa0",(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," One big test using ",(0,r.kt)("inlineCode",{parentName:"p"},"cy.origin()")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"it('securely edits content', () => {\n  cy.origin('cypress.io', () => {\n    cy.visit('https://example.cypress.io')\n    cy.get('input#password').type('Password123!')\n    cy.get('button#submit').click()\n  })\n\n  cy.origin('cypress-dx.com', () => {\n    cy.url().should('contain', 'cms')\n    cy.get('#current-user').contains('logged in')\n    cy.get('button#edit-1').click()\n    cy.get('input#title').type('Updated title')\n    cy.get('button#submit').click()\n    cy.get('.toast').contains('Changes saved!')\n  })\n\n  cy.visit('/items/1')\n  cy.get('h1').contains('Updated title')\n})\n")),(0,r.kt)("p",null,"The just-released ",(0,r.kt)("inlineCode",{parentName:"p"},"cy.session()")," command can be used to setup and cache cookies,\nlocal storage and session storage between tests to easily re-establish the\nprevious (or common) browser contexts needed in a suite. This command will run\nsetup on its initial execution and will restore the saved browser state on each\nsequential command execution. This command reduces the need for repeated\napplication logins, while users also benefit from the test isolation guardrails\nto write independent, reliable and deterministic tests from the start."),(0,r.kt)("p",null,"If for whatever reason you still need to persist the dom and browser context\nbetween tests, you can disable test isolation by setting ",(0,r.kt)("inlineCode",{parentName:"p"},"testIsolation=false"),"\non the root configuration or at the suite-level. For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"describe('workflow', { testIsolation: false }, () => {\n  ...\n})\n")),(0,r.kt)("p",null,'It is important to note that while disabling test isolation may improve the\noverall performance of end-to-end tests, it can cause state to "leak" between\ntests. This can make later tests dependent on the results of earlier tests, and\npotentially cause misleading test failures. It is important to be extremely\nmindful of how tests are written when using this mode, and ensure that tests\ncontinue to run independently of one another.'),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"For example")," the following tests are not independent nor deterministic:",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"describe('workflow', { testIsolation: false }, () => {\n  it('logs in', () => {\n    cy.visit('https://example.cypress.io/log-in')\n    cy.get('username').type('User1')\n    cy.get('password').type(Cypress.env('User1_password'))\n    cy.get('button#login').click()\n    cy.contains('User1')\n  })\n\n  it('clicks user profile', () => {\n    cy.get('User1').find('#profile_avatar').click()\n    cy.contains('Email Preferences')\n  })\n\n  it('updates profile', () => {\n    cy.get('button#edit')\n    cy.get('email').type('user1@email.com')\n    cy.get('button#save').click()\n  })\n})\n")),(0,r.kt)("p",null,"In the above example, each test is relying on the previous test to be\n",(0,r.kt)("em",{parentName:"p"},"successful")," to correctly execute. If at any point, the first or second test\nfails, the sequential test(s) will automatically fail and provide unreliable\ndebugging errors since the errors are representative of the previous test."),(0,r.kt)("p",null,"The best way to ensure your tests are independent is to add a ",(0,r.kt)("inlineCode",{parentName:"p"},".only()")," to your\ntest and verify it can run successfully without the test before it."),(0,r.kt)("h4",{id:"Simulating-Pre-Test-Isolation-Behavior"},"Simulating Pre-Test Isolation Behavior"),(0,r.kt)("p",null,"Test isolation did not truly exist pre-12. Pre-Cypress 12, the behavior was a\nhybrid of both ",(0,r.kt)("inlineCode",{parentName:"p"},"testIsolation")," enabled and disabled. All local storage and\ncookies on the current domain were cleared, but Cypress did not clear session\nstorage and the page always persisted."),(0,r.kt)("p",null,"In Cypress 12+ when ",(0,r.kt)("inlineCode",{parentName:"p"},"testIsolation")," is enabled, local storage, session storage\nand cookies in ",(0,r.kt)("strong",{parentName:"p"},"all")," domains are cleared and the page is cleared. When\n",(0,r.kt)("inlineCode",{parentName:"p"},"testIsolation")," is disabled, nothing is cleared before the next test so all\nlocal storage, session storage and cookies & the page persists."),(0,r.kt)("p",null,"If you wanted to match pre-Cypress 12 behavior, you need to disable\n",(0,r.kt)("inlineCode",{parentName:"p"},"testIsolation"),", then run ",(0,r.kt)("inlineCode",{parentName:"p"},"cy.clearLocalStorage()")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"cy.clearCookies()")," in a\nbeforeEach hook to clear the local storage and cookies in the current domain."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"describe('match pre-12 behavior', { testIsolation: false }, () => {\n  beforeEach(() => {\n    cy.clearLocalStorage()\n    cy.clearCookies()\n    // other beforeEach logic to restore the expected local storage or cookies needed on the client.\n  })\n})\n")),(0,r.kt)("p",null,"Many of the issues test isolation solved were around cookie management with\ntests trying to save and persist cookies because the page was still available,\nbut the cookies on the domain were unexpectedly cleared which broke interactions\nwith the application. It wasn\u2019t obvious Cypress was doing a partial browser\nclean up. Explicitly setting test isolation to enabled or disabled allows you to\nchoose what is right for your tests."),(0,r.kt)("h3",{id:"Behavior-Changes-in-Alias-Resolution"},"Behavior Changes in Alias Resolution"),(0,r.kt)("p",null,"Cypress always re-queries aliases when they are referenced. This can result in\ncertain tests that used to pass could start to fail. For example,"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.findByTestId('popover')\n  .findByRole('button', { expanded: true })\n  .as('button')\n  .click()\n\ncy.get('@button').should('have.attr', 'aria-expanded', 'false')\n")),(0,r.kt)("p",null,"previously passed, because the initial button was collapsed when first queried,\nand then later expanded. However, in Cypress 12, this test fails because the\nalias is always re-queried from the DOM, effectively resulting in the following\nexecution:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.findByTestId('popover').findByRole('button', { expanded: true }).click()\n\ncy.findByTestId('popover')\n  .findByRole('button', { expanded: true }) // A button which matches here (is expanded)...\n  .should('have.attr', 'aria-expanded', 'false') // ...will never pass this assertion.\n")),(0,r.kt)("p",null,"You can rewrite tests like this to be more specific; in our case, we changed the\nalias to be the first button rather than the unexpanded button."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.findByTestId('popover').findAllByRole('button').first().as('button')\n")),(0,r.kt)("p",null,"If you want to alias a static value, such that it is never re-queried, you will\nneed Cypress ",(0,r.kt)("a",{parentName:"p",href:"/guides/references/changelog#12-3-0"},"12.3.0")," or later, which\nintroduced the ",(0,r.kt)("inlineCode",{parentName:"p"},"type")," option for ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/as"},(0,r.kt)("inlineCode",{parentName:"a"},".as()"))," to opt into the old\nbehavior."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"cy.get('.username').invoke('val').as('username', { type: 'static' })\n")),(0,r.kt)("p",null,"See ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/as"},(0,r.kt)("inlineCode",{parentName:"a"},".as()"))," for more details."),(0,r.kt)("h3",{id:"Command--Cypress-API-Changes"},"Command / Cypress API Changes"),(0,r.kt)("h4",{id:"CypressCookiesdefaults-and-CypressCookiespreserveOnce"},(0,r.kt)("inlineCode",{parentName:"h4"},"Cypress.Cookies.defaults")," and ",(0,r.kt)("inlineCode",{parentName:"h4"},"Cypress.Cookies.preserveOnce")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"Cypress.Cookies.defaults")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"Cypress.Cookies.preserveOnce")," APIs been\nremoved. Use the ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/session"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.session()"))," command to preserve\ncookies (and local and session storage) between tests."),(0,r.kt)("p",null,"If you were using ",(0,r.kt)("inlineCode",{parentName:"p"},"Cypress.Cookies.preserveOnce")," to preserve a specific cookie\nwithin a single spec, this might look like the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-diff"},"describe('Dashboard', () => {\n  beforeEach(() => {\n-    cy.login()\n-    Cypress.Cookies.preserveOnce('session_id', 'remember_token')\n+    cy.session('unique_identifier', cy.login, {\n+       validate () {\n+        cy.getCookies().should('have.length', 2)\n+       },\n+    })\n  })\n")),(0,r.kt)("p",null,"If you were using ",(0,r.kt)("inlineCode",{parentName:"p"},"Cypress.Cookies.defaults")," to preserve a cookie or set of\ncookies across test, this might look like the following:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-diff"},"describe('Dashboard', () => {\n  beforeEach(() => {\n-    cy.login()\n-    Cypress.Cookies.defaults({\n-       preserve: ['session_id', 'remember_token']\n-    })\n+    cy.session('unique_identifier', cy.login, {\n+       validate () {\n+        cy.getCookies().should('have.length', 2)\n+       },\n+       cacheAcrossSpecs: true\n+    })\n  })\n")),(0,r.kt)("h4",{id:"cyserver-cyroute-and-CypressServerdefaults"},(0,r.kt)("inlineCode",{parentName:"h4"},"cy.server()"),", ",(0,r.kt)("inlineCode",{parentName:"h4"},"cy.route()")," and ",(0,r.kt)("inlineCode",{parentName:"h4"},"Cypress.Server.defaults")),(0,r.kt)("p",null,"The",(0,r.kt)("inlineCode",{parentName:"p"}," cy.server()")," and",(0,r.kt)("inlineCode",{parentName:"p"}," cy.route()")," commands and the ",(0,r.kt)("inlineCode",{parentName:"p"},"Cypress.server.defaults"),"\nAPI has been removed. Use the ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/intercept"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.intercept()")),"\ncommand instead."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-diff"},"  it('can encode + decode headers', () => {\n-   Cypress.Server.defaults({\n-     delay: 500,\n-     method: 'GET',\n-   })\n-   cy.server()\n-   cy.route(/api/, () => {\n-      return {\n-        'test': 'We\u2019ll',\n-      }\n-    }).as('getApi')\n+   cy.intercept('GET', /api/, (req) => {\n+      req.on('response', (res) => {\n+        res.setDelay(500)\n+      })\n+      req.body.'test': 'We\u2019ll'\n+    }).as('getApi')\n    cy.visit('/index.html')\n    cy.window().then((win) => {\n      const xhr = new win.XMLHttpRequest\n      xhr.open('GET', '/api/v1/foo/bar?a=42')\n      xhr.send()\n    })\n\n    cy.wait('@getApi')\n-   .its('url').should('include', 'api/v1')\n+   .its('request.url').should('include', 'api/v1')\n  })\n")),(0,r.kt)("h4",{id:"invoke"},(0,r.kt)("inlineCode",{parentName:"h4"},".invoke()")),(0,r.kt)("p",null,"The ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/invoke"},(0,r.kt)("inlineCode",{parentName:"a"},".invoke()"))," command now throws an error if the\nfunction returns a promise. If you wish to call a method that returns a promise\nand wait for it to resolve, use ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/then"},(0,r.kt)("inlineCode",{parentName:"a"},".then()"))," instead of\n",(0,r.kt)("inlineCode",{parentName:"p"},".invoke()"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-diff"},"cy.wrap(myAPI)\n-  .invoke('makeARequest', 'http://example.com')\n+  .then(api => api.makeARequest('http://example.com'))\n   .then(res => { ...handle response... })\n")),(0,r.kt)("p",null,"If ",(0,r.kt)("inlineCode",{parentName:"p"},".invoke()")," is followed by additional commands or assertions, it will call\nthe named function multiple times. This has the benefit that the chained\nassertions can more reliably use the function's return value."),(0,r.kt)("p",null,"If this behavior is undesirable because you expect the function to be invoked\nonly once, break the command chain and move the chained commands and/or\nassertions to their own chain. For example, rewrite"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-diff"},"- cy.get('input').invoke('val', 'text').type('newText')\n+ cy.get('input').invoke('val', 'text')\n+ cy.get('input').type('newText')\n")),(0,r.kt)("h4",{id:"should"},(0,r.kt)("inlineCode",{parentName:"h4"},".should()")),(0,r.kt)("p",null,"The ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/should"},(0,r.kt)("inlineCode",{parentName:"a"},".should()"))," assertion now throws an error if Cypress\ncommands are invoked from inside a ",(0,r.kt)("inlineCode",{parentName:"p"},".should()")," callback. This previously\nresulted in unusual and undefined behavior. If you wish to execute a series of\ncommands on the yielded value, use",(0,r.kt)("inlineCode",{parentName:"p"},".then()")," instead."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-diff"},"cy.get('button')\n-  .should(($button) => {\n\n    })\n+  .then(api => api.makeARequest('http://example.com'))\n   .then(res => { ...handle response... })\n")),(0,r.kt)("h4",{id:"within"},(0,r.kt)("inlineCode",{parentName:"h4"},".within()")),(0,r.kt)("p",null,"The ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/within"},(0,r.kt)("inlineCode",{parentName:"a"},".within()"))," command now throws an error if it is\npassed multiple elements as the subject. This previously resulted in\ninconsistent behavior, where some commands would use all passed in elements,\nsome would use only the first and ignore the rest, and\n",(0,r.kt)("a",{parentName:"p",href:"/api/commands/screenshot"},(0,r.kt)("inlineCode",{parentName:"a"},".screenshot()"))," would throw an error if used inside\na ",(0,r.kt)("inlineCode",{parentName:"p"},".within()")," block with multiple elements."),(0,r.kt)("p",null,"If you were relying on the old behavior, you have several options depending on\nthe desired result."),(0,r.kt)("p",null,"The simplest option is to reduce the subject to a single element."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-diff"},"cy.get('tr')\n+  .first() // Limit the subject to a single element before calling .within()\n  .within(() => {\n    cy.contains('Edit').click()\n  })\n")),(0,r.kt)("p",null,"If you have multiple subjects and wish to run commands over the collection as a\nwhole, you can alias the subject rather than use ",(0,r.kt)("inlineCode",{parentName:"p"},".within()"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-diff"},"cy.get('tr')\n-  .within(() => {\n-    cy.get('td').should('have.class', 'foo')\n-    cy.get('td').should('have.class', 'bar')\n-  })\n+  .as('rows') // Store multiple elements as an alias\n\n+cy.get('@rows').find('td').should('have.class', 'foo')\n+cy.get('@rows').find('td').should('have.class', 'bar')\n")),(0,r.kt)("p",null,"Or if you have a collection and want to run commands over every element, use\n",(0,r.kt)("inlineCode",{parentName:"p"},".each()")," in conjunction with ",(0,r.kt)("inlineCode",{parentName:"p"},".within()"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-diff"},"cy.get('tr')\n-  .within(() => {\n-    cy.contains('Edit').should('have.attr', 'disabled')\n-  })\n+  .each($tr => {\n+    cy.wrap($tr).within(() => {\n+      cy.contains('Edit').should('have.attr', 'disabled')\n+    })\n+  })\n")),(0,r.kt)("h4",{id:"CypressCommandsoverwrite"},(0,r.kt)("inlineCode",{parentName:"h4"},"Cypress.Commands.overwrite()")),(0,r.kt)("p",null,"In Cypress 12.0.0, we introduced a new command type, called queries. A query is\na small and fast command for getting data from the window or DOM. This\ndistinction is important because Cypress can retry chains of queries, keeping\nthe yielded subject up-to-date as a page rerenders."),(0,r.kt)("p",null,"With the introduction of query commands, the following commands have been\nre-categorized and can no longer be overwritten with\n",(0,r.kt)("a",{parentName:"p",href:"/api/cypress-api/custom-commands#Overwrite-Existing-Commands"},(0,r.kt)("inlineCode",{parentName:"a"},"Cypress.Commands.overwrite()")),":"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/as"},(0,r.kt)("inlineCode",{parentName:"a"},".as()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/children"},(0,r.kt)("inlineCode",{parentName:"a"},".children()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/closest"},(0,r.kt)("inlineCode",{parentName:"a"},".closest()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/contains"},(0,r.kt)("inlineCode",{parentName:"a"},".contains()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/debug"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.debug()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/document"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.document()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/eq"},(0,r.kt)("inlineCode",{parentName:"a"},".eq()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/filter"},(0,r.kt)("inlineCode",{parentName:"a"},".filter()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/find"},(0,r.kt)("inlineCode",{parentName:"a"},".find()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/first"},(0,r.kt)("inlineCode",{parentName:"a"},".first()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/focused"},(0,r.kt)("inlineCode",{parentName:"a"},".focused()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/get"},(0,r.kt)("inlineCode",{parentName:"a"},".get()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/hash"},(0,r.kt)("inlineCode",{parentName:"a"},".hash()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/its"},(0,r.kt)("inlineCode",{parentName:"a"},".its()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/last"},(0,r.kt)("inlineCode",{parentName:"a"},".last()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/location"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.location()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/next"},(0,r.kt)("inlineCode",{parentName:"a"},".next()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/nextall"},(0,r.kt)("inlineCode",{parentName:"a"},".nextAll()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/not"},(0,r.kt)("inlineCode",{parentName:"a"},".not()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/parent"},(0,r.kt)("inlineCode",{parentName:"a"},".parent()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/parents"},(0,r.kt)("inlineCode",{parentName:"a"},".parents()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/parentsuntil"},(0,r.kt)("inlineCode",{parentName:"a"},".parentsUntil()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/prev"},(0,r.kt)("inlineCode",{parentName:"a"},".prev()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/prevuntil"},(0,r.kt)("inlineCode",{parentName:"a"},".prevUntil()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/root"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.root()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/shadow"},(0,r.kt)("inlineCode",{parentName:"a"},".shadow()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/siblings"},(0,r.kt)("inlineCode",{parentName:"a"},".siblings()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/title"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.title()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/url"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.url()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/window"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.window()")))),(0,r.kt)("p",null,"If you were previously overwriting one of the above commands, try adding your\nversion as a new command using\n",(0,r.kt)("a",{parentName:"p",href:"/api/cypress-api/custom-commands"},(0,r.kt)("inlineCode",{parentName:"a"},"Cypress.Commands.add()"))," under a different\nname."),(0,r.kt)("h2",{id:"Migrating-to-Cypress-110"},"Migrating to Cypress 11.0"),(0,r.kt)("p",null,"This guide details the changes and how to change your code to migrate to Cypress\nversion 11.0.\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/changelog#11-0-0"},"See the full changelog for version 11.0"),"."),(0,r.kt)("h3",{id:"Component-Testing-Updates"},"Component Testing Updates"),(0,r.kt)("p",null,"As of Cypress 11, Component Testing is now generally available. There are some\nminor breaking changes. Most projects should be able to migrate without any code\nmodifications."),(0,r.kt)("h4",{id:"Changes-to-Mounting-Options"},"Changes to Mounting Options"),(0,r.kt)("p",null,"Each major library we support has a ",(0,r.kt)("inlineCode",{parentName:"p"},"mount")," function with two arguments:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"The component"),(0,r.kt)("li",{parentName:"ol"},"Mounting Options")),(0,r.kt)("p",null,"Mounting options previously had several properties that are now removed:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"cssFile, cssFiles"),(0,r.kt)("li",{parentName:"ul"},"style, styles"),(0,r.kt)("li",{parentName:"ul"},"stylesheet, stylesheets")),(0,r.kt)("p",null,"Read more about the rationale\n",(0,r.kt)("a",{parentName:"p",href:"https://www.cypress.io/blog/2022/11/04/upcoming-changes-to-component-testing/"},"here"),".\nWe recommend writing test-specific styles in a separate ",(0,r.kt)("inlineCode",{parentName:"p"},"css")," file you import in\nyour test, or in your ",(0,r.kt)("inlineCode",{parentName:"p"},"supportFile"),"."),(0,r.kt)("h4",{id:"Before-Cypress-10"},"Before (Cypress 10)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"import { mount } from 'cypress/react'\nimport { Card } from './Card'\n\nit('renders some content', () => {\n  cy.mount(<Card title=\"title\" />, {\n    styles: `\n      .card { width: 100px; }\n    `,\n    stylesheets: [\n      'https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css',\n    ],\n  })\n})\n")),(0,r.kt)("h4",{id:"After-Cypress-11"},"After (Cypress 11)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"/** style.css */\n@import \"https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css\";\n.card { width: 100px }\n\n/** Card.cy.jsx */\nimport { mount } from 'cypress/react'\nimport { Card } from './Card'\nimport './styles.css' // contains CDN link and custom styling.\n\nit('renders some content', () => {\n  cy.mount(<Card title=\"title\" />)\n})\n")),(0,r.kt)("h3",{id:"React---mountHook-Removed"},"React - ",(0,r.kt)("inlineCode",{parentName:"h3"},"mountHook")," Removed"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"mountHook")," from ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress/react")," has been removed. Read more about the rationale\n",(0,r.kt)("a",{parentName:"p",href:"https://www.cypress.io/blog/2022/11/04/upcoming-changes-to-component-testing/"},"here"),"."),(0,r.kt)("p",null,"We recommend simply replacing it with ",(0,r.kt)("inlineCode",{parentName:"p"},"mount")," and a component."),(0,r.kt)("p",null,"Consider the following ",(0,r.kt)("inlineCode",{parentName:"p"},"useCounter")," hook:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import { useState, useCallback } from 'react'\n\nfunction useCounter() {\n  const [count, setCount] = useState(0)\n  const increment = useCallback(() => setCount((x) => x + 1), [])\n\n  return { count, increment }\n}\n")),(0,r.kt)("h4",{id:"Before---Cypress-10-and-mountHook"},"Before - Cypress 10 and ",(0,r.kt)("inlineCode",{parentName:"h4"},"mountHook")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import { mountHook } from 'cypress/react'\nimport { useCounter } from './useCounter'\n\nit('increments the count', () => {\n  mountHook(() => useCounter()).then((result) => {\n    expect(result.current.count).to.equal(0)\n    result.current.increment()\n    expect(result.current.count).to.equal(1)\n    result.current.increment()\n    expect(result.current.count).to.equal(2)\n  })\n})\n")),(0,r.kt)("h4",{id:"After---Cypress-11-and-mount"},"After - Cypress 11 and ",(0,r.kt)("inlineCode",{parentName:"h4"},"mount")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import { useCounter } from './useCounter'\n\nit('increments the count', () => {\n  function Counter() {\n    const { count, increment } = useCounter()\n    return (\n      <>\n        <h1 name=\"count\">Count is {{ count }}</h1>\n        <button onClick={increment}>Increment</button>\n      </>\n    )\n  }\n\n  cy.mount(<Counter />).then(() => {\n    cy.get('[name=\"count\"]')\n      .should('contain', 0)\n      .get('button')\n      .click()\n      .get('[name=\"count\"]')\n      .should('contain', 1)\n  })\n})\n")),(0,r.kt)("h3",{id:"React---unmount-Removed"},"React - ",(0,r.kt)("inlineCode",{parentName:"h3"},"unmount")," Removed"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"unmount")," from ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress/react")," has been removed. Read more about the rationale\n",(0,r.kt)("a",{parentName:"p",href:"https://www.cypress.io/blog/2022/11/04/upcoming-changes-to-component-testing/"},"here"),".\nWe recommend using the API React provides for unmounting components,\n",(0,r.kt)("a",{parentName:"p",href:"https://reactjs.org/docs/react-dom.html#unmountcomponentatnode"},"unmountComponentAtNode"),"."),(0,r.kt)("h4",{id:"Before---Cypress-10-and-unmount"},"Before - Cypress 10 and ",(0,r.kt)("inlineCode",{parentName:"h4"},"unmount")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import { unmount } from 'cypress/react'\n\nit('calls the prop', () => {\n  cy.mount(<Comp onUnmount={cy.stub().as('onUnmount')} />)\n  cy.contains('My component')\n\n  unmount()\n\n  // the component is gone from the DOM\n  cy.contains('My component').should('not.exist')\n  cy.get('@onUnmount').should('have.been.calledOnce')\n})\n")),(0,r.kt)("h4",{id:"After---Cypress-11-and-unmountComponentAtNode"},"After - Cypress 11 and ",(0,r.kt)("inlineCode",{parentName:"h4"},"unmountComponentAtNode")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import { getContainerEl } from 'cypress/react'\nimport ReactDom from 'react-dom'\n\nit('calls the prop', () => {\n  cy.mount(<Comp onUnmount={cy.stub().as('onUnmount')} />)\n  cy.contains('My component')\n\n  cy.then(() => ReactDom.unmountComponentAtNode(getContainerEl()))\n\n  // the component is gone from the DOM\n  cy.contains('My component').should('not.exist')\n  cy.get('@onUnmount').should('have.been.calledOnce')\n})\n")),(0,r.kt)("h3",{id:"Vue---mountCallback-Removed"},"Vue - ",(0,r.kt)("inlineCode",{parentName:"h3"},"mountCallback")," Removed"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"mountCallback")," from ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress/vue")," has been removed. Read more about the\nrationale\n",(0,r.kt)("a",{parentName:"p",href:"https://www.cypress.io/blog/2022/11/04/upcoming-changes-to-component-testing/"},"here"),".\nWe recommend using ",(0,r.kt)("inlineCode",{parentName:"p"},"mount"),"."),(0,r.kt)("h4",{id:"Before---Cypress-10-and-mountCallback"},"Before - Cypress 10 and ",(0,r.kt)("inlineCode",{parentName:"h4"},"mountCallback")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import { mountCallback } from 'cypress/vue'\n\nbeforeEach(mountCallback(MessageList))\n\nit('shows no messages', () => {\n  getItems().should('not.exist')\n})\n")),(0,r.kt)("h4",{id:"After---Cypress-11-and-mount-1"},"After - Cypress 11 and ",(0,r.kt)("inlineCode",{parentName:"h4"},"mount")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"beforeEach(() => cy.mount(MessageList))\n\nit('shows no messages', () => {\n  getItems().should('not.exist')\n})\n")),(0,r.kt)("h3",{id:"Angular---Providers-Mounting-Options-Change"},"Angular - Providers Mounting Options Change"),(0,r.kt)("p",null,"There is one breaking change for Angular users in regards to providers. In\nCypress 10, we took any providers passed as part of the Mounting Options and\noverrode the component providers via the ",(0,r.kt)("inlineCode",{parentName:"p"},"TestBed.overrideComponent")," API."),(0,r.kt)("p",null,"In Cypress 11, providers passed as part of the Mounting Options will be assigned\nat the module level using the ",(0,r.kt)("inlineCode",{parentName:"p"},"TestBed.configureTestingModule")," API."),(0,r.kt)("p",null,"This means that module-level providers (resolved from imports or\n",(0,r.kt)("inlineCode",{parentName:"p"},"@Injectable({ providedIn: 'root' })")," can be overridden, but providers specified\nin ",(0,r.kt)("inlineCode",{parentName:"p"},"@Component({ providers: [...] })")," will not be overridden when using\n",(0,r.kt)("inlineCode",{parentName:"p"},"cy.mount(MyComponent, { providers: [...] })"),"."),(0,r.kt)("p",null,"To override component-level providers, use the ",(0,r.kt)("inlineCode",{parentName:"p"},"TestBed.overrideComponent")," API."),(0,r.kt)("p",null,"See a concrete example\n",(0,r.kt)("a",{parentName:"p",href:"https://www.cypress.io/blog/2022/11/04/upcoming-changes-to-component-testing/#angularproviders-priority"},"here"),"."),(0,r.kt)("h3",{id:"Vite-Dev-Server-cypressvite-dev-server"},"Vite Dev Server (",(0,r.kt)("inlineCode",{parentName:"h3"},"cypress/vite-dev-server"),")"),(0,r.kt)("p",null,"When providing an inline ",(0,r.kt)("inlineCode",{parentName:"p"},"viteConfig")," inside of ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress.config"),", any\n",(0,r.kt)("inlineCode",{parentName:"p"},"vite.config.js")," file is not automatically merged."),(0,r.kt)("h4",{id:"Before---Cypress-10-and-viteConfig"},"Before - Cypress 10 and ",(0,r.kt)("inlineCode",{parentName:"h4"},"viteConfig")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import { defineConfig } from 'cypress'\n\nexport default defineConfig({\n  component: {\n    devServer: {\n      framework: 'react',\n      bundler: 'vite',\n      viteConfig: {\n        // ... custom vite config ...\n        // result merged with `vite.config` file if present\n      },\n    },\n  },\n})\n")),(0,r.kt)("h4",{id:"After---Cypress-11-and-viteConfig"},"After - Cypress 11 and ",(0,r.kt)("inlineCode",{parentName:"h4"},"viteConfig")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import { defineConfig } from 'cypress'\nimport viteConfig from './vite.config'\n\nexport default defineConfig({\n  component: {\n    devServer: {\n      framework: 'react',\n      bundler: 'vite',\n      viteConfig: {\n        ...viteConfig,\n        // ... other overrides ...\n      },\n    },\n  },\n})\n")),(0,r.kt)("p",null,"Vite 3+ users could make use of the\n",(0,r.kt)("a",{parentName:"p",href:"https://vitejs.dev/guide/api-javascript.html#mergeconfig"},(0,r.kt)("inlineCode",{parentName:"a"},"mergeConfig"))," API."),(0,r.kt)("h2",{id:"Migrating-to-Cypress-100"},"Migrating to Cypress 10.0"),(0,r.kt)("p",null,"This guide details the changes and how to change your code to migrate to Cypress\nversion 10.0.\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/changelog#10-0-0"},"See the full changelog for version 10.0"),"."),(0,r.kt)(u,{src:"https://youtube.com/embed/mIqKNhLlPcU",mdxType:"DocsVideo"}),(0,r.kt)("h3",{id:"Cypress-Changes"},"Cypress Changes"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'The "Run all specs" and "Run filtered specs" functionality have been removed.'),(0,r.kt)("li",{parentName:"ul"},'The experimental "Cypress Studio" has been removed and will be\nrethought/revisited in a later release.'),(0,r.kt)("li",{parentName:"ul"},"Unsupported browser versions can no longer be run via ",(0,r.kt)("inlineCode",{parentName:"li"},"cypress run")," or\n",(0,r.kt)("inlineCode",{parentName:"li"},"cypress open"),". Instead, an error will display."),(0,r.kt)("li",{parentName:"ul"},"In 9.x and earlier versions, ",(0,r.kt)("inlineCode",{parentName:"li"},"cypress open")," would bring you directly to the\nproject specs list. In 10.0.0, you must pass ",(0,r.kt)("inlineCode",{parentName:"li"},"--browser")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"--e2e")," or\n",(0,r.kt)("inlineCode",{parentName:"li"},"--component")," as well to launch Cypress directly to the specs list.")),(0,r.kt)("h3",{id:"Configuration-File-Changes"},"Configuration File Changes"),(0,r.kt)("p",null,"Cypress now supports JavaScript and TypeScript configuration files. By default,\nCypress will automatically load a ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress.config.js")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress.config.ts"),"\nfile in the project root if one exists. The\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/configuration"},"Configuration guide")," has been updated to\nreflect these changes, and explains them in greater detail."),(0,r.kt)("p",null,"Because of this, support for ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress.json")," has been removed. Documentation for\n",(0,r.kt)("inlineCode",{parentName:"p"},"cypress.json")," has been moved to the\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/legacy-configuration"},"Legacy Configuration guide"),"."),(0,r.kt)("p",null,"Related notes:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"If no config file exists when you open Cypress, the automatic set up process\nwill begin and either a JavaScript or TypeScript config file will be created\ndepending on what your project uses."),(0,r.kt)("li",{parentName:"ul"},"You may use the ",(0,r.kt)("inlineCode",{parentName:"li"},"--config-file")," command line flag or the ",(0,r.kt)("inlineCode",{parentName:"li"},"configFile"),(0,r.kt)("a",{parentName:"li",href:"/guides/guides/module-api"},"module API")," option to specify a ",(0,r.kt)("inlineCode",{parentName:"li"},".js")," or ",(0,r.kt)("inlineCode",{parentName:"li"},".ts"),"\nfile. JSON config files are no longer supported."),(0,r.kt)("li",{parentName:"ul"},"Cypress now requires a config file, so specifying ",(0,r.kt)("inlineCode",{parentName:"li"},"--config-file false")," on the\ncommand line or a ",(0,r.kt)("inlineCode",{parentName:"li"},"configFile")," value of ",(0,r.kt)("inlineCode",{parentName:"li"},"false")," in the module API is no longer\nvalid."),(0,r.kt)("li",{parentName:"ul"},"You can't have both ",(0,r.kt)("inlineCode",{parentName:"li"},"cypress.config.js")," ",(0,r.kt)("em",{parentName:"li"},"and")," ",(0,r.kt)("inlineCode",{parentName:"li"},"cypress.config.ts")," files. This\nwill result in an error when Cypress loads."),(0,r.kt)("li",{parentName:"ul"},"A\n",(0,r.kt)("a",{parentName:"li",href:"/guides/references/configuration#Intelligent-Code-Completion"},(0,r.kt)("inlineCode",{parentName:"a"},"defineConfig()")),"\nhelper function is now exported by Cypress, which provides automatic code\ncompletion for configuration in many popular code editors. For TypeScript\nusers, the ",(0,r.kt)("inlineCode",{parentName:"li"},"defineConfig")," function will ensure the configuration object passed\ninto it satisfies the type definition of the configuration file."),(0,r.kt)("li",{parentName:"ul"},"Many pages and examples throughout the documentation have been updated to show\nconfiguration using ",(0,r.kt)("inlineCode",{parentName:"li"},"cypress.config.js")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"cypress.config.ts")," vs the older\n",(0,r.kt)("inlineCode",{parentName:"li"},"cypress.json"),". For example:")),(0,r.kt)("cypress-config-example",null,(0,r.kt)(m,{mdxType:"CypressConfigFileTabs"},(0,r.kt)("pre",{parentName:"cypress-config-example"},(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const { defineConfig } = require('cypress')\n\nmodule.exports = defineConfig({\n  e2e: {\n    baseUrl: 'http://localhost:1234',\n  },\n})\n")),(0,r.kt)("pre",{parentName:"cypress-config-example"},(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"import { defineConfig } from 'cypress'\n\nexport default defineConfig({\n  e2e: {\n    baseUrl: 'http://localhost:1234',\n  },\n})\n")))),(0,r.kt)("h3",{id:"Plugins-File-Removed"},"Plugins File Removed"),(0,r.kt)("p",null,'Because Cypress now supports JavaScript and TypeScript configuration files, a\nseparate "plugins file" (which used to default to ',(0,r.kt)("inlineCode",{parentName:"p"},"cypress/plugins/index.js"),") is\nno longer needed."),(0,r.kt)("p",null,"Support for the plugins file has been removed, and it has been replaced with the\nnew ",(0,r.kt)("a",{parentName:"p",href:"/guides/references/configuration#setupNodeEvents"},(0,r.kt)("inlineCode",{parentName:"a"},"setupNodeEvents()"))," and\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/configuration#devServer"},(0,r.kt)("inlineCode",{parentName:"a"},"devServer"))," config options."),(0,r.kt)("p",null,"Related notes:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"cypress/plugins/index.js")," plugins file is no longer automatically loaded\nby Cypress."),(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("a",{parentName:"li",href:"/guides/references/configuration#setupNodeEvents"},(0,r.kt)("inlineCode",{parentName:"a"},"setupNodeEvents()")),"\nconfig option is functionally equivalent to the function exported from the\nplugins file; it takes the same ",(0,r.kt)("inlineCode",{parentName:"li"},"on")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"config")," arguments, and should return\nthe same value. See the ",(0,r.kt)("a",{parentName:"li",href:"#setupNodeEvents"},"Config option changes section")," of\nthis migration guide for more details."),(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("a",{parentName:"li",href:"/guides/references/configuration#devServer"},(0,r.kt)("inlineCode",{parentName:"a"},"devServer"))," config option is\nspecific to component testing, and offers a much more streamlined and\nconsistent way to configure a component testing dev server than using the\nplugins file. See the ",(0,r.kt)("a",{parentName:"li",href:"#devServer"},"Config option changes section")," of this\nmigration guide for more details."),(0,r.kt)("li",{parentName:"ul"},"Many pages and examples throughout the documentation have been updated to show\nconfiguration in ",(0,r.kt)("inlineCode",{parentName:"li"},"setupNodeEvents")," as well as the legacy plugins file. For\nexample:")),(0,r.kt)("cypress-config-plugin-example",null,(0,r.kt)(m,{mdxType:"CypressConfigFileTabs"},(0,r.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const { defineConfig } = require('cypress')\n\nmodule.exports = defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      // bind to the event we care about\n      on('<event>', (arg1, arg2) => {\n        // plugin stuff here\n      })\n    },\n  },\n})\n")),(0,r.kt)("pre",{parentName:"cypress-config-plugin-example"},(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"import { defineConfig } from 'cypress'\n\nexport default defineConfig({\n  // setupNodeEvents can be defined in either\n  // the e2e or component configuration\n  e2e: {\n    setupNodeEvents(on, config) {\n      // bind to the event we care about\n      on('<event>', (arg1, arg2) => {\n        // plugin stuff here\n      })\n    },\n  },\n})\n")))),(0,r.kt)("h3",{id:"Config-Option-Changes"},"Config Option Changes"),(0,r.kt)("h4",{id:"baseUrl"},(0,r.kt)("inlineCode",{parentName:"h4"},"baseUrl")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"baseUrl")," config option is no longer valid at the top level of the\nconfiguration, and may only be defined inside the\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/configuration#e2e"},(0,r.kt)("inlineCode",{parentName:"a"},"e2e"))," configuration object."),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Attempting to set the ",(0,r.kt)("inlineCode",{parentName:"p"},"baseUrl")," config option at the top level of the\nconfiguration will result in an error when Cypress loads.")),(0,r.kt)("h4",{id:"componentFolder"},(0,r.kt)("inlineCode",{parentName:"h4"},"componentFolder")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"componentFolder")," config option is no longer used, as it has been replaced\nby the ",(0,r.kt)("inlineCode",{parentName:"p"},"specPattern"),"\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/configuration#Testing-Type-Specific-Options"},"testing-type specific option"),"."),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Attempting to set the ",(0,r.kt)("inlineCode",{parentName:"p"},"componentFolder")," config option will result in an error\nwhen Cypress loads.")),(0,r.kt)("h4",{id:"devServer"},(0,r.kt)("inlineCode",{parentName:"h4"},"devServer")),(0,r.kt)("p",null,"All functionality related to starting a component testing dev server previously\nin the ",(0,r.kt)("inlineCode",{parentName:"p"},"pluginsFile")," has moved here. These options are not valid at the\ntop-level, and may only be defined in the\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/configuration#component"},(0,r.kt)("inlineCode",{parentName:"a"},"component"))," configuration object."),(0,r.kt)("p",null,"Related notes:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Do not configure your dev server inside ",(0,r.kt)("inlineCode",{parentName:"li"},"setupNodeEvents()"),", use the\n",(0,r.kt)("inlineCode",{parentName:"li"},"devServer")," config option instead.")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"See the dev server documentation for the UI framework you're using for more\nspecific instructions on what the ",(0,r.kt)("inlineCode",{parentName:"p"},"devServer")," should be for that framework. Some\nexamples can be found in our\n",(0,r.kt)("a",{parentName:"p",href:"/guides/component-testing/component-framework-configuration"},"framework documentation"),".")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Variant 1 (webpack & vite dev servers)")),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="cypress/plugins/index.js"',title:'"cypress/plugins/index.js"'},"const { startDevServer } = require('@cypress/webpack-dev-server')\nconst webpackConfig = require('../../webpack.config.js')\n\nmodule.exports = (on, config) => {\n  if (config.testingType === 'component') {\n    on('dev-server:start', async (options) =>\n      startDevServer({ options, webpackConfig })\n    )\n  }\n}\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After"),(0,r.kt)(h,{mdxType:"Tabs"},(0,r.kt)(g,{value:"cypress.config.js",active:!0,mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const { defineConfig } = require('cypress')\nconst webpackConfig = require('./webpack.config.js')\n\nmodule.exports = defineConfig({\n  component: {\n    devServer: {\n      framework: 'react', // or vue\n      bundler: 'webpack',\n      webpackConfig,\n    },\n  },\n})\n"))),(0,r.kt)(g,{value:"cypress.config.js (verbose)",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const { defineConfig } = require('cypress')\nconst webpackConfig = require('./webpack.config.js')\n\nmodule.exports = defineConfig({\n  component: {\n    devServer(cypressConfig) {\n      return devServer({\n        framework: 'react', // or vue\n        cypressConfig,\n        webpackConfig,\n      })\n    },\n  },\n})\n"))),(0,r.kt)(g,{value:"cypress.config.ts",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import { defineConfig } from 'cypress'\nimport webpackConfig from './webpack.config'\n\nexport default defineConfig({\n  component: {\n    devServer: {\n      framework: 'react', // or vue\n      bundler: 'webpack',\n      webpackConfig,\n    },\n  },\n})\n"))),(0,r.kt)(g,{value:"cypress.config.ts (verbose)",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import { defineConfig } from 'cypress'\nimport { devServer } from '@cypress/webpack-dev-server'\nimport webpackConfig from './webpack.config'\n\nexport default defineConfig({\n  component: {\n    devServer(cypressConfig) {\n      return devServer({\n        framework: 'react', // or vue\n        cypressConfig,\n        webpackConfig,\n      })\n    },\n  },\n})\n")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Variant 2 (react plugin dev servers)")),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const devServer = require('@cypress/react/plugins/react-scripts')\n\nmodule.exports = (on, config) => {\n  if (config.testingType === 'component') {\n    injectDevServer(on, config, {})\n  }\n}\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After"),(0,r.kt)(h,{mdxType:"Tabs"},(0,r.kt)(g,{value:"cypress.config.js",active:!0,mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const { defineConfig } = require('cypress')\n\nmodule.exports = defineConfig({\n  component: {\n    devServer: {\n      framework: 'react', // or vue\n      bundler: 'webpack',\n    },\n  },\n})\n"))),(0,r.kt)(g,{value:"more verbose",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const { defineConfig } = require('cypress')\nconst webpackConfig = require('./webpack.config.js')\n\nmodule.exports = defineConfig({\n  component: {\n    devServer(cypressConfig) {\n      return devServer({\n        framework: 'react', // or vue\n        cypressConfig,\n        webpackConfig,\n      })\n    },\n  },\n})\n")))),(0,r.kt)("h4",{id:"experimentalStudio"},(0,r.kt)("inlineCode",{parentName:"h4"},"experimentalStudio")),(0,r.kt)("p",null,'This option is no longer used. The experimental "Cypress Studio" has been\nremoved and will be rethought/revisited in a later release.'),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Attempting to set the ",(0,r.kt)("inlineCode",{parentName:"p"},"experimentalStudio")," config option will result in an error\nwhen Cypress loads.")),(0,r.kt)("h4",{id:"ignoreTestFiles--excludeSpecPattern"},(0,r.kt)("inlineCode",{parentName:"h4"},"ignoreTestFiles")," \u2192 ",(0,r.kt)("inlineCode",{parentName:"h4"},"excludeSpecPattern")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"ignoreTestFiles")," option is no longer used, and has been replaced with the\n",(0,r.kt)("inlineCode",{parentName:"p"},"excludeSpecPattern"),"\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/configuration#Testing-Type-Specific-Options"},"testing-type specific option"),"."),(0,r.kt)("p",null,"Default values"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"e2e.excludeSpecPattern")," default value is ",(0,r.kt)("inlineCode",{parentName:"li"},"*.hot-update.js")," (same as pervious\nignore value)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"component.excludeSpecPattern")," default value is\n",(0,r.kt)("inlineCode",{parentName:"li"},"['/snapshots/*', '/image_snapshots/*']")," updated from ",(0,r.kt)("inlineCode",{parentName:"li"},"*.hot-update.js")),(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"**/node_modules/**")," pattern is automatically added to both\n",(0,r.kt)("inlineCode",{parentName:"li"},"e2e.specExcludePattern")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"component.specExcludePattern"),", and does not need\nto be specified (and can't be overridden).")),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'{\n  "ignoreTestFiles": "path/to/**/*.js"\n}\n')),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'{\n  component: {\n    excludeSpecPattern: "path/to/**/*.js"\n  },\n  e2e: {\n    excludeSpecPattern: "other/path/to/**/*.js"\n  }\n}\n')),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Attempting to set the ",(0,r.kt)("inlineCode",{parentName:"p"},"ignoreTestFiles")," config option will result in an error\nwhen Cypress loads."),(0,r.kt)("p",{parentName:"admonition"},"Also, attempting to set the ",(0,r.kt)("inlineCode",{parentName:"p"},"excludeSpecPattern")," config option at the top level\nof the configuration will result in an error when Cypress loads.")),(0,r.kt)("h4",{id:"integrationFolder"},(0,r.kt)("inlineCode",{parentName:"h4"},"integrationFolder")),(0,r.kt)("p",null,"This option is no longer used, as it has been replaced by the ",(0,r.kt)("inlineCode",{parentName:"p"},"specPattern"),"\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/configuration#Testing-Type-Specific-Options"},"testing-type specific option"),"."),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Attempting to set the ",(0,r.kt)("inlineCode",{parentName:"p"},"integrationFolder")," config option will result in an error\nwhen Cypress loads.")),(0,r.kt)("h4",{id:"pluginsFile"},(0,r.kt)("inlineCode",{parentName:"h4"},"pluginsFile")),(0,r.kt)("p",null,"This option is no longer used, and all plugin file functionality has moved into\nthe ",(0,r.kt)("a",{parentName:"p",href:"/guides/references/configuration#setupNodeEvents"},(0,r.kt)("inlineCode",{parentName:"a"},"setupNodeEvents()"))," and\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/configuration#devServer"},(0,r.kt)("inlineCode",{parentName:"a"},"devServer"))," options. See the\n",(0,r.kt)("a",{parentName:"p",href:"#Plugins-file-removed"},"Plugins file removed")," section of this migration guide\nfor more details."),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Attempting to set the ",(0,r.kt)("inlineCode",{parentName:"p"},"pluginsFile")," config option will result in an error when\nCypress loads.")),(0,r.kt)("h4",{id:"setupNodeEvents"},(0,r.kt)("inlineCode",{parentName:"h4"},"setupNodeEvents()")),(0,r.kt)("p",null,"All functionality related to setting up events or modifying the config,\npreviously done in the plugins file, has moved into the ",(0,r.kt)("inlineCode",{parentName:"p"},"setupNodeEvents()"),"\nconfig options. This option is not valid at the top level of the config, and may\nonly be defined inside the ",(0,r.kt)("inlineCode",{parentName:"p"},"component")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"e2e"),"\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/configuration#Testing-Type-Specific-Options"},"configuration objects"),"."),(0,r.kt)("p",null,"More information can be found in the\n",(0,r.kt)("a",{parentName:"p",href:"/api/plugins/writing-a-plugin#Plugins-API"},"Plugins API documentation")," and the\n",(0,r.kt)("a",{parentName:"p",href:"/api/plugins/configuration-api#Usage"},"Configuration API documentation"),"."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," ",(0,r.kt)("code",null,"cypress/plugins/index.js"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = (on, config) => {\n  if (config.testingType === 'component') {\n    // component testing dev server setup code\n    // component testing node events setup code\n  } else {\n    // e2e testing node events setup code\n  }\n}\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After"),(0,r.kt)("cypress-config-example",null,(0,r.kt)(m,{mdxType:"CypressConfigFileTabs"},(0,r.kt)("pre",{parentName:"cypress-config-example"},(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const { defineConfig } = require('cypress')\n\nmodule.exports = defineConfig({\n  component: {\n    devServer(cypressConfig) {\n      // component testing dev server setup code\n    },\n    setupNodeEvents(on, config) {\n      // component testing node events setup code\n    },\n  },\n  e2e: {\n    setupNodeEvents(on, config) {\n      // e2e testing node events setup code\n    },\n  },\n})\n")),(0,r.kt)("pre",{parentName:"cypress-config-example"},(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"import { defineConfig } from 'cypress'\n\nexport default defineConfig({\n  component: {\n    devServer(cypressConfig) {\n      // component testing dev server setup code\n    },\n    setupNodeEvents(on, config) {\n      // component testing node events setup code\n    },\n  },\n  e2e: {\n    setupNodeEvents(on, config) {\n      // e2e testing node events setup code\n    },\n  },\n})\n")))),(0,r.kt)("p",null,"Alternately, you can continue to use an external plugins file, but you will need\nto load that file explicitly, and also update it to move any component testing\ndev server code into the ",(0,r.kt)("a",{parentName:"p",href:"#devServer"},(0,r.kt)("inlineCode",{parentName:"a"},"devServer"))," config option."),(0,r.kt)("cypress-config-example",null,(0,r.kt)(m,{mdxType:"CypressConfigFileTabs"},(0,r.kt)("pre",{parentName:"cypress-config-example"},(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const { defineConfig } = require('cypress')\nconst setupNodeEvents = require('./cypress/plugins/index.js')\n\nmodule.exports = defineConfig({\n  component: {\n    devServer(cypressConfig) {\n      // component testing dev server setup code\n    },\n    setupNodeEvents,\n  },\n  e2e: {\n    setupNodeEvents,\n  },\n})\n")),(0,r.kt)("pre",{parentName:"cypress-config-example"},(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"import { defineConfig } from 'cypress'\nimport setupNodeEvents from './cypress/plugins/index.js'\n\nexport default defineConfig({\n  component: {\n    devServer(cypressConfig) {\n      // component testing dev server setup code\n    },\n    setupNodeEvents,\n  },\n  e2e: {\n    setupNodeEvents,\n  },\n})\n")))),(0,r.kt)("h4",{id:"slowTestThreshold"},(0,r.kt)("inlineCode",{parentName:"h4"},"slowTestThreshold")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"slowTestThreshold")," configuration option is no longer valid at the top level\nof the configuration, and is now a\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/configuration#Testing-Type-Specific-Options"},"testing-type specific option"),"."),(0,r.kt)("p",null,"Note that the default values are unchanged (",(0,r.kt)("inlineCode",{parentName:"p"},"10000")," for ",(0,r.kt)("inlineCode",{parentName:"p"},"e2e")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"250")," for\n",(0,r.kt)("inlineCode",{parentName:"p"},"component"),")."),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Attempting to set the ",(0,r.kt)("inlineCode",{parentName:"p"},"slowTestThreshold")," config option at the top level of the\nconfiguration will result in an error when Cypress loads.")),(0,r.kt)("h4",{id:"supportFile"},(0,r.kt)("inlineCode",{parentName:"h4"},"supportFile")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"supportFile")," configuration option is no longer valid at the top level of\nthe configuration, and is now a\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/configuration#Testing-Type-Specific-Options"},"testing-type specific option"),".\nMore information can be found in the\n",(0,r.kt)("a",{parentName:"p",href:"/guides/core-concepts/writing-and-organizing-tests#Support-file"},"support file docs"),"."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'{\n  "supportFile": "cypress/support/index.js"\n}\n')),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"{\n  component: {\n    supportFile: 'cypress/support/component.js'\n  },\n  e2e: {\n    supportFile: 'cypress/support/e2e.js'\n  }\n}\n")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Attempting to set the ",(0,r.kt)("inlineCode",{parentName:"p"},"supportFile")," config option at the top level of the\nconfiguration will result in an error when Cypress loads."),(0,r.kt)("p",{parentName:"admonition"},"Also, for a given testing type, multiple matching ",(0,r.kt)("inlineCode",{parentName:"p"},"supportFile")," files will\nresult in an error when Cypress loads.")),(0,r.kt)("h4",{id:"testFiles--specPattern"},(0,r.kt)("inlineCode",{parentName:"h4"},"testFiles")," \u2192 ",(0,r.kt)("inlineCode",{parentName:"h4"},"specPattern")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"testFiles")," option is no longer used, and has been replaced with the\n",(0,r.kt)("inlineCode",{parentName:"p"},"specPattern")," option, which must be defined inside the\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/configuration#component"},(0,r.kt)("inlineCode",{parentName:"a"},"component"))," and\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/configuration#e2e"},(0,r.kt)("inlineCode",{parentName:"a"},"e2e"))," configuration objects."),(0,r.kt)("p",null,"Default values:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"No longer matches with ",(0,r.kt)("inlineCode",{parentName:"li"},".coffee")," or ",(0,r.kt)("inlineCode",{parentName:"li"},".cjsx"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"e2e.specPattern")," default value is ",(0,r.kt)("inlineCode",{parentName:"li"},"cypress/e2e/**/*.cy.{js,jsx,ts,tsx}"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"component.specPattern")," default value is ",(0,r.kt)("inlineCode",{parentName:"li"},"**/*.cy.{js,jsx,ts,tsx}"),".")),(0,r.kt)("p",null,"Important note about matching:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"E2E tests will be found using the ",(0,r.kt)("inlineCode",{parentName:"li"},"e2e.specPattern")," value."),(0,r.kt)("li",{parentName:"ul"},"Component tests will be found using the ",(0,r.kt)("inlineCode",{parentName:"li"},"component.specPattern")," value but any\ntests found matching the ",(0,r.kt)("inlineCode",{parentName:"li"},"e2e.specPattern")," value will be automatically\nexcluded.")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Attempting to set the ",(0,r.kt)("inlineCode",{parentName:"p"},"testFiles")," config option will result in an error when\nCypress loads."),(0,r.kt)("p",{parentName:"admonition"},"Also, attempting to set the ",(0,r.kt)("inlineCode",{parentName:"p"},"specPattern")," config option at the top level of the\nconfiguration will result in an error when Cypress loads.")),(0,r.kt)("h3",{id:"Updated-Test-File-Locations"},"Updated Test File Locations"),(0,r.kt)("p",null,"Previously, you could specify the locations of test files and folders using the\nconfiguration options: ",(0,r.kt)("inlineCode",{parentName:"p"},"componentFolder"),", or ",(0,r.kt)("inlineCode",{parentName:"p"},"integrationFolder"),", and\n",(0,r.kt)("inlineCode",{parentName:"p"},"testFiles"),". These options have been replaced with ",(0,r.kt)("inlineCode",{parentName:"p"},"specPattern"),", which is not\nvalid at the top-level, but within the\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/configuration#component"},(0,r.kt)("inlineCode",{parentName:"a"},"component"))," or\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/configuration#e2e"},(0,r.kt)("inlineCode",{parentName:"a"},"e2e"))," configuration objects. For\nexample:"),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'{\n  "componentFolder": "src",\n  "integrationFolder": "cypress/integration",\n  "testFiles": "**/*.cy.js"\n}\n')),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"{\n  component: {\n    specPattern: 'src/**/*.cy.js'\n  },\n  e2e: {\n    specPattern: 'cypress/integration/**/*.cy.js'\n  }\n}\n")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Attempting to set ",(0,r.kt)("inlineCode",{parentName:"p"},"componentFolder"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"integrationFolder"),", or ",(0,r.kt)("inlineCode",{parentName:"p"},"testFiles")," in the\nconfig will result in an error when Cypress loads.")),(0,r.kt)("admonition",{type:"danger"},(0,r.kt)("p",{parentName:"admonition"},"For Cypress Cloud users, changing your ",(0,r.kt)("inlineCode",{parentName:"p"},"specPattern")," and files names or\nextensions of your spec files will result in a loss of data in Cypress Cloud.\nBecause of this, if we detect your project is using Cypress Cloud during\nautomatic migration, we won't suggest changing your spec files. We also don't\nrecommend doing it manually if you are a Cypress Cloud user.")),(0,r.kt)("h3",{id:"Generated-Files"},"Generated Files"),(0,r.kt)("p",null,"Generated screenshots and videos will still be created inside their respective\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/configuration#Folders-Files"},"folders")," (",(0,r.kt)("inlineCode",{parentName:"p"},"screenshotsFolder"),",\n",(0,r.kt)("inlineCode",{parentName:"p"},"videosFolder"),"). However, the paths of generated files inside those folders will\nbe stripped of any common ancestor paths shared between all spec files found by\nthe ",(0,r.kt)("inlineCode",{parentName:"p"},"specPattern")," option (or via the ",(0,r.kt)("inlineCode",{parentName:"p"},"--spec")," command line option or ",(0,r.kt)("inlineCode",{parentName:"p"},"spec"),"\nmodule API option, if specified)."),(0,r.kt)("p",null,"Here are a few examples, assuming the value of ",(0,r.kt)("inlineCode",{parentName:"p"},"videosFolder")," is\n",(0,r.kt)("inlineCode",{parentName:"p"},"cypress/videos"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"screenshotsFolder")," is ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress/screenshots")," and\n",(0,r.kt)("inlineCode",{parentName:"p"},"cy.screenshot('my-screenshot')")," is called once per spec file:"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example 1")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Spec file found",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cypress/e2e/path/to/file/one.cy.js")))),(0,r.kt)("li",{parentName:"ul"},"Common ancestor paths (calculated at runtime)",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cypress/e2e/path/to/file")))),(0,r.kt)("li",{parentName:"ul"},"Generated screenshot file",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cypress/screenshots/one.cy.js/my-screenshot.png")))),(0,r.kt)("li",{parentName:"ul"},"Generated video file",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cypress/videos/one.cy.js.mp4"))))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Example 2")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Spec files found",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cypress/e2e/path/to/file/one.cy.js")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cypress/e2e/path/to/two.cy.js")))),(0,r.kt)("li",{parentName:"ul"},"Common ancestor paths (calculated at runtime)",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cypress/e2e/path/to")))),(0,r.kt)("li",{parentName:"ul"},"Generated screenshot files",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cypress/screenshots/file/one.cy.js/my-screenshot.png")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cypress/screenshots/two.cy.js/my-screenshot.png")))),(0,r.kt)("li",{parentName:"ul"},"Generated video files",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cypress/videos/file/one.cy.js.mp4")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cypress/videos/two.cy.js.mp4"))))),(0,r.kt)("h3",{id:"Command--Cypress-API-Changes-1"},"Command / Cypress API Changes"),(0,r.kt)("h4",{id:"cymount"},(0,r.kt)("inlineCode",{parentName:"h4"},"cy.mount()")),(0,r.kt)("p",null,"If you set up your app using the automatic configuration wizard, a basic\n",(0,r.kt)("a",{parentName:"p",href:"/api/commands/mount"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.mount()"))," command will be imported for you in your\nsupport file from one our supported frameworks."),(0,r.kt)("h4",{id:"CypressCommandsadd"},(0,r.kt)("inlineCode",{parentName:"h4"},"Cypress.Commands.add()")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/api/cypress-api/custom-commands"},(0,r.kt)("inlineCode",{parentName:"a"},"Cypress.Commands.add()")),' has been updated to\nallow the built-in "placeholder" custom ',(0,r.kt)("inlineCode",{parentName:"p"},"mount")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"hover")," commands to be\noverwritten without needing to use ",(0,r.kt)("inlineCode",{parentName:"p"},"Cypress.Commands.overwrite()"),"."),(0,r.kt)("h3",{id:"Component-Testing-Changes"},"Component Testing Changes"),(0,r.kt)("p",null,"Component Testing has moved from experimental to beta status in 10.0.0."),(0,r.kt)("p",null,"Component Testing can now be ran from the main app, and launching into component\ntesting via the command ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress open-ct")," is now deprecated. To launch directly\ninto component testing, use the ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress open --component")," command instead."),(0,r.kt)("p",null,"All the Component Testing dev servers are now included in the main ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress")," npm\npackage. Configuring them is done via specifying a framework and bundler in the\n",(0,r.kt)("inlineCode",{parentName:"p"},"devServer")," config option, and the packages are no longer directly importable.\nSee\n",(0,r.kt)("a",{parentName:"p",href:"/guides/component-testing/component-framework-configuration"},"Framework Configuration"),"\nfor more info."),(0,r.kt)("p",null,"The mount libraries for React and Vue have also been included in the main\n",(0,r.kt)("inlineCode",{parentName:"p"},"cypress")," package and can be imported from ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress/react")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress/vue"),"\nrespectively."),(0,r.kt)("p",null,"Any previous dev servers or mounting libraries from the ",(0,r.kt)("inlineCode",{parentName:"p"},"@cypress")," namespace\nshould be uninstalled in Cypress 10."),(0,r.kt)("h3",{id:"Code-Coverage-Plugin"},"Code Coverage Plugin"),(0,r.kt)("p",null,"The ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/cypress-io/code-coverage#readme"},"Cypress Code Coverage"),"\nplugin will need to be updated to version >= 3.10 to work with Cypress 10. Using\na previous version will result in an error when tests are ran with code coverage\nenabled."),(0,r.kt)("h2",{id:"Migrating-from-cypress-file-upload-to-selectFile"},"Migrating from ",(0,r.kt)("inlineCode",{parentName:"h2"},"cypress-file-upload")," to ",(0,r.kt)("a",{parentName:"h2",href:"/api/commands/selectfile"},(0,r.kt)("inlineCode",{parentName:"a"},".selectFile()"))),(0,r.kt)("p",null,"Selecting files with input elements or dropping them over the page is available\nin Cypress 9.3. Read the ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/selectfile"},(0,r.kt)("inlineCode",{parentName:"a"},".selectFile()")," API docs"),"\nfor more information on how this works and how to use it. This guide details how\nto change your test code to migrate from the\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/abramenal/cypress-file-upload"},(0,r.kt)("inlineCode",{parentName:"a"},"cypress-file-upload"))," plugin\nto ",(0,r.kt)("inlineCode",{parentName:"p"},".selectFile()"),"."),(0,r.kt)("h3",{id:"Quick-guide"},"Quick guide"),(0,r.kt)("p",null,"The argument signature is different for Cypress' builtin ",(0,r.kt)("inlineCode",{parentName:"p"},".selectFile()")," command\nthan the ",(0,r.kt)("inlineCode",{parentName:"p"},".attachFile")," command the ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress-file-upload")," plugin provided. You\ncan follow the steps below for each argument in order to migrate:"),(0,r.kt)("p",null,"When the first argument is a file path:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Prefix the path with ",(0,r.kt)("inlineCode",{parentName:"li"},"cypress/fixtures/"),".")),(0,r.kt)("p",null,"When the first argument is an object:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"filePath"),": Rename the property to ",(0,r.kt)("inlineCode",{parentName:"li"},"contents"),". Prefix the value with\n",(0,r.kt)("inlineCode",{parentName:"li"},"cypress/fixtures/"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"fileContent"),": Rename the property to ",(0,r.kt)("inlineCode",{parentName:"li"},"contents"),". Use\n",(0,r.kt)("a",{parentName:"li",href:"/api/utilities/buffer"},(0,r.kt)("inlineCode",{parentName:"a"},"Cypress.Buffer.from()"))," or other Buffer methods,\nrather than ",(0,r.kt)("inlineCode",{parentName:"li"},"Cypress.Blob"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"encoding"),": Remove this property. It is no longer needed due to improved\nbinary file handling in Cypress 9.0."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"mimeType"),": No change necessary. In most cases you do not need to give a\nmimeType explicitly. Cypress will attempt to infer the MIME type\n",(0,r.kt)("a",{parentName:"li",href:"https://github.com/jshttp/mime-types#mimelookuppath"},"based on the extension"),"\nof the fileName if none is provided.")),(0,r.kt)("p",null,"In the second argument:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"subjectType"),": Rename this property to ",(0,r.kt)("inlineCode",{parentName:"li"},"action"),". Change the value from\n",(0,r.kt)("inlineCode",{parentName:"li"},"drag-n-drop")," to ",(0,r.kt)("inlineCode",{parentName:"li"},"drag-drop")," or from ",(0,r.kt)("inlineCode",{parentName:"li"},"input")," to ",(0,r.kt)("inlineCode",{parentName:"li"},"select"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"allowEmpty"),": Remove this property. ",(0,r.kt)("inlineCode",{parentName:"li"},".selectFile()")," does not check the length\nof a file read from disk, only its existence."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"force"),": Works the same with ",(0,r.kt)("inlineCode",{parentName:"li"},".selectFile()")," as it did in\n",(0,r.kt)("inlineCode",{parentName:"li"},"cypress-file-upload"),". No change necessary.")),(0,r.kt)("h3",{id:"Examples"},"Examples"),(0,r.kt)("p",null,"Below are several examples of migrating various commands from\n",(0,r.kt)("inlineCode",{parentName:"p"},"cypress-file-upload")," to the builtin ",(0,r.kt)("inlineCode",{parentName:"p"},".selectFile()")," command."),(0,r.kt)("h4",{id:"Read-and-attach-a-fixture"},"Read and attach a fixture"),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," Attaching a fixture from disk with ",(0,r.kt)("code",null,"cypress-file-upload"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.get('[data-cy=\"file-input\"]').attachFile('myfixture.json')\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Selecting a fixture from disk with ",(0,r.kt)("code",null,".selectFile()"),". Cypress follows paths from your project root (same as ",(0,r.kt)("a",{href:"/api/commands/readfile"},(0,r.kt)("code",null,"cy.readFile()")),").",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.get('[data-cy=\"file-input\"]').selectFile('cypress/fixtures/myfixture.json')\n\n// Or\n\ncy.fixture('myfixture.json', { encoding: null }).as('myfixture')\ncy.get('[data-cy=\"file-input\"]').selectFile('@myfixture')\n")),(0,r.kt)("h4",{id:"Using-drag-n-drop"},"Using drag-n-drop"),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," Dragging and dropping a file with ",(0,r.kt)("code",null,"cypress-file-upload"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.get('[data-cy=\"dropzone\"]').attachFile('myfixture.json', {\n  subjectType: 'drag-n-drop',\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Selecting a fixture from disk with ",(0,r.kt)("code",null,".selectFile()"),". Cypress follows paths from the root of your test folder (same as ",(0,r.kt)("a",{href:"/api/commands/readfile"},(0,r.kt)("code",null,"cy.readFile()")),").",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.get('[data-cy=\"dropzone\"]').selectFile('fixtures/myfixture.json', {\n  action: 'drag-drop',\n})\n")),(0,r.kt)("h4",{id:"Overriding-the-file-name"},"Overriding the file name"),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," Dragging and dropping a file with ",(0,r.kt)("code",null,"cypress-file-upload"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.get('[data-cy=\"dropzone\"]').attachFile({\n  filePath: 'myfixture.json',\n  fileName: 'customFileName.json',\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Selecting a fixture from disk with ",(0,r.kt)("code",null,".selectFile()"),". Cypress follows paths from the root of your test folder (same as ",(0,r.kt)("a",{href:"/api/commands/readfile"},(0,r.kt)("code",null,"cy.readFile()")),").",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.get('[data-cy=\"dropzone\"]').selectFile({\n  contents: 'fixtures/myfixture.json',\n  fileName: 'customFileName.json',\n})\n")),(0,r.kt)("h4",{id:"Working-with-file-contents"},"Working with file contents"),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," Working with file contents before using using ",(0,r.kt)("code",null,"cypress-file-upload"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const special = 'file.spss'\n\ncy.fixture(special, 'binary')\n  .then(Cypress.Blob.binaryStringToBlob)\n  .then((fileContent) => {\n    // ...process file contents\n    cy.get('[data-cy=\"file-input\"]').attachFile({\n      fileContent,\n      filePath: special,\n      encoding: 'utf-8',\n      lastModified: new Date().getTime(),\n    })\n  })\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Working with file contents before using with",(0,r.kt)("code",null,".selectFile()"),". The ",(0,r.kt)("code",null,"null")," encoding introduced in Cypress 9.0 makes working with binary data simpler, and is the preferred encoding for use with ",(0,r.kt)("code",null,".selectFile()"),".",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const special = 'file.spss'\n\ncy.fixture(special, { encoding: null }).then((contents) => {\n  // ...process file contents\n  cy.get('[data-cy=\"file-input\"]').selectFile({\n    contents,\n    fileName: special,\n    lastModified: new Date().getTime(),\n  })\n})\n\n// Or\n\ncy.fixture(special, { encoding: null })\n  .then((contents) => {\n    // ...process file contents\n  })\n  .as('special')\n\ncy.get('[data-cy=\"file-input\"]').selectFile('@special')\n")),(0,r.kt)("h4",{id:"Specifying-a-custom-mimeType"},"Specifying a custom mimeType"),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," Specifying the MIME type with ",(0,r.kt)("code",null,"cypress-file-upload"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.get('[data-cy=\"dropzone\"]').attachFile({\n  filePath: 'myfixture.json',\n  fileName: 'customFileName.json',\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Specifying a MIME type with ",(0,r.kt)("code",null,".selectFile()"),".",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.get('[data-cy=\"dropzone\"]').selectFile({\n  contents: 'fixtures/myfixture.json',\n  mimeType: 'text/plain',\n})\n")),(0,r.kt)("h2",{id:"Migrating-to-Cypress-80"},"Migrating to Cypress 8.0"),(0,r.kt)("p",null,"This guide details the changes and how to change your code to migrate to Cypress\n8.0. ",(0,r.kt)("a",{parentName:"p",href:"/guides/references/changelog#8-0-0"},"See the full changelog for 8.0"),"."),(0,r.kt)("h3",{id:"cypress-run-runs-all-browsers---headless"},(0,r.kt)("inlineCode",{parentName:"h3"},"cypress run")," runs all browsers ",(0,r.kt)("inlineCode",{parentName:"h3"},"--headless")),(0,r.kt)("p",null,"When running ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress run")," previous to 8.0, some browsers would launch headed\nwhile others were launched headless by default. In 8.0, we've normalized all\nbrowsers to launch as headless by default."),(0,r.kt)("p",null,"This could cause a couple of changes to your existing runs:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"You may see the screenshot or video resolution of runs during ",(0,r.kt)("inlineCode",{parentName:"li"},"cypress run"),"\nchange to the default of 1280x720. This is because headless browsers use the\nset screen size as opposed to the browser's size when opening headed."),(0,r.kt)("li",{parentName:"ul"},"Chrome extensions will not load during a ",(0,r.kt)("inlineCode",{parentName:"li"},"--headless")," run. If your run depends\non a Chrome extension being loaded during ",(0,r.kt)("inlineCode",{parentName:"li"},"cypress run"),", you should explicitly\npass the ",(0,r.kt)("inlineCode",{parentName:"li"},"--headed")," flag.")),(0,r.kt)("p",null,"You can now remove the use of the ",(0,r.kt)("inlineCode",{parentName:"p"},"--headless")," flag during ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress run")," as this\nis the default for all browsers."),(0,r.kt)("p",null,"You should also update any use of the ",(0,r.kt)("inlineCode",{parentName:"p"},"isHeaded")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"isHeadless")," property on\n",(0,r.kt)("a",{parentName:"p",href:"/api/cypress-api/browser"},(0,r.kt)("inlineCode",{parentName:"a"},"Cypress.browser"))," or the\n",(0,r.kt)("a",{parentName:"p",href:"/api/plugins/browser-launch-api"},"browser launch API")," accordingly."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," run headless browser",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-script"},"cypress run --browser=chrome --headless\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-script"},"cypress run --browser=firefox --headless\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," All browsers headless by default, so you can remove the ",(0,r.kt)("code",null,"--headless")," flag during ",(0,r.kt)("code",null,"cypress run"),".",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-script"},"cypress run --browser=chrome\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-script"},"cypress run --browser=firefox\n")),(0,r.kt)("h3",{id:"Default-screen-size-during---headless"},"Default screen size during ",(0,r.kt)("inlineCode",{parentName:"h3"},"--headless")),(0,r.kt)("p",null,"The default screen size when running a headless browser has been reverted back\nto 1280x720 pixels. If you have any code in the\n",(0,r.kt)("a",{parentName:"p",href:"/api/plugins/browser-launch-api"},"browser launch API")," to set the screen size to\n1280x720, this can be removed."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," set screen size to 1280x720",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// cypress/plugins/index.js\nmodule.exports = (on, config) => {\n  on('before:browser:launch', (browser, launchOptions) => {\n    if (browser.name === 'chrome' && browser.isHeadless) {\n      launchOptions.args.push('--window-size=1280,720')\n    }\n\n    if (browser.name === 'electron' && browser.isHeadless) {\n      launchOptions.preferences.width = 1280\n      launchOptions.preferences.height = 720\n    }\n\n    if (browser.name === 'firefox' && browser.isHeadless) {\n      launchOptions.args.push('--width=1280')\n      launchOptions.args.push('--height=720')\n    }\n\n    return launchOptions\n  })\n}\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," no longer need overrides",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// cypress/plugins/index.js\nmodule.exports = (on, config) => {\n  // the default screen size is 1280x720 in all headless browsers\n}\n")),(0,r.kt)("h2",{id:"Migrating-to-Cypress-70"},"Migrating to Cypress 7.0"),(0,r.kt)("p",null,"This guide details the changes and how to change your code to migrate to Cypress\n7.0. ",(0,r.kt)("a",{parentName:"p",href:"/guides/references/changelog#7-0-0"},"See the full changelog for 7.0"),"."),(0,r.kt)("h3",{id:"cyintercept-changes"},(0,r.kt)("a",{parentName:"h3",href:"/api/commands/intercept"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.intercept()"))," changes"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/guides/references/changelog#7-0-0"},"Cypress 7.0")," comes with some breaking\nchanges to ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/intercept"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.intercept()")),":"),(0,r.kt)("h4",{id:"Handler-ordering-is-reversed"},"Handler ordering is reversed"),(0,r.kt)("p",null,"Previous to Cypress 7.0, ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/intercept"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.intercept()"))," handlers were run in the\norder that they are defined, stopping after the first handler to call\n",(0,r.kt)("inlineCode",{parentName:"p"},"req.reply()"),", or once all handlers are complete."),(0,r.kt)("p",null,"With Cypress 7.0, ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/intercept"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.intercept()"))," handlers are now run in reverse\norder of definition, stopping after the first handler to call ",(0,r.kt)("inlineCode",{parentName:"p"},"req.reply()"),", or\nonce all handlers are complete."),(0,r.kt)("p",null,"This change was done so that users can override previously declared\n",(0,r.kt)("a",{parentName:"p",href:"/api/commands/intercept"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.intercept()"))," handlers by calling ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/intercept"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.intercept()")),"\nagain. See ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/cypress-io/cypress/issues/9302"},"#9302")," for more\ndetails."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.intercept(url, (req) => {\n  /* This will be called first! */\n})\ncy.intercept(url, (req) => {\n  /* This will be called second! */\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.intercept(url, (req) => {\n  /* This will be called second! */\n})\ncy.intercept(url, (req) => {\n  /* This will be called first! */\n})\n")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/api/commands/intercept#Interception-lifecycle"},"Read more about the ",(0,r.kt)("inlineCode",{parentName:"a"},"cy.intercept()")," interception lifecycle.")),(0,r.kt)("h4",{id:"URL-matching-is-stricter"},"URL matching is stricter"),(0,r.kt)("p",null,"Before Cypress 7.0, ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/intercept"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.intercept()"))," would match URLs against\nstrings by using ",(0,r.kt)("inlineCode",{parentName:"p"},"minimatch"),", substring match, or by equality."),(0,r.kt)("p",null,"With Cypress 7.0, this behavior is being tightened - URLs are matched against\nstrings only by ",(0,r.kt)("inlineCode",{parentName:"p"},"minimatch")," or by equality. The substring match has been\nremoved."),(0,r.kt)("p",null,"This more closely matches the URL matching behavior shown by ",(0,r.kt)("inlineCode",{parentName:"p"},"cy.route()"),".\nHowever, some intercepts will not match, even though they did before."),(0,r.kt)("p",null,"For example, requests with querystrings may no longer match:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// will this intercept match a request for `/items?page=1`?\ncy.intercept('/items')\n// \u2705 before 7.0.0, this will match, because it is a substring\n// \u274c after 7.0.0, this will not match, because of the querystring\n// solution: update the intercept to match the querystring with a wildcard:\ncy.intercept('/items?*')\n")),(0,r.kt)("p",null,"Also, requests for paths in nested directories may be affected:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// will this intercept match a request for `/some/items`?\ncy.intercept('/items')\n// \u2705 before 7.0.0, this will match, because it is a substring\n// \u274c after 7.0.0, this will not match, because of the leading directory\n// solution: update the intercept to include the directory:\ncy.intercept('/some/items')\n")),(0,r.kt)("p",null,"Additionally, the ",(0,r.kt)("inlineCode",{parentName:"p"},"matchUrlAgainstPath")," ",(0,r.kt)("inlineCode",{parentName:"p"},"RouteMatcher")," option that was added in\nCypress 6.2.0 has been removed in Cypress 7.0. It can be safely removed from\ntests."),(0,r.kt)("h4",{id:"Deprecated-cyroute2-command-removed"},"Deprecated ",(0,r.kt)("inlineCode",{parentName:"h4"},"cy.route2()")," command removed"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"cy.route2()")," was the original name for ",(0,r.kt)("inlineCode",{parentName:"p"},"cy.intercept()")," during the experimental\nphase of the feature. It was deprecated in Cypress 6.0. In Cypress 7.0, it has\nbeen removed entirely. Please update existing usages of ",(0,r.kt)("inlineCode",{parentName:"p"},"cy.route2()")," to call\n",(0,r.kt)("inlineCode",{parentName:"p"},"cy.intercept()")," instead."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.route2('/widgets/*', { fixture: 'widget.json' }).as('widget')\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.intercept('/widgets/*', { fixture: 'widget.json' }).as('widget')\n")),(0,r.kt)("h4",{id:"resdelay-and-resthrottle-have-been-renamed"},(0,r.kt)("inlineCode",{parentName:"h4"},"res.delay()")," and ",(0,r.kt)("inlineCode",{parentName:"h4"},"res.throttle()")," have been renamed"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"res.delay()")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"res.throttle()")," functions that exist on responses yielded\nto response handlers have been renamed."),(0,r.kt)("p",null,"The new names are ",(0,r.kt)("inlineCode",{parentName:"p"},"res.setDelay()")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"res.setThrottle()"),", respectively."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.intercept('/slow', (req) => {\n  req.continue((res) => {\n    // apply a delay of 1 second and a throttle of 56kbps\n    res.delay(1000).throttle(56)\n  })\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.intercept('/slow', (req) => {\n  req.continue((res) => {\n    // apply a delay of 1 second and a throttle of 56kbps\n    res.setDelay(1000).setThrottle(56)\n  })\n})\n")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/api/commands/intercept#intercepted-response"},"Read more about available functions on ",(0,r.kt)("inlineCode",{parentName:"a"},"res"),".")),(0,r.kt)("h4",{id:"Falsy-values-are-no-longer-dropped-in-StaticResponse-bodies"},"Falsy values are no longer dropped in ",(0,r.kt)("inlineCode",{parentName:"h4"},"StaticResponse")," bodies"),(0,r.kt)("p",null,"Previously, falsy values supplied as the ",(0,r.kt)("inlineCode",{parentName:"p"},"body")," of a ",(0,r.kt)("inlineCode",{parentName:"p"},"StaticResponse")," would get\ndropped (the same as if no body was supplied). Now, the bodies are properly\nencoded in the response."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.intercept('/does-it-exist', { body: false })\n// Requests to `/does-it-exist` receive an empty response body\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.intercept('/does-it-exist', { body: false })\n// Requests to `/does-it-exist` receive a response body of `false`\n")),(0,r.kt)("h4",{id:"Errors-thrown-by-request-and-response-handlers-are-no-longer-wrapped"},"Errors thrown by request and response handlers are no longer wrapped"),(0,r.kt)("p",null,"Previously, errors thrown inside of ",(0,r.kt)("inlineCode",{parentName:"p"},"req")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"res")," handlers would be wrapped by\na ",(0,r.kt)("inlineCode",{parentName:"p"},"CypressError"),". In 7.0.0, errors thrown inside of these handlers are not\nwrapped before failing the test."),(0,r.kt)("p",null,"This should only affect users who are explicitly asserting on global errors. See\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/cypress-io/cypress/issues/15189"},"#15189")," for more details."),(0,r.kt)("h3",{id:"Component-Testing"},"Component Testing"),(0,r.kt)("p",null,"In 7.0, component testing is no longer experimental. Cypress now ships with a\ndedicated component test runner with a new UI and dedicated commands to launch\nit."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Changes are required for all existing projects"),". The required changes are\nlimited to configuration and there are no breaking changes to the ",(0,r.kt)("inlineCode",{parentName:"p"},"mount")," API.\nThe migration guide contains the following steps:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"/guides/references/migration-guide#1-Remove-experimentalComponentTesting-config"},"Update your Cypress configuration to remove ",(0,r.kt)("inlineCode",{parentName:"a"},"experimentalComponentTesting"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"/guides/references/migration-guide##2-Install-component-testing-dependencies"},"Install updated dependencies")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"/guides/references/migration-guide#3-Update-plugins-file-to-use-dev-server-start"},"Update the plugins file")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"/guides/references/migration-guide#4-Use-CLI-commands-to-launch"},"Use CLI commands to launch")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"/guides/references/migration-guide#5-Update-the-support-file-optionally"},"Update the support file (optionally)"))),(0,r.kt)("h4",{id:"1-Remove-experimentalComponentTesting-config"},"1. Remove ",(0,r.kt)("inlineCode",{parentName:"h4"},"experimentalComponentTesting")," config"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"experimentalComponentTesting")," configuration is no longer needed to run\ncomponent tests. Remove this flag in order to run Cypress tests without\nerroring."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," experimentalComponentTesting flag is required for component testing",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "experimentalComponentTesting": true,\n  "componentFolder": "src",\n  "testFiles": "**/*spec.{js,jsx,ts,tsx}"\n}\n')),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," experimentalComponentTesting flag must be removed",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "componentFolder": "src",\n  "testFiles": "**/*spec.{js,jsx,ts,tsx}"\n}\n')),(0,r.kt)("h4",{id:"2-Install-component-testing-dependencies"},"2. Install component testing dependencies"),(0,r.kt)("p",null,"The Component Test Runner requires the following dependencies:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Framework-specific bindings such as\n",(0,r.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/@cypress/react"},(0,r.kt)("inlineCode",{parentName:"a"},"@cypress/react")),"."),(0,r.kt)("li",{parentName:"ul"},"Development server adapter such as\n",(0,r.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/@cypress/webpack-dev-server"},(0,r.kt)("inlineCode",{parentName:"a"},"@cypress/webpack-dev-server")),"."),(0,r.kt)("li",{parentName:"ul"},"Peer dependencies such as\n",(0,r.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/webpack-dev-server"},(0,r.kt)("inlineCode",{parentName:"a"},"webpack-dev-server")),",\n",(0,r.kt)("a",{parentName:"li",href:"https://www.npmjs.org/package/vue"},(0,r.kt)("inlineCode",{parentName:"a"},"vue")),", or ",(0,r.kt)("a",{parentName:"li",href:"https://www.npmjs.org/package/react"},(0,r.kt)("inlineCode",{parentName:"a"},"react")),".")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Install React dependencies")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Upgrade to ",(0,r.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/@cypress/react"},(0,r.kt)("inlineCode",{parentName:"a"},"@cypress/react")),"\n5.X."),(0,r.kt)("li",{parentName:"ol"},"Install\n",(0,r.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/@cypress/webpack-dev-server"},(0,r.kt)("inlineCode",{parentName:"a"},"@cypress/webpack-dev-server")),"."),(0,r.kt)("li",{parentName:"ol"},"(Optional) Install\n",(0,r.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/cypress-react-selector"},(0,r.kt)("inlineCode",{parentName:"a"},"cypress-react-selector")),"\nif any tests use ",(0,r.kt)("inlineCode",{parentName:"li"},"cy.react()"),"."),(0,r.kt)("li",{parentName:"ol"},"(Optional) Install code coverage, see\n",(0,r.kt)("a",{parentName:"li",href:"/guides/tooling/code-coverage"},"installation steps"),").")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"npm i cypress @cypress/react @cypress/webpack-dev-server -D\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Install Vue 3 dependencies")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Upgrade to ",(0,r.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/@cypress/vue"},(0,r.kt)("inlineCode",{parentName:"a"},"@cypress/vue@next")),"\n(3.X and above)."),(0,r.kt)("li",{parentName:"ol"},"Install\n",(0,r.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/@cypress/webpack-dev-server"},(0,r.kt)("inlineCode",{parentName:"a"},"@cypress/webpack-dev-server")),".")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"npm i cypress @cypress/vue@next @cypress/webpack-dev-server -D\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Install Vue 2 dependencies")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Upgrade to ",(0,r.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/@cypress/vue"},(0,r.kt)("inlineCode",{parentName:"a"},"@cypress/vue@2")),"\n(2.X only)."),(0,r.kt)("li",{parentName:"ol"},"Install\n",(0,r.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/@cypress/webpack-dev-server"},(0,r.kt)("inlineCode",{parentName:"a"},"@cypress/webpack-dev-server")),".")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"npm i cypress @cypress/vue @cypress/webpack-dev-server -D\n")),(0,r.kt)("h4",{id:"3-Update-plugins-file-to-use-dev-serverstart"},"3. Update plugins file to use ",(0,r.kt)("inlineCode",{parentName:"h4"},"dev-server:start")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Re-using a project's local development server instead of file preprocessors")),(0,r.kt)("p",null,"In 7.0 Cypress component tests require that code is bundled with your local\ndevelopment server, via a new ",(0,r.kt)("inlineCode",{parentName:"p"},"dev-server:start")," event. This event replaces the\nprevious ",(0,r.kt)("inlineCode",{parentName:"p"},"file:preprocessor")," event."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," Plugins file registers the file\\:preprocessor event",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const webpackPreprocessor = require('@cypress/webpack-preprocessor')\nconst webpackConfig = require('../webpack.config.js')\n\nmodule.exports = (on, config) => {\n  on('file:preprocessor', webpackPreprocessor(options))\n}\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Plugins file registers the dev-server\\:start event",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// The @cypress/webpack-dev-server package replaces @cypress/webpack-preprocessor\nconst { startDevServer } = require('@cypress/webpack-dev-server')\nconst webpackConfig = require('../webpack.config.js')\n\nmodule.exports = (on, config) => {\n  // You must use the dev-server:start event instead of the file:preprocessor event\n\n  on('dev-server:start', (options) => {\n    return startDevServer({ options, webpackConfig })\n  })\n}\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Configure ",(0,r.kt)("inlineCode",{parentName:"strong"},"plugins.js")," for React projects")),(0,r.kt)("p",null,"Projects using React may not need to update their plugins file. If your project\nis using a webpack scaffold or boilerplate, it is recommended to use a preset\nplugin imported from\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/cypress-io/cypress/tree/develop/npm/react/plugins"},(0,r.kt)("inlineCode",{parentName:"a"},"@cypress/react/plugins")),"."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Preset Plugins for React")),(0,r.kt)("p",null,"If you are using a preset plugin within\n",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@cypress/react"},(0,r.kt)("inlineCode",{parentName:"a"},"@cypress/react")),", you should not\nneed to update your plugins file. To check if you are using a preset, check to\nsee if your plugins file contains an import to a file inside of\n",(0,r.kt)("inlineCode",{parentName:"p"},"@cypress/react/plugins"),"."),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," An example plugins file to configure component testing in a React Scripts project",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// The @cypress/react project exposes preset plugin configurations\n// These presets automatically register the events to bundle the project properly\nconst injectReactScriptsDevServer = require('@cypress/react/plugins/react-scripts')\n\nmodule.exports = (on, config) => {\n  // Internally, this method registers `dev-server:start` with the proper webpack configuration\n  // Previously, it registered the `file:preprocessor` event.\n  injectReactScriptsDevServer(on, config)\n\n  return config\n}\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Configure ",(0,r.kt)("inlineCode",{parentName:"strong"},"plugins.js")," for Vue")),(0,r.kt)("p",null,"Projects using Vue will likely be using either\n",(0,r.kt)("a",{parentName:"p",href:"https://cli.vuejs.org/"},(0,r.kt)("inlineCode",{parentName:"a"},"@vue/cli"))," or manually defining webpack configuration.\nThese steps are identical to the manual setup steps, with the exception of how\nyou resolve the webpack configuration. To access the resolved webpack\nconfiguration that contains any ",(0,r.kt)("inlineCode",{parentName:"p"},"vue.config.js")," setup or the default\n",(0,r.kt)("a",{parentName:"p",href:"https://cli.vuejs.org/"},(0,r.kt)("inlineCode",{parentName:"a"},"@vue/cli"))," webpack setup, you must import the\nconfiguration and pass it into\n",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@cypress/webpack-dev-server"},(0,r.kt)("inlineCode",{parentName:"a"},"@cypress/webpack-dev-server")),"."),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," An example plugins file to configure component testing in a Vue CLI project",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const { startDevServer } = require('@cypress/webpack-dev-server')\n\n// The resolved configuration, which contains any `vue.config.js` setup\nconst webpackConfig = require('@vue/cli-service/webpack.config.js')\n\nmodule.exports = (on, config) => {\n  on('dev-server:start', (options) => {\n    return startDevServer({ options, webpackConfig })\n  })\n}\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Configuring a project with vanilla webpack")),(0,r.kt)("p",null,"For projects with manually defined or ejected webpack configurations, the\nwebpack configuration must be passed in."),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," An example plugins file to configure component testing in a project with vanilla webpack",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const { startDevServer } = require('@cypress/webpack-dev-server')\nconst webpackConfig = require('../webpack.config.js')\n\nmodule.exports = (on, config) => {\n  on('dev-server:start', (options) => {\n    return startDevServer({ options, webpackConfig })\n  })\n}\n")),(0,r.kt)("h4",{id:"4-Use-CLI-commands-to-launch"},"4. Use CLI commands to launch"),(0,r.kt)("p",null,"To run your component tests you ",(0,r.kt)("em",{parentName:"p"},"must")," use the dedicated component testing\nsubcommands."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cypress open-ct")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cypress run-ct"))),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Component tests will no longer be picked up when launching Cypress from\n",(0,r.kt)("inlineCode",{parentName:"p"},"cypress open")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress run"),". Please use ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress open-ct")," or\n",(0,r.kt)("inlineCode",{parentName:"p"},"cypress run-ct"),".")),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," Commands launches both end-to-end and component tests.",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"cypress run\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Command launches Cypress Component Test Runner and executes component tests. End-to-end tests are run separately.",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# open component testing runner\ncypress open-ct\n\n# run all component tests\ncypress run-ct\n\n# e2e tests\ncypress open\ncypress run\n")),(0,r.kt)("h4",{id:"5-Update-the-support-file-optionally"},"5. Update the support file (optionally)"),(0,r.kt)("p",null,"Previously, a support file was required to set up the component testing target\nnode. This is no longer necessary."),(0,r.kt)("p",null,"Specifically for React users, if the support file contains the following line,\nplease remove it. The import will fail in the future. We have left it in to\navoid a breaking change, but the file does nothing."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," The support file was required to import a script from ",(0,r.kt)("a",{href:"https://www.npmjs.com/package/@cypress/react"},"@cypress/react"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// support.js\n\n// This import should be removed, it will error in a future update\nimport '@cypress/react/hooks'\n")),(0,r.kt)("h4",{id:"Expanded-stylesheet-support"},"Expanded stylesheet support"),(0,r.kt)("p",null,"Stylesheets are now bundled and imported within spec and support files.\nPreviously, many of ",(0,r.kt)("inlineCode",{parentName:"p"},"mount"),"'s mounting options such as ",(0,r.kt)("inlineCode",{parentName:"p"},"stylesheets"),",\n",(0,r.kt)("inlineCode",{parentName:"p"},"cssFiles"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"styles")," were required to import stylesheets into your component\ntests. This often involved pre-compiling the stylesheets before launching the\ncomponent tests, which affected performance. Migrating to imports for these\nstyles is optional, but recommended."),(0,r.kt)("p",null,"Now, stylesheets should be loaded into the ",(0,r.kt)("inlineCode",{parentName:"p"},"document")," the same way they are in\nyour application. It is recommended you update your code like so:"),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," Stylesheets were loaded using the filesystem",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const { mount } = require('@cypress/react')\nconst Button = require('./Button')\n\nit('renders a Button', () => {\n  // Mounting a button and loading the Tailwind CSS library\n  mount(<Button />, {\n    stylesheets: [\n      // Paths are relative to the project root directory and must be pre-compiled\n      // Because they are static, they do not watch for file updates\n      '/dist/index.css',\n      '/node_modules/tailwindcss/dist/tailwind.min.css',\n    ],\n  })\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Stylesheets are supported via an import and ",(0,r.kt)("code",null,"mountingOptions.stylesheets")," is not recommended",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// In the majority of modern style-loaders,\n// these styles will be injected into document.head when they're imported below\nrequire('./index.scss')\nrequire('tailwindcss/dist/tailwind.min.css')\n\nconst { mount } = require('@cypress/react')\nconst Button = require('./Button')\n\nit('renders a Button', () => {\n  // This button will render with the Tailwind CSS styles\n  // as well as the application's index.scss styles\n  mount(<Button />)\n})\n")),(0,r.kt)("h4",{id:"Desktop-GUI-no-longer-displays-component-tests"},"Desktop GUI no longer displays component tests"),(0,r.kt)("p",null,"Previously, the Desktop GUI displayed ",(0,r.kt)("em",{parentName:"p"},"both")," end-to-end and component tests.\nNow, component tests are only displayed when launching via the component\ntesting-specific subcommands. ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress open-ct")," (or ",(0,r.kt)("inlineCode",{parentName:"p"},"run-ct")," in CI)"),(0,r.kt)("h4",{id:"Executing-all-or-some-component-tests"},"Executing all or some component tests"),(0,r.kt)("p",null,"In 6.X, the Desktop GUI had support for finding and executing a subset of\ncomponent tests. In 7.0, this is possible with the ",(0,r.kt)("inlineCode",{parentName:"p"},"--headed")," command and a spec\nglob, like so:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"cypress run-ct --headed --spec **/some-folder/*spec.*\n")),(0,r.kt)("h4",{id:"Coverage"},"Coverage"),(0,r.kt)("p",null,"Previously, the ",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@cypress/vue"},(0,r.kt)("inlineCode",{parentName:"a"},"@cypress/react")),"\n4.X package embedded code coverage in your tests automatically."),(0,r.kt)("p",null,"If you still wish to record code coverage in your tests, you must manually\ninstall it. Please see our ",(0,r.kt)("a",{parentName:"p",href:"/guides/tooling/code-coverage"},"code coverage guide"),"\nfor the latest steps."),(0,r.kt)("h4",{id:"cypress-react-selector"},"cypress-react-selector"),(0,r.kt)("p",null,"If you use ",(0,r.kt)("inlineCode",{parentName:"p"},"cy.react()")," in your tests, you must manually install\n",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/cypress-react-selector"},(0,r.kt)("inlineCode",{parentName:"a"},"cypress-react-selector")),"\nwith ",(0,r.kt)("inlineCode",{parentName:"p"},"npm i cypress-react-selector -D"),". You do not need to update your support\nfile."),(0,r.kt)("h4",{id:"HTML-Side-effects"},"HTML Side effects"),(0,r.kt)("p",null,"As of 7.0, we only clean up components mounted by Cypress via\n",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@cypress/react"},(0,r.kt)("inlineCode",{parentName:"a"},"@cypress/react"))," or\n",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@cypress/vue"},(0,r.kt)("inlineCode",{parentName:"a"},"@cypress/vue")),"."),(0,r.kt)("p",null,"We no longer automatically reset the ",(0,r.kt)("inlineCode",{parentName:"p"},"document.body")," between tests. Any HTML\nside effects of your component tests will carry over."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," All HTML content was cleared between spec files",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"const { mount } = require('@cypress/react')\n\ndescribe('Component teardown behavior', () => {\n  it('modifies the document and mounts a component', () => {\n    // HTML unrelated to the component is mounted\n    Cypress.$('body').append('<div data-cy=\"some-html\"/>')\n\n    // A component is mounted\n    mount(<Button data-cy=\"my-button\"></Button>)\n\n    cy.get('[data-cy=\"some-html\"]').should('exist')\n    cy.get('[data-cy=\"my-button\"]').should('exist')\n  })\n\n  it('cleans up any HTML', () => {\n    // The component is automatically unmounted by Cypress\n    cy.get('[data-cy=\"my-button\"]').should('not.exist')\n\n    // The HTML left over from the previous test has been cleaned up\n    // This was done automatically by Cypress\n    cy.get('[data-cy=\"some-html\"]').should('not.exist')\n  })\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Only the components are cleaned up between spec files",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx"},"const { mount } = require('@cypress/react')\n\ndescribe('Component teardown behavior', () => {\n  it('modifies the document and mounts a component', () => {\n    // HTML unrelated to the component is mounted\n    Cypress.$('body').append('<div data-cy=\"some-html\"/>')\n\n    // A component is mounted\n    mount(<Button data-cy=\"my-button\"></Button>)\n\n    cy.get('[data-cy=\"some-html\"]').should('exist')\n    cy.get('[data-cy=\"my-button\"]').should('exist')\n  })\n\n  it('only cleans up *components* between tests', () => {\n    // The component is automatically unmounted by Cypress\n    cy.get('[data-cy=\"my-button\"]').should('not.exist')\n\n    // The HTML left over from the previous test should be manually cleared\n    cy.get('[data-cy=\"some-html\"]').should('not.exist')\n  })\n})\n")),(0,r.kt)("h4",{id:"Legacy-cypress-react-unit-test-and-cypress-vue-unit-test-packages"},"Legacy ",(0,r.kt)("inlineCode",{parentName:"h4"},"cypress-react-unit-test")," and ",(0,r.kt)("inlineCode",{parentName:"h4"},"cypress-vue-unit-test")," packages"),(0,r.kt)("p",null,"For users upgrading from\n",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/cypress-react-unit-test"},(0,r.kt)("inlineCode",{parentName:"a"},"cypress-react-unit-tests")),"\nor\n",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/cypress-vue-unit-test"},(0,r.kt)("inlineCode",{parentName:"a"},"cypress-vue-unit-tests")),",\nplease update all references to use\n",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@cypress/react"},(0,r.kt)("inlineCode",{parentName:"a"},"@cypress/react"))," or\n",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@cypress/vue"},(0,r.kt)("inlineCode",{parentName:"a"},"@cypress/vue")),". These packages\nhave been deprecated and moved to the Cypress scope on npm."),(0,r.kt)("h3",{id:"Uncaught-exception-and-unhandled-rejections"},"Uncaught exception and unhandled rejections"),(0,r.kt)("p",null,"In 7.0, Cypress now fails tests in more situations where there is an uncaught\nexception and also if there is an unhandled promise rejection in the application\nunder test."),(0,r.kt)("p",null,"You can ignore these situations and not fail the Cypress test with the code\nbelow."),(0,r.kt)("h4",{id:"Turn-off-all-uncaught-exception-handling"},"Turn off all uncaught exception handling"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"Cypress.on('uncaught:exception', (err, runnable) => {\n  // returning false here prevents Cypress from\n  // failing the test\n  return false\n})\n")),(0,r.kt)("h4",{id:"Turn-off-uncaught-exception-handling-unhandled-promise-rejections"},"Turn off uncaught exception handling unhandled promise rejections"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"Cypress.on('uncaught:exception', (err, runnable, promise) => {\n  // when the exception originated from an unhandled promise\n  // rejection, the promise is provided as a third argument\n  // you can turn off failing the test in this case\n  if (promise) {\n    // returning false here prevents Cypress from\n    // failing the test\n    return false\n  }\n})\n")),(0,r.kt)("h3",{id:"Nodejs-12-support"},"Node.js 12+ support"),(0,r.kt)("p",null,"Cypress comes bundled with its own\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/cypress-io/cypress/blob/develop/.node-version"},"Node.js version"),".\nHowever, installing the ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress")," npm package uses the Node.js version installed\non your system."),(0,r.kt)("p",null,"Node.js 10 reached its end of life on Dec 31, 2019 and Node.js 13 reached its\nend of life on June 1, 2019.\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/nodejs/Release"},"See Node's release schedule"),". These Node.js\nversions will no longer be supported when installing Cypress. The minimum\nNode.js version supported to install Cypress is Node.js 12 or Node.js 14+."),(0,r.kt)("h2",{id:"Migrating-cyroute-to-cyintercept"},"Migrating ",(0,r.kt)("inlineCode",{parentName:"h2"},"cy.route()")," to ",(0,r.kt)("a",{parentName:"h2",href:"/api/commands/intercept"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.intercept()"))),(0,r.kt)("p",null,"This guide details how to change your test code to migrate from ",(0,r.kt)("inlineCode",{parentName:"p"},"cy.route()")," to\n",(0,r.kt)("a",{parentName:"p",href:"/api/commands/intercept"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.intercept()")),". ",(0,r.kt)("inlineCode",{parentName:"p"},"cy.server()")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"cy.route()")," are deprecated in\nCypress 6.0.0. In a future release, support for ",(0,r.kt)("inlineCode",{parentName:"p"},"cy.server()")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"cy.route()"),"\nwill be removed."),(0,r.kt)("p",null,"Please also refer to the full documentation for ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/intercept"},"cy.intercept()"),"."),(0,r.kt)("h3",{id:"Match-simple-route"},"Match simple route"),(0,r.kt)("p",null,"In many use cases, you can replace ",(0,r.kt)("inlineCode",{parentName:"p"},"cy.route()")," with ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/intercept"},"cy.intercept()"),"\nand remove the call to ",(0,r.kt)("inlineCode",{parentName:"p"},"cy.server()")," (which is no longer necessary)."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// Set up XHR listeners using cy.route()\ncy.server()\ncy.route('/users').as('getUsers')\ncy.route('POST', '/project').as('createProject')\ncy.route('PATCH', '/projects/*').as('updateProject')\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// Intercept HTTP requests\ncy.intercept('/users').as('getUsers')\ncy.intercept('POST', '/project').as('createProject')\ncy.intercept('PATCH', '/projects/*').as('updateProject')\n")),(0,r.kt)("h3",{id:"Match-against-url-and-path"},"Match against ",(0,r.kt)("inlineCode",{parentName:"h3"},"url")," and ",(0,r.kt)("inlineCode",{parentName:"h3"},"path")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"url")," argument to ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/intercept"},"cy.intercept()")," matches against the full url,\nas opposed to the ",(0,r.kt)("inlineCode",{parentName:"p"},"url")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"path")," in ",(0,r.kt)("inlineCode",{parentName:"p"},"cy.route()"),". If you're using the ",(0,r.kt)("inlineCode",{parentName:"p"},"url"),"\nargument in ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/intercept"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.intercept()")),", you may need to update your code\ndepending on the route you're trying to match."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// Match XHRs with a path or url of /users\ncy.server()\ncy.route({\n  method: 'POST',\n  url: '/users',\n}).as('getUsers')\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// Match HTTP requests with a path of /users\ncy.intercept({\n  method: 'POST',\n  path: '/users',\n}).as('getUsers')\n\n// OR\n// Match HTTP requests with an exact url of https://example.cypress.io/users\ncy.intercept({\n  method: 'POST',\n  url: 'https://example.cypress.io/users',\n}).as('getUsers')\n")),(0,r.kt)("h3",{id:"cywait-object"},(0,r.kt)("inlineCode",{parentName:"h3"},"cy.wait()")," object"),(0,r.kt)("p",null,"The object returned by ",(0,r.kt)("inlineCode",{parentName:"p"},"cy.wait()")," is different from intercepted HTTP requests\nusing ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/intercept"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.intercept()"))," than the object returned from an awaited\n",(0,r.kt)("inlineCode",{parentName:"p"},"cy.route()")," XHR."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// Wait for XHR from cy.route()\ncy.route('POST', '/users').as('createUser')\n// ...\ncy.wait('@createUser').then(({ requestBody, responseBody, status }) => {\n  expect(status).to.eq(200)\n  expect(requestBody.firstName).to.eq('Jane')\n  expect(responseBody.firstName).to.eq('Jane')\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// Wait for intercepted HTTP request\ncy.intercept('POST', '/users').as('createUser')\n// ...\ncy.wait('@createUser').then(({ request, response }) => {\n  expect(response.statusCode).to.eq(200)\n  expect(request.body.name).to.eq('Jane')\n  expect(response.body.name).to.eq('Jane')\n})\n")),(0,r.kt)("h3",{id:"Fixtures"},"Fixtures"),(0,r.kt)("p",null,"You can stub requests and response with fixture data by defining a ",(0,r.kt)("inlineCode",{parentName:"p"},"fixture"),"\nproperty in the ",(0,r.kt)("inlineCode",{parentName:"p"},"routeHandler")," argument for ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/intercept"},(0,r.kt)("inlineCode",{parentName:"a"},"cy.intercept()")),"."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// Stub response with fixture data using cy.route()\ncy.route('GET', '/projects', 'fx:projects')\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// Stub response with fixture data using cy.intercept()\ncy.intercept('GET', '/projects', {\n  fixture: 'projects',\n})\n")),(0,r.kt)("h3",{id:"Override-intercepts"},"Override intercepts"),(0,r.kt)("p",null,"As of 7.0, newer intercepts are called before older intercepts, allowing users\nto override intercepts.\n",(0,r.kt)("a",{parentName:"p",href:"#Handler-ordering-is-reversed"},'See "Handler ordering is reversed" for more details'),"."),(0,r.kt)("p",null,"Before 7.0, intercepts could not be overridden. See\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/cypress-io/cypress/issues/9302"},"#9302")," for more details."),(0,r.kt)("h2",{id:"Migrating-to-Cypress-60"},"Migrating to Cypress 6.0"),(0,r.kt)("p",null,"This guide details the changes and how to change your code to migrate to Cypress\n6.0. ",(0,r.kt)("a",{parentName:"p",href:"/guides/references/changelog#6-0-0"},"See the full changelog for 6.0"),"."),(0,r.kt)("h3",{id:"Non-existent-element-assertions"},"Non-existent element assertions"),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("strong",{parentName:"p"},"Key takeway:")," Use ",(0,r.kt)("inlineCode",{parentName:"p"},".should('not.exist')")," to assert that an element does not\nexist in the DOM (not ",(0,r.kt)("inlineCode",{parentName:"p"},".should('not.be.visible')"),", etc).")),(0,r.kt)("p",null,"In previous versions of Cypress, there was a possibility for tests to falsely\npass when asserting a negative state on non-existent elements."),(0,r.kt)("p",null,"For example, in the tests below we want to test that the search dropdown is no\nlonger visible when the search input is blurred because we hide the element in\nCSS styles. Except in this test, we've mistakenly misspelled one of our\nselectors."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.get('input[type=search]').type('Cypress')\ncy.get('#dropdown').should('be.visible')\ncy.get('input[type=search]').blur()\n\n// below we misspelled \"dropdown\" in the selector \ud83d\ude1e\n// the assertions falsely pass in Cypress < 6.0\n// and will correctly fail in Cypress 6.0 +\ncy.get('#dropdon').should('not.be.visible')\ncy.get('#dropdon').should('not.have.class', 'open')\ncy.get('#dropdon').should('not.contain', 'Cypress')\n")),(0,r.kt)(k,{src:"/img/guides/migration-guide/el-incorrectly-passes-existence-check.png",alt:"non-existent element before 6.0",mdxType:"DocsImage"}),(0,r.kt)("p",null,"In 6.0, these assertions will now correctly fail, telling us that the ",(0,r.kt)("inlineCode",{parentName:"p"},"#dropdon"),"\nelement doesn't exist in the DOM."),(0,r.kt)(k,{src:"/img/guides/migration-guide/el-correctly-fails-existence-check.png",alt:"non-existent element in 6.0",mdxType:"DocsImage"}),(0,r.kt)("h4",{id:"Assertions-on-non-existent-elements"},"Assertions on non-existent elements"),(0,r.kt)("p",null,"This fix may cause some breaking changes in your tests if you are relying on\nassertions such as ",(0,r.kt)("inlineCode",{parentName:"p"},"not.be.visible")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"not.contains")," to test that the DOM\nelement did not ",(0,r.kt)("em",{parentName:"p"},"exist")," in the DOM. This means you'll need to update your test\ncode to be more specific about your assertions on non-existent elements."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," Assert that non existent element was not visible",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"it('test', () => {\n  // the modal element is removed from the DOM on click\n  cy.get('[data-cy=\"modal\"]').find('.close').click()\n  // assertions below pass in <code 6.0, but properly fail in 6.0+\n  cy.get('[data-cy=\"modal\"]').should('not.be.visible')\n  cy.get('[data-cy=\"modal\"]').should('not.contain', 'Upgrade')\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Assert that non existent element does not exist",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"it('test', () => {\n  // the modal element is removed from the DOM on click\n  cy.get('data-cy=\"modal\"').find('.close').click()\n  // we should instead assert that the element doesn't exist\n  cy.get('data-cy=\"modal\"').should('not.exist')\n})\n")),(0,r.kt)("h3",{id:"Opacity-visibility"},"Opacity visibility"),(0,r.kt)("p",null,"DOM elements with ",(0,r.kt)("inlineCode",{parentName:"p"},"opacity: 0")," style are no longer considered to be visible.\nThis includes elements with an ancestor that has ",(0,r.kt)("inlineCode",{parentName:"p"},"opacity: 0")," since a child\nelement can never have a computed opacity greater than that of an ancestor."),(0,r.kt)("p",null,"Elements where the CSS property (or ancestors) is ",(0,r.kt)("inlineCode",{parentName:"p"},"opacity: 0")," are still\nconsidered ",(0,r.kt)("a",{parentName:"p",href:"/guides/core-concepts/interacting-with-elements"},"actionable")," however\nand\n",(0,r.kt)("a",{parentName:"p",href:"/guides/core-concepts/interacting-with-elements#Actionability"},"any action commands"),"\nused to interact with the element will perform the action. This matches\nbrowser's implementation on how they regard elements with ",(0,r.kt)("inlineCode",{parentName:"p"},"opacity: 0"),"."),(0,r.kt)("h4",{id:"Assert-visibility-of-opacity-0-element"},"Assert visibility of ",(0,r.kt)("inlineCode",{parentName:"h4"},"opacity: 0")," element"),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," Failed assertion that ",(0,r.kt)("code",null,"opacity: 0")," element is not visible.",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"it('test', () => {\n  // '.hidden' has 'opacity: 0' style.\n  // In < 5.0 this assertion would fail\n  cy.get('.hidden').should('not.be.visible')\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Passed assertion that ",(0,r.kt)("code",null,"opacity: 0")," element is not visible.",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"it('test', () => {\n  // '.hidden' has 'opacity: 0' style.\n  // In 6.0 this assertion will pass\n  cy.get('.hidden').should('not.be.visible')\n})\n")),(0,r.kt)("h4",{id:"Perform-actions-on-opacity-0-element"},"Perform actions on ",(0,r.kt)("inlineCode",{parentName:"h4"},"opacity: 0")," element"),(0,r.kt)("p",null,"In all versions of Cypress, you can interact with elements that have\n",(0,r.kt)("inlineCode",{parentName:"p"},"opacity: 0")," style."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"it('test', () => {\n  // '.hidden' has 'opacity: 0' style.\n  cy.get('.hidden').click() // \u2705 clicks on element\n  cy.get('.hidden').type('hi') // \u2705 types into element\n  cy.get('.hidden').check() // \u2705 checks element\n  cy.get('.hidden').select('yes') // \u2705 selects element\n})\n")),(0,r.kt)("h3",{id:"cywaitalias-type"},(0,r.kt)("inlineCode",{parentName:"h3"},"cy.wait(alias)")," type"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"cy.route()")," is deprecated in 6.0.0. We encourage the use of\n",(0,r.kt)("a",{parentName:"p",href:"/api/commands/intercept"},"cy.intercept()")," instead. Due to this deprecation, the type yielded\nby ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/wait"},"cy.wait(alias)")," has changed."),(0,r.kt)("p",null,"\xa0",(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," Before 6.0.0,\n",(0,r.kt)("a",{parentName:"p",href:"/api/commands/wait"},"cy.wait(alias)")," would yield an object of type ",(0,r.kt)("inlineCode",{parentName:"p"},"WaitXHR"),"."),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," In 6.0.0 and onwards, [cy.wait(alias)](/api/commands/wait) will yield an object of type `Interception`. This matches the new interception object type used for [cy.intercept()][intercept].",(0,r.kt)("h4",{id:"Restore-old-behavior"},"Restore old behavior"),(0,r.kt)("p",null,"If you need to restore the type behavior prior to 6.0.0 for\n",(0,r.kt)("a",{parentName:"p",href:"/api/commands/wait"},"cy.wait(alias)"),", you can declare a global override for\n",(0,r.kt)("a",{parentName:"p",href:"/api/commands/wait"},"cy.wait()")," like so:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"declare global {\n  namespace Cypress {\n    interface Chainable<Subject = any> {\n      wait(alias: string): Chainable<Cypress.WaitXHR>\n    }\n  }\n}\n")),(0,r.kt)("h3",{id:"disable-dev-shm-usage"},(0,r.kt)("inlineCode",{parentName:"h3"},"\u2014disable-dev-shm-usage")),(0,r.kt)("p",null,"We now pass ",(0,r.kt)("inlineCode",{parentName:"p"},"\u2014disable-dev-shm-usage")," to the Chrome browser flags by default. If\nyou're passing this flag in your ",(0,r.kt)("inlineCode",{parentName:"p"},"plugins")," file, you can now remove this code."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," Passing flag in plugins file.",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// cypress/plugins/index.js\nmodule.exports = (on, config) => {\n  on('before:browser:launch', (browser = {}, launchOptions) => {\n    if (browser.family === 'chromium' && browser.name !== 'electron') {\n      launchOptions.args.push('--disable-dev-shm-usage')\n    }\n\n    return launchOptions\n  })\n}\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Remove flag from plugins file.",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// cypress/plugins/index.js\nmodule.exports = (on, config) => {}\n")),(0,r.kt)("h4",{id:"Restore-old-behavior-1"},"Restore old behavior"),(0,r.kt)("p",null,"If you need to remove the flag in 6.0.0+, you can follow the workaround\ndocumented here: ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/cypress-io/cypress/issues/9242"},"#9242"),"."),(0,r.kt)("h2",{id:"Migrating-to-Cypress-50"},"Migrating to Cypress 5.0"),(0,r.kt)("p",null,"This guide details the changes and how to change your code to migrate to Cypress\n5.0. ",(0,r.kt)("a",{parentName:"p",href:"/guides/references/changelog#5-0-0"},"See the full changelog for 5.0"),"."),(0,r.kt)("h3",{id:"Tests-retries"},"Tests retries"),(0,r.kt)("p",null,"Test retries are available in Cypress 5.0. This means that tests can be re-run a\nnumber of times before potentially being marked as a failed test. Read the\n",(0,r.kt)("a",{parentName:"p",href:"/guides/guides/test-retries"},"Test Retries")," doc for more information on how this\nworks and how to turn on test retries."),(0,r.kt)("p",null,"When test retries are turned on, there will now be a screenshot taken for every\nfailed attempt, so there could potentially be more than 1 screenshot per test\nfailure. Read the ",(0,r.kt)("a",{parentName:"p",href:"/guides/guides/test-retries"},"Test Retries")," doc for more\ninformation on how this works."),(0,r.kt)("p",null,"The\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/Bkucera/cypress-plugin-retries"},(0,r.kt)("inlineCode",{parentName:"a"},"cypress-plugin-retries")),"\nplugin has been deprecated in favor of test retries built into Cypress. There's\nguidance below on how to migrate from the\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/Bkucera/cypress-plugin-retries"},(0,r.kt)("inlineCode",{parentName:"a"},"cypress-plugin-retries")),"\nplugin to Cypress's built-in test retries."),(0,r.kt)("h4",{id:"Configure-test-retries-via-the-CLI"},"Configure test retries via the CLI"),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," Setting retries with ",(0,r.kt)("code",null,"cypress-plugin-retries")," via env vars",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"CYPRESS_RETRIES=2 cypress run\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Setting test retries in Cypress 5.0 via env vars",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"CYPRESS_RETRIES=2 cypress run\n")),(0,r.kt)("h4",{id:"Configure-test-retries-in-the-configuration-file"},"Configure test retries in the configuration file"),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," Setting retries with ",(0,r.kt)("code",null,"cypress-plugin-retries")," via configuration",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "env": {\n    "RETRIES": 2\n  }\n}\n')),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Setting test retries in Cypress 5.0 via configuration",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "retries": 1\n}\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"runMode")," allows you to define the number of test retries when running\n",(0,r.kt)("inlineCode",{parentName:"li"},"cypress run")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"openMode")," allows you to define the number of test retries when running\n",(0,r.kt)("inlineCode",{parentName:"li"},"cypress open"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "retries": {\n    "runMode": 1,\n    "openMode": 3\n  }\n}\n')),(0,r.kt)("h4",{id:"Configure-test-retries-per-test"},"Configure test retries per test"),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," Setting retries with ",(0,r.kt)("code",null,"cypress-plugin-retries")," via the test",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"it('test', () => {\n  Cypress.currentTest.retries(2)\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Setting test retries in Cypress 5.0 via test options",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"it(\n  'allows user to login',\n  {\n    retries: 2,\n  },\n  () => {\n    // ...\n  }\n)\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"runMode")," allows you to define the number of test retries when running\n",(0,r.kt)("inlineCode",{parentName:"li"},"cypress run")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"openMode")," allows you to define the number of test retries when running\n",(0,r.kt)("inlineCode",{parentName:"li"},"cypress open"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"it(\n  'allows user to login',\n  {\n    retries: {\n      runMode: 2,\n      openMode: 3,\n    },\n  },\n  () => {\n    // ...\n  }\n)\n")),(0,r.kt)("h3",{id:"Module-API-results"},"Module API results"),(0,r.kt)("p",null,"To more accurately reflect result data for runs with\n",(0,r.kt)("a",{parentName:"p",href:"/guides/guides/test-retries"},"test retries"),", the structure of each run's ",(0,r.kt)("inlineCode",{parentName:"p"},"runs"),"\narray resolved from the ",(0,r.kt)("inlineCode",{parentName:"p"},"Promise")," returned from ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress.run()")," of the Module\nAPI has changed."),(0,r.kt)("p",null,"Mainly there is a new ",(0,r.kt)("inlineCode",{parentName:"p"},"attempts")," Array on each ",(0,r.kt)("inlineCode",{parentName:"p"},"test")," which will reflect the\nresult of each test retry."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," ",(0,r.kt)("code",null,"results.runs")," Module API results",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  // ...\n  "runs": [{\n    // ...\n    "hooks": [{\n      "hookId": "h1",\n      "hookName": "before each",\n      "title": [ "before each hook" ],\n      "body": "function () {\\n  expect(true).to.be["true"];\\n}"\n    }],\n    // ...\n    "screenshots": [{\n      "screenshotId": "8ddmk",\n      "name": null,\n      "testId": "r2",\n      "takenAt": "2020-08-05T08:52:20.432Z",\n      "path": "User/janelane/my-app/cypress/screenshots/spec.js/test (failed).png",\n      "height": 720,\n      "width": 1280\n    }],\n    "stats": {\n      // ...\n      "wallClockStartedAt": "2020-08-05T08:38:37.589Z",\n      "wallClockEndedAt": "2018-07-11T17:53:35.675Z",\n      "wallClockDuration": 1171\n    },\n    "tests": [{\n      "testId": "r2",\n      "title": [ "test" ],\n      "state": "failed",\n      "body": "function () {\\n  expect(true).to.be["false"];\\n}",\n      "stack": "AssertionError: expected true to be false\\n\' +\n        \'    at Context.eval (...cypress/integration/spec.js:5:21",\n      "error": "expected true to be false",\n      "timings": {\n        "lifecycle": 16,\n        "test": {...}\n      },\n      "failedFromHookId": null,\n      "wallClockStartedAt": "2020-08-05T08:38:37.589Z",\n      "wallClockDuration": 1171,\n      "videoTimestamp": 4486\n    }],\n  }],\n  // ...\n}\n')),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," ",(0,r.kt)("code",null,"results.runs")," Module API results",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  // ...\n  "runs": [{\n    // ...\n    "hooks": [{\n      "hookName": "before each",\n      "title": [ "before each hook" ],\n      "body": "function () {\\n  expect(true).to.be["true"];\\n}"\n    }],\n    // ...\n    "stats": {\n      // ...\n      "startedAt": "2020-08-05T08:38:37.589Z",\n      "endedAt": "2018-07-11T17:53:35.675Z",\n      "duration": 1171\n    },\n    "tests": [{\n      "title": [ "test" ],\n      "state": "failed",\n      "body": "function () {\\n  expect(true).to.be["false"];\\n}",\n      "displayError": "AssertionError: expected true to be false\\n\' +\n      \'    at Context.eval (...cypress/integration/spec.js:5:21",\n      "attempts": [{\n        "state": "failed",\n        "error": {\n          "message": "expected true to be false",\n          "name": "AssertionError",\n          "stack": "AssertionError: expected true to be false\\n\' +\n      \'    at Context.eval (...cypress/integration/spec.js:5:21"\n        },\n        "screenshots": [{\n          "name": null,\n          "takenAt": "2020-08-05T08:52:20.432Z",\n          "path": "User/janelane/my-app/cypress/screenshots/spec.js/test (failed).png",\n          "height": 720,\n          "width": 1280\n        }],\n        "startedAt": "2020-08-05T08:38:37.589Z",\n        "duration": 1171,\n        "videoTimestamp": 4486\n      }]\n    }],\n  }],\n  // ...\n}\n')),(0,r.kt)("h3",{id:"Cookies-whitelist-option-renamed"},"Cookies ",(0,r.kt)("inlineCode",{parentName:"h3"},"whitelist")," option renamed"),(0,r.kt)("p",null,"The ",(0,r.kt)("a",{parentName:"p",href:"/api/cypress-api/cookies"},"Cypress.Cookies.defaults()")," ",(0,r.kt)("inlineCode",{parentName:"p"},"whitelist")," option\nhas been renamed to ",(0,r.kt)("inlineCode",{parentName:"p"},"preserve")," to more closely reflect its behavior."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," ",(0,r.kt)("code",null,"whitelist")," option",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"Cypress.Cookies.defaults({\n  whitelist: 'session_id',\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," ",(0,r.kt)("code",null,"preserve")," option",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"Cypress.Cookies.defaults({\n  preserve: 'session_id',\n})\n")),(0,r.kt)("h3",{id:"blacklistHosts-configuration-renamed"},(0,r.kt)("inlineCode",{parentName:"h3"},"blacklistHosts")," configuration renamed"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"blacklistHosts")," configuration has been renamed to\n",(0,r.kt)("a",{parentName:"p",href:"/guides/references/configuration#Notes"},"blockHosts")," to more closely reflect its\nbehavior."),(0,r.kt)("p",null,"This should be updated in all places where Cypress configuration can be set\nincluding via the Cypress configuration file, command line arguments, the\n",(0,r.kt)("inlineCode",{parentName:"p"},"pluginsFile"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Cypress.config()")," or environment variables."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," ",(0,r.kt)("code",null,"blacklistHosts")," configuration",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "blacklistHosts": "www.google-analytics.com"\n}\n')),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," ",(0,r.kt)("code",null,"blockHosts")," configuration",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "blockHosts": "www.google-analytics.com"\n}\n')),(0,r.kt)("h3",{id:"Return-type-of-CypressBlob-changed"},"Return type of ",(0,r.kt)("inlineCode",{parentName:"h3"},"Cypress.Blob")," changed"),(0,r.kt)("p",null,"We updated the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/nolanlawson/blob-util"},"Blob")," library used\nbehind ",(0,r.kt)("a",{parentName:"p",href:"/api/utilities/blob"},"Cypress.Blob")," from ",(0,r.kt)("inlineCode",{parentName:"p"},"1.3.3")," to ",(0,r.kt)("inlineCode",{parentName:"p"},"2.0.2"),"."),(0,r.kt)("p",null,"The return type of the ",(0,r.kt)("a",{parentName:"p",href:"/api/utilities/blob"},"Cypress.Blob")," methods\n",(0,r.kt)("inlineCode",{parentName:"p"},"arrayBufferToBlob"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"base64StringToBlob"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"binaryStringToBlob"),", and\n",(0,r.kt)("inlineCode",{parentName:"p"},"dataURLToBlob")," have changed from ",(0,r.kt)("inlineCode",{parentName:"p"},"Promise<Blob>")," to ",(0,r.kt)("inlineCode",{parentName:"p"},"Blob"),"."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," ",(0,r.kt)("code",null,"Cypress.Blob")," methods returned a Promise",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"Cypress.Blob.base64StringToBlob(this.logo, 'image/png').then((blob) => {\n  // work with the returned blob\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," ",(0,r.kt)("code",null,"Cypress.Blob")," methods return a Blob",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const blob = Cypress.Blob.base64StringToBlob(this.logo, 'image/png')\n\n// work with the returned blob\n")),(0,r.kt)("h3",{id:"cyserver-whitelist-option-renamed"},(0,r.kt)("inlineCode",{parentName:"h3"},"cy.server()")," ",(0,r.kt)("inlineCode",{parentName:"h3"},"whitelist")," option renamed"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"cy.server()")," ",(0,r.kt)("inlineCode",{parentName:"p"},"whitelist")," option has been renamed to ",(0,r.kt)("inlineCode",{parentName:"p"},"ignore")," to more\nclosely reflect its behavior."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," ",(0,r.kt)("code",null,"whitelist")," option",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.server({\n  whitelist: (xhr) => {\n    return xhr.method === 'GET' && /\\.(jsx?|html|css)(\\?.*)?$/.test(xhr.url)\n  },\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," ",(0,r.kt)("code",null,"ignore")," option",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.server({\n  ignore: (xhr) => {\n    return xhr.method === 'GET' && /\\.(jsx?|html|css)(\\?.*)?$/.test(xhr.url)\n  },\n})\n")),(0,r.kt)("h3",{id:"Cookies-sameSite-property"},"Cookies ",(0,r.kt)("inlineCode",{parentName:"h3"},"sameSite")," property"),(0,r.kt)("p",null,"Values yielded by ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/setcookie"},"cy.setCookie()"),",\n",(0,r.kt)("a",{parentName:"p",href:"/api/commands/getcookie"},"cy.getCookie()"),", and\n",(0,r.kt)("a",{parentName:"p",href:"/api/commands/getcookies"},"cy.getCookies()")," will now contain the ",(0,r.kt)("inlineCode",{parentName:"p"},"sameSite"),"\nproperty if specified."),(0,r.kt)("p",null,"If you were using the ",(0,r.kt)("inlineCode",{parentName:"p"},"experimentalGetCookiesSameSite")," configuration to get the\n",(0,r.kt)("inlineCode",{parentName:"p"},"sameSite")," property previously, this should be removed."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," Cookies yielded before had no ",(0,r.kt)("code",null,"sameSite")," property.",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'cy.getCookie(\'token\').then((cookie) => {\n  // cy.getCookie() yields a cookie object\n  // {\n  //   domain: "localhost",\n  //   expiry: 1593551644,\n  //   httpOnly: false,\n  //   name: "token",\n  //   path: "/commands",\n  //   secure: false,\n  //   value: "123ABC"\n  // }\n})\n')),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Cookies yielded now have ",(0,r.kt)("code",null,"sameSite")," property if specified.",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'cy.getCookie(\'token\').then((cookie) => {\n  // cy.getCookie() yields a cookie object\n  // {\n  //   domain: "localhost",\n  //   expiry: 1593551644,\n  //   httpOnly: false,\n  //   name: "token",\n  //   path: "/commands",\n  //   sameSite: "strict",\n  //   secure: false,\n  //   value: "123ABC"\n  // }\n})\n')),(0,r.kt)("h3",{id:"dirname--filename"},"dirname / filename"),(0,r.kt)("p",null,"The globals ",(0,r.kt)("inlineCode",{parentName:"p"},"__dirname")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"__filename")," no longer include a leading slash."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," ",(0,r.kt)("code",null,"__dirname")," / ",(0,r.kt)("code",null,"__filename"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// cypress/integration/app_spec.js\nit('include leading slash < 5.0', () => {\n  expect(__dirname).to.equal('/cypress/integration')\n  expect(__filename).to.equal('/cypress/integration/app_spec.js')\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," ",(0,r.kt)("code",null,"__dirname")," / ",(0,r.kt)("code",null,"__filename"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// cypress/integration/app_spec.js\nit('do not include leading slash >= 5.0', () => {\n  expect(__dirname).to.equal('cypress/integration')\n  expect(__filename).to.equal('cypress/integration/app_spec.js')\n})\n")),(0,r.kt)("h3",{id:"Linux-dependencies"},"Linux dependencies"),(0,r.kt)("p",null,"Running Cypress on Linux now requires the ",(0,r.kt)("inlineCode",{parentName:"p"},"libgbm")," dependency (on Debian-based\nsystems, this is available as ",(0,r.kt)("inlineCode",{parentName:"p"},"libgbm-dev"),"). To install all required\ndependencies on Ubuntu/Debian, you can run the script below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"apt-get install libgtk2.0-0 libgtk-3-0 libgbm-dev libnotify-dev libgconf-2-4 libnss3 libxss1 libasound2 libxtst6 xauth xvfb\n")),(0,r.kt)("h3",{id:"TypeScript-esModuleInterop"},"TypeScript esModuleInterop"),(0,r.kt)("p",null,"Cypress no longer forces the ",(0,r.kt)("inlineCode",{parentName:"p"},"esModuleInterop")," compiler option for TypeScript to\nbe ",(0,r.kt)("inlineCode",{parentName:"p"},"true")," for spec, support, and plugins files. We recommend setting it in your\nproject's ",(0,r.kt)("inlineCode",{parentName:"p"},"tsconfig.json")," instead if you need to."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'// tsconfig.json\n{\n  "compilerOptions": {\n    "esModuleInterop": true\n    /* ... other compiler options ... */\n  }\n}\n')),(0,r.kt)("h3",{id:"TypeScript-34-support"},"TypeScript 3.4+ support"),(0,r.kt)("p",null,"Cypress 5.0 raises minimum required TypeScript version from 2.9+ to 3.4+. You'll\nneed to have TypeScript 3.4+ installed within your project to have TypeScript\nsupport within Cypress."),(0,r.kt)("h3",{id:"Nodejs-10-support"},"Node.js 10+ support"),(0,r.kt)("p",null,"Cypress comes bundled with its own\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/cypress-io/cypress/blob/develop/.node-version"},"Node.js version"),".\nHowever, installing the ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress")," npm package uses the Node.js version installed\non your system."),(0,r.kt)("p",null,"Node.js 8 reached its end of life on Dec 31, 2019 and Node.js 11 reached its end\nof life on June 1, 2019.\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/nodejs/Release"},"See Node's release schedule"),". These Node.js\nversions will no longer be supported when installing Cypress. The minimum\nNode.js version supported to install Cypress is Node.js 10 or Node.js 12+."),(0,r.kt)("h2",{id:"Migrating-to-Cypress-40"},"Migrating to Cypress 4.0"),(0,r.kt)("p",null,"This guide details the changes and how to change your code to migrate to Cypress\n4.0. ",(0,r.kt)("a",{parentName:"p",href:"/guides/references/changelog#4-0-0"},"See the full changelog for 4.0"),"."),(0,r.kt)("h3",{id:"Mocha-upgrade"},"Mocha upgrade"),(0,r.kt)("p",null,"Mocha was upgraded from ",(0,r.kt)("inlineCode",{parentName:"p"},"2.5.3")," to ",(0,r.kt)("inlineCode",{parentName:"p"},"7.0.1"),", which includes a number of breaking\nchanges and new features outlined in their\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/mochajs/mocha/blob/master/CHANGELOG.md"},"changelog"),". Some\nchanges you might notice are described below."),(0,r.kt)("h4",{id:"Breaking-Change-invoke-done-callback-and-return-a-promise"},(0,r.kt)(y,{name:"exclamation-triangle",color:"red",mdxType:"Icon"})," Breaking Change: invoke ",(0,r.kt)("inlineCode",{parentName:"h4"},"done")," callback and return a promise"),(0,r.kt)("p",null,"Starting with\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/mochajs/mocha/blob/master/CHANGELOG.md#300--2016-07-31"},"Mocha 3.0.0"),",\ninvoking a ",(0,r.kt)("inlineCode",{parentName:"p"},"done")," callback ",(0,r.kt)("em",{parentName:"p"},"and")," returning a promise in a test results in an\nerror."),(0,r.kt)("p",null,"This error originates from Mocha and is discussed at length\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/mochajs/mocha/pull/1320"},"here")," and\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/mochajs/mocha/issues/2407"},"here"),"."),(0,r.kt)("p",null,"The reason is that using two different ways to signal that a test is finished is\nusually a mistake and there is always a way to only use one. There is a\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/mochajs/mocha/issues/2509"},"proposal to handle this situation without erroring"),"\nthat may be released in a future version of Mocha."),(0,r.kt)("p",null,"In the meantime, you can fix the error by choosing a single way to signal the\nend of your test's execution."),(0,r.kt)("h5",{id:"Example-1"},"Example #1"),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," This test has a done callback and a promise",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"it('uses invokes done and returns promise', (done) => {\n  return codeUnderTest.doSomethingThatReturnsPromise().then((result) => {\n    // assertions here\n    done()\n  })\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," You can remove the `done` callback and return the promise instead:",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"it('uses invokes done and returns promise', () => {\n  return codeUnderTest.doSomethingThatReturnsPromise().then((result) => {\n    // assertions here\n  })\n})\n")),(0,r.kt)("h5",{id:"Example-2"},"Example #2"),(0,r.kt)("p",null,"\xa0",(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," Sometimes it might make more sense to\nuse the ",(0,r.kt)("inlineCode",{parentName:"p"},"done")," callback and not return a promise:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"it('uses invokes done and returns promise', (done) => {\n  eventEmitter.on('change', () => {\n    // assertions\n    done()\n  })\n\n  return eventEmitter.doSomethingThatEmitsChange()\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," In this case, you don't need to return the promise:",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"it('uses invokes done and returns promise', (done) => {\n  eventEmitter.on('change', () => {\n    // assertions\n    done()\n  })\n\n  eventEmitter.doSomethingThatEmitsChange()\n})\n")),(0,r.kt)("h5",{id:"Example-3"},"Example #3"),(0,r.kt)("p",null,"Test functions using ",(0,r.kt)("inlineCode",{parentName:"p"},"async/await")," automatically return a promise, so they need\nto be refactored to not use a ",(0,r.kt)("inlineCode",{parentName:"p"},"done")," callback."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," This will cause an overspecified error.",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"it('uses async/await', async (done) => {\n  const eventEmitter = await getEventEmitter()\n  eventEmitter.on('change', () => done())\n  eventEmitter.doSomethingThatEmitsChange()\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Update to the test code below.",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"it('uses async/await', async () => {\n  const eventEmitter = await getEventEmitter()\n  return new Promise((resolve) => {\n    eventEmitter.on('change', () => resolve())\n    eventEmitter.doSomethingThatEmitsChange()\n  })\n})\n")),(0,r.kt)("h4",{id:"Tests-require-a-title"},(0,r.kt)(y,{name:"exclamation-triangle",color:"red",mdxType:"Icon"})," Tests require a title"),(0,r.kt)("p",null,"Tests now require a title and will error when not provided one."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'// Would show as pending in Cypress 3\n// Will throw type error in Cypress 4:\nit() // Test argument "title" should be a string. Received type "undefined"\n')),(0,r.kt)("h3",{id:"Chai-upgrade"},"Chai upgrade"),(0,r.kt)("p",null,"Chai was upgraded from ",(0,r.kt)("inlineCode",{parentName:"p"},"3.5.0")," to ",(0,r.kt)("inlineCode",{parentName:"p"},"4.2.0"),", which includes a number of breaking\nchanges and new features outlined in\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/chaijs/chai/issues/781"},"Chai's migration guide"),". Some\nchanges you might notice are described below."),(0,r.kt)("h4",{id:"Breaking-Change-assertions-expecting-numbers"},(0,r.kt)(y,{name:"exclamation-triangle",color:"red",mdxType:"Icon"})," Breaking Change: assertions expecting numbers"),(0,r.kt)("p",null,"Some assertions will now throw an error if the assertion's target or arguments\nare not numbers, including ",(0,r.kt)("inlineCode",{parentName:"p"},"within"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"above"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"least"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"below"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"most"),",\n",(0,r.kt)("inlineCode",{parentName:"p"},"increase")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"decrease"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"// These will now throw errors:\nexpect(null).to.be.within(0, 1)\nexpect(null).to.be.above(10)\n// This will not throw errors:\nexpect('string').to.have.a.length.of.at.least(3)\n")),(0,r.kt)("h4",{id:"Breaking-Change-empty-assertions"},(0,r.kt)(y,{name:"exclamation-triangle",color:"red",mdxType:"Icon"})," Breaking Change: ",(0,r.kt)("inlineCode",{parentName:"h4"},"empty")," assertions"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".empty")," assertion will now throw when it is passed non-string primitives\nand functions."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"// These will now throw TypeErrors\nexpect(Symbol()).to.be.empty\nexpect(() => {}).to.be.empty\n")),(0,r.kt)("h4",{id:"Breaking-Change-non-existent-properties"},(0,r.kt)(y,{name:"exclamation-triangle",color:"red",mdxType:"Icon"})," Breaking Change: non-existent properties"),(0,r.kt)("p",null,"An error will throw when a non-existent property is read. If there are typos in\nproperty assertions, they will now appear as failures."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"// Would pass in Cypress 3 but will fail correctly in 4\nexpect(true).to.be.ture\n")),(0,r.kt)("h4",{id:"Breaking-Change-include-checks-strict-equality"},(0,r.kt)(y,{name:"exclamation-triangle",color:"red",mdxType:"Icon"})," Breaking Change: ",(0,r.kt)("inlineCode",{parentName:"h4"},"include")," checks strict equality"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"include")," now always use strict equality unless the ",(0,r.kt)("inlineCode",{parentName:"p"},"deep")," property is set."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," ",(0,r.kt)("code",null,"include")," would always use deep equality",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"// Would pass in Cypress 3 but will fail correctly in 4\ncy.wrap([\n  {\n    first: 'Jane',\n    last: 'Lane',\n  },\n]).should('include', {\n  first: 'Jane',\n  last: 'Lane',\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Need to specificy ",(0,r.kt)("code",null,"deep.include")," for deep equality",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"// Specifically check for deep.include to pass in Cypress 4\ncy.wrap([\n  {\n    first: 'Jane',\n    last: 'Lane',\n  },\n]).should('deep.include', {\n  first: 'Jane',\n  last: 'Lane',\n})\n")),(0,r.kt)("h3",{id:"SinonJS-upgrade"},"Sinon.JS upgrade"),(0,r.kt)("p",null,"Sinon.JS was upgraded from ",(0,r.kt)("inlineCode",{parentName:"p"},"3.2.0")," to ",(0,r.kt)("inlineCode",{parentName:"p"},"8.1.1"),", which includes a number of\nbreaking changes and new features outlined in\n",(0,r.kt)("a",{parentName:"p",href:"https://sinonjs.org/releases/latest/#migration-guides"},"Sinon.JS's migration guide"),".\nSome changes you might notice are described below."),(0,r.kt)("h4",{id:"Breaking-Change-stub-non-existent-properties"},(0,r.kt)(y,{name:"exclamation-triangle",color:"red",mdxType:"Icon"})," Breaking Change: stub non-existent properties"),(0,r.kt)("p",null,"An error will throw when trying to stub a non-existent property."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"// Would pass in Cypress 3 but will fail in 4\ncy.stub(obj, 'nonExistingProperty')\n")),(0,r.kt)("h4",{id:"Breaking-Change-reset-replaced-by-resetHistory"},(0,r.kt)(y,{name:"exclamation-triangle",color:"red",mdxType:"Icon"})," Breaking Change: ",(0,r.kt)("inlineCode",{parentName:"h4"},"reset()")," replaced by ",(0,r.kt)("inlineCode",{parentName:"h4"},"resetHistory()")),(0,r.kt)("p",null,"For spies and stubs, the ",(0,r.kt)("inlineCode",{parentName:"p"},"reset()")," method was replaced by ",(0,r.kt)("inlineCode",{parentName:"p"},"resetHistory()"),"."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," Spies and stubs using ",(0,r.kt)("code",null,"reset()"),".",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"const spy = cy.spy()\nconst stub = cy.stub()\n\nspy.reset()\nstub.reset()\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Update spies and stubs should now use ",(0,r.kt)("code",null,"resetHistory()"),".",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"const spy = cy.spy()\nconst stub = cy.stub()\n\nspy.resetHistory()\nstub.resetHistory()\n")),(0,r.kt)("h3",{id:"Plugin-Event-beforebrowserlaunch"},"Plugin Event ",(0,r.kt)("inlineCode",{parentName:"h3"},"before:browser:launch")),(0,r.kt)("p",null,"Since we now support more advanced browser launch options, during\n",(0,r.kt)("inlineCode",{parentName:"p"},"before:browser:launch")," we no longer yield the second argument as an array of\nbrowser arguments and instead yield a ",(0,r.kt)("inlineCode",{parentName:"p"},"launchOptions")," object with an ",(0,r.kt)("inlineCode",{parentName:"p"},"args"),"\nproperty."),(0,r.kt)("p",null,"You can see more examples of the new ",(0,r.kt)("inlineCode",{parentName:"p"},"launchOptions")," in use in the\n",(0,r.kt)("a",{parentName:"p",href:"/api/plugins/browser-launch-api"},"Browser Launch API doc"),"."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," The second argument is no longer an array.",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"on('before:browser:launch', (browser, args) => {\n  // will print a deprecation warning telling you\n  // to change your code to the new signature\n  args.push('--another-arg')\n\n  return args\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Access the ",(0,r.kt)("code",null,"args")," property off ",(0,r.kt)("code",null,"launchOptions"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"on('before:browser:launch', (browser, launchOptions) => {\n  launchOptions.args.push('--another-arg')\n\n  return launchOptions\n})\n")),(0,r.kt)("h3",{id:"Electron-options-in-beforebrowserlaunch"},"Electron options in ",(0,r.kt)("inlineCode",{parentName:"h3"},"before:browser:launch")),(0,r.kt)("p",null,"Previously, you could pass options to the launched Electron\n",(0,r.kt)("a",{parentName:"p",href:"https://www.electronjs.org/docs/api/browser-window#new-browserwindowoptions"},"BrowserWindow"),"\nin ",(0,r.kt)("inlineCode",{parentName:"p"},"before:browser:launch")," by modifying the ",(0,r.kt)("inlineCode",{parentName:"p"},"launchOptions")," object."),(0,r.kt)("p",null,"Now, you must pass those options as ",(0,r.kt)("inlineCode",{parentName:"p"},"launchOptions.preferences"),":"),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," Passing BrowserWindow options on the ",(0,r.kt)("code",null,"launchOptions")," object is no longer supported.",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"on('before:browser:launch', (browser, args) => {\n  args.darkTheme = true\n\n  return args\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Pass BrowserWindow options on the ",(0,r.kt)("code",null,"options.preferences")," object instead.",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"on('before:browser:launch', (browser, launchOptions) => {\n  launchOptions.preferences.darkTheme = true\n\n  return launchOptions\n})\n")),(0,r.kt)("h3",{id:"Launching-Chrome-Canary-with---browser"},"Launching Chrome Canary with ",(0,r.kt)("inlineCode",{parentName:"h3"},"--browser")),(0,r.kt)("p",null,"Before 4.0, ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress run --browser canary")," would run tests in Chrome Canary."),(0,r.kt)("p",null,"Now, you must pass ",(0,r.kt)("inlineCode",{parentName:"p"},"--browser chrome:canary")," to select Chrome Canary."),(0,r.kt)("p",null,"See the\n",(0,r.kt)("a",{parentName:"p",href:"/guides/guides/command-line#cypress-run-browser-lt-browser-name-or-path-gt"},"docs for ",(0,r.kt)("inlineCode",{parentName:"a"},"cypress run --browser")),"\nfor more information."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," Passing ",(0,r.kt)("code",null,"canary")," will no longer find a browser",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"cypress run --browser canary\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Pass ",(0,r.kt)("code",null,"chrome:canary")," to launch Chrome Canary",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"cypress run --browser chrome:canary\n")),(0,r.kt)("h3",{id:"Chromium-based-browser-family"},"Chromium-based browser ",(0,r.kt)("inlineCode",{parentName:"h3"},"family")),(0,r.kt)("p",null,"We updated the ",(0,r.kt)("a",{parentName:"p",href:"/api/plugins/browser-launch-api"},"Cypress browser objects")," of all\nChromium-based browsers, including Electron, to have ",(0,r.kt)("inlineCode",{parentName:"p"},"chromium")," set as their\n",(0,r.kt)("inlineCode",{parentName:"p"},"family")," field."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = (on, config) => {\n  on('before:browser:launch', (browser = {}, launchOptions) => {\n    if (browser.family === 'electron') {\n      // would match Electron in 3.x\n      // will match no browsers in 4.0.0\n      return launchOptions\n    }\n\n    if (browser.family === 'chromium') {\n      // would match no browsers in 3.x\n      // will match any Chromium-based browser in 4.0.0\n      // ie Chrome, Canary, Chromium, Electron, Edge (Chromium-based)\n      return launchOptions\n    }\n  })\n}\n")),(0,r.kt)("h4",{id:"Example-1-Finding-Electron"},"Example #1 (Finding Electron)"),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," This will no longer find the Electron browser.",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = (on, config) => {\n  on('before:browser:launch', (browser = {}, args) => {\n    if (browser.family === 'electron') {\n      // run code for Electron browser in 3.x\n      return args\n    }\n  })\n}\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Use ",(0,r.kt)("code",null,"browser.name")," to check for Electron",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = (on, config) => {\n  on('before:browser:launch', (browser = {}, launchOptions) => {\n    if (browser.name === 'electron') {\n      // run code for Electron browser in 4.0.0\n      return launchOptions\n    }\n  })\n}\n")),(0,r.kt)("h4",{id:"Example-2-Finding-Chromium-based-browsers"},"Example #2 (Finding Chromium-based browsers)"),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," This will no longer find any browsers.",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = (on, config) => {\n  on('before:browser:launch', (browser = {}, args) => {\n    if (browser.family === 'chrome') {\n      // in 4.x, `family` was changed to 'chromium' for all Chromium-based browsers\n      return args\n    }\n  })\n}\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Use ",(0,r.kt)("code",null,"browser.name")," and ",(0,r.kt)("code",null,"browser.family")," to select non-Electron Chromium-based browsers",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = (on, config) => {\n  on('before:browser:launch', (browser = {}, launchOptions) => {\n    if (browser.family === 'chromium' && browser.name !== 'electron') {\n      // pass launchOptions to Chromium-based browsers in 4.0\n      return launchOptions\n    }\n  })\n}\n")),(0,r.kt)("h3",{id:"cywriteFile-yields-null"},(0,r.kt)("inlineCode",{parentName:"h3"},"cy.writeFile()")," yields ",(0,r.kt)("inlineCode",{parentName:"h3"},"null")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"cy.writeFile()")," now yields ",(0,r.kt)("inlineCode",{parentName:"p"},"null")," instead of the ",(0,r.kt)("inlineCode",{parentName:"p"},"contents")," written to the\nfile. This change was made to more closely align with the behavior of Node.js\n",(0,r.kt)("a",{parentName:"p",href:"https://nodejs.org/api/fs.html#fs_fs_writefile_file_data_options_callback"},(0,r.kt)("inlineCode",{parentName:"a"},"fs.writeFile")),"."),(0,r.kt)(c,{type:"danger",mdxType:"Badge"},"Before")," This assertion will no longer pass",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.writeFile('path/to/message.txt', 'Hello World').then((text) => {\n  // Would pass in Cypress 3 but will fail in 4\n  expect(text).to.equal('Hello World') // false\n})\n")),(0,r.kt)(c,{type:"success",mdxType:"Badge"},"After")," Instead read the contents of the file",(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"cy.writeFile('path/to/message.txt', 'Hello World')\ncy.readFile('path/to/message.txt').then((text) => {\n  expect(text).to.equal('Hello World') // true\n})\n")),(0,r.kt)("h3",{id:"cycontains-ignores-invisible-whitespaces"},"cy.contains() ignores invisible whitespaces"),(0,r.kt)("p",null,"Browsers ignore leading, trailing, duplicate whitespaces. And Cypress now does\nthat, too."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},"<p>hello world</p>\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"cy.get('p').contains('hello world') // Fail in 3.x. Pass in 4.0.0.\ncy.get('p').contains('hello\\nworld') // Pass in 3.x. Fail in 4.0.0.\n")),(0,r.kt)("h3",{id:"Nodejs-8-support"},"Node.js 8+ support"),(0,r.kt)("p",null,"Cypress comes bundled with its own\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/cypress-io/cypress/blob/develop/.node-version"},"Node.js version"),".\nHowever, installing the ",(0,r.kt)("inlineCode",{parentName:"p"},"cypress")," npm package uses the Node.js version installed\non your system."),(0,r.kt)("p",null,"Node.js 4 reached its end of life on April 30, 2018 and Node.js 6 reached its\nend of life on April 30, 2019.\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/nodejs/Release"},"See Node's release schedule"),". These Node.js\nversions will no longer be supported when installing Cypress. The minimum\nNode.js version supported to install Cypress is Node.js 8."),(0,r.kt)("h3",{id:"CJSX-is-no-longer-supported"},"CJSX is no longer supported"),(0,r.kt)("p",null,"Cypress no longer supports CJSX (CoffeeScript + JSX), because the library used\nto transpile it is no longer maintained."),(0,r.kt)("p",null,"If you need CJSX support, you can use a pre-2.x version of the Browserify\npreprocessor."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"npm install @cypress/browserify-preprocessor@1.1.2\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"// cypress/plugins/index.js\nconst browserify = require('@cypress/browserify-preprocessor')\n\nmodule.exports = (on) => {\n  on('file:preprocessor', browserify())\n}\n")))}N.isMDXComponent=!0}}]);