"use strict";(self.webpackChunkcypress_docusaurus_ts=self.webpackChunkcypress_docusaurus_ts||[]).push([[7692],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>k});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},m=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),c=p(n),u=r,k=c["".concat(s,".").concat(u)]||c[u]||d[u]||i;return n?a.createElement(k,o(o({ref:t},m),{},{components:n})):a.createElement(k,o({ref:t},m))}));function k(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:r,o[1]=l;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},8477:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>g,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var a=n(7462),r=(n(7294),n(3905));const i={title:"wrap"},o=void 0,l={unversionedId:"api/commands/wrap",id:"api/commands/wrap",title:"wrap",description:"Yield the object passed into .wrap(). If the object is a promise, yield its",source:"@site/docs/api/commands/wrap.mdx",sourceDirName:"api/commands",slug:"/api/commands/wrap",permalink:"/cypress-documentation/api/commands/wrap",draft:!1,editUrl:"https://github.com/cypress-io/cypress-documentation/tree/main/docs/api/commands/wrap.mdx",tags:[],version:"current",lastUpdatedAt:1696480060,formattedLastUpdatedAt:"Oct 5, 2023",frontMatter:{title:"wrap"},sidebar:"api",previous:{title:"within",permalink:"/cypress-documentation/api/commands/within"},next:{title:"writeFile",permalink:"/cypress-documentation/api/commands/writefile"}},s={},p=[{value:"Syntax",id:"Syntax",level:2},{value:"Usage",id:"Usage",level:3},{value:"Arguments",id:"Arguments",level:3},{value:'Yields <Icon name="question-circle"/>',id:"Yields",level:3},{value:"Examples",id:"Examples",level:2},{value:"Objects",id:"Objects",level:3},{value:"Invoke the function on the subject in wrap and return the new value",id:"Invoke-the-function-on-the-subject-in-wrap-and-return-the-new-value",level:4},{value:"Elements",id:"Elements",level:3},{value:"Wrap elements to continue executing commands",id:"Wrap-elements-to-continue-executing-commands",level:4},{value:"Conditionally wrap elements",id:"Conditionally-wrap-elements",level:4},{value:"Promises",id:"Promises",level:3},{value:"Simple example",id:"Simple-example",level:4},{value:"Application example <E2EOnlyBadge />",id:"Application-example",level:4},{value:"Rules",id:"Rules",level:2},{value:'Requirements <Icon name="question-circle"/>',id:"Requirements",level:3},{value:'Assertions <Icon name="question-circle"/>',id:"Assertions",level:3},{value:'Timeouts <Icon name="question-circle"/>',id:"Timeouts",level:3},{value:"Command Log",id:"Command-Log",level:2},{value:"History",id:"History",level:2},{value:"See also",id:"See-also",level:2}],m=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",t)},c=m("Icon"),d=m("DocsImage"),u=m("E2EOnlyBadge"),k={toc:p};function g(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},k,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Yield the object passed into ",(0,r.kt)("inlineCode",{parentName:"p"},".wrap()"),". If the object is a promise, yield its\nresolved value."),(0,r.kt)("h2",{id:"Syntax"},"Syntax"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"cy.wrap(subject)\ncy.wrap(subject, options)\n")),(0,r.kt)("h3",{id:"Usage"},"Usage"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)(c,{name:"check-circle",color:"green",mdxType:"Icon"})," Correct Usage")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"cy.wrap({ name: 'Jane Lane' })\n")),(0,r.kt)("h3",{id:"Arguments"},"Arguments"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)(c,{name:"angle-right",mdxType:"Icon"})," subject")," ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"(Object)"))),(0,r.kt)("p",null,"An object to be yielded."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)(c,{name:"angle-right",mdxType:"Icon"})," options")," ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"(Object)"))),(0,r.kt)("p",null,"Pass in an options object to change the default behavior of ",(0,r.kt)("inlineCode",{parentName:"p"},"cy.wrap()"),"."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Option"),(0,r.kt)("th",{parentName:"tr",align:null},"Default"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"log")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"true")),(0,r.kt)("td",{parentName:"tr",align:null},"Displays the command in the ",(0,r.kt)("a",{parentName:"td",href:"/guides/core-concepts/cypress-app#Command-Log"},"Command log"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"timeout")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/guides/references/configuration#Timeouts"},(0,r.kt)("inlineCode",{parentName:"a"},"defaultCommandTimeout"))),(0,r.kt)("td",{parentName:"tr",align:null},"Time to wait for ",(0,r.kt)("inlineCode",{parentName:"td"},"cy.wrap()")," to resolve before ",(0,r.kt)("a",{parentName:"td",href:"#Timeouts"},"timing out"))))),(0,r.kt)("h3",{id:"Yields"},"Yields ",(0,r.kt)("a",{parentName:"h3",href:"/guides/core-concepts/introduction-to-cypress#Subject-Management"},(0,r.kt)(c,{name:"question-circle",mdxType:"Icon"}))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cy.wrap()")," yields the object it was called with.")),(0,r.kt)("h2",{id:"Examples"},"Examples"),(0,r.kt)("h3",{id:"Objects"},"Objects"),(0,r.kt)("h4",{id:"Invoke-the-function-on-the-subject-in-wrap-and-return-the-new-value"},"Invoke the function on the subject in wrap and return the new value"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"const getName = () => {\n  return 'Jane Lane'\n}\n\ncy.wrap({ name: getName }).invoke('name').should('eq', 'Jane Lane') // true\n")),(0,r.kt)("h3",{id:"Elements"},"Elements"),(0,r.kt)("h4",{id:"Wrap-elements-to-continue-executing-commands"},"Wrap elements to continue executing commands"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"cy.get('form').within(($form) => {\n  // ... more commands\n\n  cy.wrap($form).should('have.class', 'form-container')\n})\n")),(0,r.kt)("h4",{id:"Conditionally-wrap-elements"},"Conditionally wrap elements"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"cy.get('button').then(($button) => {\n  // $button is a wrapped jQuery element\n  if ($button.someMethod() === 'something') {\n    // wrap this element so we can\n    // use cypress commands on it\n    cy.wrap($button).click()\n  } else {\n    // do something else\n  }\n})\n")),(0,r.kt)("h3",{id:"Promises"},"Promises"),(0,r.kt)("p",null,"You can wrap promises returned by the application code. Cypress commands will\nautomatically wait for the promise to resolve before continuing with the yielded\nvalue to the next command or assertion. See the\n",(0,r.kt)("a",{parentName:"p",href:"/examples/recipes#Logging-In"},"Logging in using application code")," recipe for the\nfull example."),(0,r.kt)("h4",{id:"Simple-example"},"Simple example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const myPromise = new Promise((resolve, reject) => {\n  // we use setTimeout(...) to simulate async code.\n  setTimeout(() => {\n    resolve({\n      type: 'success',\n      message: 'It worked!',\n    })\n  }, 2500)\n})\n\nit('should wait for promises to resolve', () => {\n  cy.wrap(myPromise).its('message').should('eq', 'It worked!')\n})\n")),(0,r.kt)(d,{src:"/img/api/wrap/cypress-wrapped-promise-waits-to-resolve.gif",alt:"Wrap of promises",mdxType:"DocsImage"}),(0,r.kt)("h4",{id:"Application-example"},"Application example ",(0,r.kt)(u,{mdxType:"E2EOnlyBadge"})),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"// import application code for logging in\nimport { userService } from '../../src/_services/user.service'\n\nit('can assert against resolved object using .should', () => {\n  cy.log('user service login')\n  const username = Cypress.env('username')\n  const password = Cypress.env('password')\n\n  // wrap the promise returned by the application code\n  cy.wrap(userService.login(username, password))\n    // check the yielded object\n    .should('be.an', 'object')\n    .and('have.keys', ['firstName', 'lastName', 'username', 'id', 'token'])\n    .and('contain', {\n      username: 'test',\n      firstName: 'Test',\n      lastName: 'User',\n    })\n\n  // cy.visit command will wait for the promise returned from\n  // the \"userService.login\" to resolve. Then local storage item is set\n  // and the visit will immediately be authenticated and logged in\n  cy.visit('/')\n  // we should be logged in\n  cy.contains('Hi Test!').should('be.visible')\n})\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note:")," ",(0,r.kt)("inlineCode",{parentName:"p"},".wrap()")," will not synchronize asynchronous function calls for you.\nFor example, given the following example:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"You have two async functions ",(0,r.kt)("inlineCode",{parentName:"li"},"async function foo() {...}")," and\n",(0,r.kt)("inlineCode",{parentName:"li"},"async function bar() {...}")),(0,r.kt)("li",{parentName:"ul"},"You need to make sure ",(0,r.kt)("inlineCode",{parentName:"li"},"foo()")," has resolved first before invoking ",(0,r.kt)("inlineCode",{parentName:"li"},"bar()")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"bar()")," is also dependent on some data that is created while after calling\nother Cypress commands.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)(c,{name:"exclamation-triangle",color:"red",mdxType:"Icon"}))," If you wrap the\nasynchronous functions in ",(0,r.kt)("inlineCode",{parentName:"p"},"cy.wrap()"),", then ",(0,r.kt)("inlineCode",{parentName:"p"},"bar()")," may be called prematurely\nbefore the required data is available:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"cy.wrap(foo())\n\ncy.get('some-button').click()\ncy.get('some-input').type(someValue)\ncy.get('some-submit-button').click()\n\n// this will execute `bar()` immediately without waiting\n// for other cy.get(...) functions to complete\ncy.wrap(bar()) // DON'T DO THIS\n")),(0,r.kt)("p",null,"This behavior is due to the function invocation ",(0,r.kt)("inlineCode",{parentName:"p"},"foo()")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"bar()"),", which call\nthe functions immediately to return a Promise."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)(c,{name:"check-circle",color:"green",mdxType:"Icon"}))," If you want ",(0,r.kt)("inlineCode",{parentName:"p"},"bar()")," to execute\nafter ",(0,r.kt)("inlineCode",{parentName:"p"},"foo()")," and the ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/get"},"cy.get()")," commands, one solution is to\nchain off the final command using ",(0,r.kt)("a",{parentName:"p",href:"/api/commands/then"},".then()"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"cy.wrap(foo())\n\ncy.get('some-button').click()\ncy.get('some-input').type(someValue)\ncy.get('some-submit-button')\n  .click()\n  .then(() => {\n    // this will execute `bar()` after the\n    // other cy.get(...) functions complete\n    cy.wrap(bar())\n  })\n")),(0,r.kt)("h2",{id:"Rules"},"Rules"),(0,r.kt)("h3",{id:"Requirements"},"Requirements ",(0,r.kt)("a",{parentName:"h3",href:"/guides/core-concepts/introduction-to-cypress#Chains-of-Commands"},(0,r.kt)(c,{name:"question-circle",mdxType:"Icon"}))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cy.wrap()")," requires being chained off of ",(0,r.kt)("inlineCode",{parentName:"li"},"cy"),".")),(0,r.kt)("h3",{id:"Assertions"},"Assertions ",(0,r.kt)("a",{parentName:"h3",href:"/guides/core-concepts/introduction-to-cypress#Assertions"},(0,r.kt)(c,{name:"question-circle",mdxType:"Icon"}))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cy.wrap()"),", when its argument is a promise, will automatically wait until the\npromise resolves. If the promise is rejected, ",(0,r.kt)("inlineCode",{parentName:"li"},"cy.wrap()")," will fail the test."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cy.wrap()")," will automatically ",(0,r.kt)("a",{parentName:"li",href:"/guides/core-concepts/retry-ability"},"retry"),"\nuntil all chained assertions have passed.")),(0,r.kt)("h3",{id:"Timeouts"},"Timeouts ",(0,r.kt)("a",{parentName:"h3",href:"/guides/core-concepts/introduction-to-cypress#Timeouts"},(0,r.kt)(c,{name:"question-circle",mdxType:"Icon"}))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cy.wrap()")," can time out waiting for assertions you've added to pass.")),(0,r.kt)("h2",{id:"Command-Log"},"Command Log"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Make assertions about object")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"cy.wrap({ amount: 10 }).should('have.property', 'amount').and('eq', 10)\n")),(0,r.kt)("p",null,"The commands above will display in the Command Log as:"),(0,r.kt)(d,{src:"/img/api/wrap/wrapped-object-in-cypress-tests.png",alt:"Command Log wrap",mdxType:"DocsImage"}),(0,r.kt)("p",null,"When clicking on the ",(0,r.kt)("inlineCode",{parentName:"p"},"wrap")," command within the command log, the console outputs\nthe following:"),(0,r.kt)(d,{src:"/img/api/wrap/console-log-only-shows-yield-of-wrap.png",alt:"Console Log wrap",mdxType:"DocsImage"}),(0,r.kt)("h2",{id:"History"},"History"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Version"),(0,r.kt)("th",{parentName:"tr",align:null},"Changes"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/guides/references/changelog#3-2-0"},"3.2.0")),(0,r.kt)("td",{parentName:"tr",align:null},"Retry ",(0,r.kt)("inlineCode",{parentName:"td"},"cy.wrap()")," if ",(0,r.kt)("inlineCode",{parentName:"td"},"undefined")," when followed by ",(0,r.kt)("a",{parentName:"td",href:"/api/commands/should"},".should()"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/guides/references/changelog#0.4.5"},"0.4.5")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"cy.wrap()")," command added")))),(0,r.kt)("h2",{id:"See-also"},"See also"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/invoke"},(0,r.kt)("inlineCode",{parentName:"a"},".invoke()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/its"},(0,r.kt)("inlineCode",{parentName:"a"},".its()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/should"},(0,r.kt)("inlineCode",{parentName:"a"},".should()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/spread"},(0,r.kt)("inlineCode",{parentName:"a"},".spread()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/api/commands/then"},(0,r.kt)("inlineCode",{parentName:"a"},".then()"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/examples/recipes#Logging-In"},"Logging In: Using application code")," recipe"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/examples/recipes#Unit-Testing"},"Unit Testing: Application Code")," recipe")))}g.isMDXComponent=!0}}]);