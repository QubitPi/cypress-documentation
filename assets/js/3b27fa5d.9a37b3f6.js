"use strict";(self.webpackChunkcypress_docusaurus_ts=self.webpackChunkcypress_docusaurus_ts||[]).push([[4556],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>y});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=r.createContext({}),p=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},u=function(e){var n=p(e.components);return r.createElement(l.Provider,{value:n},e.children)},m="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),m=p(t),d=a,y=m["".concat(l,".").concat(d)]||m[d]||c[d]||o;return t?r.createElement(y,i(i({ref:n},u),{},{components:t})):r.createElement(y,i({ref:n},u))}));function y(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,i=new Array(o);i[0]=d;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[m]="string"==typeof e?e:a,i[1]=s;for(var p=2;p<o;p++)i[p]=t[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},6750:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var r=t(7462),a=(t(7294),t(3905));const o={title:"Proxy Configuration"},i=void 0,s={unversionedId:"guides/references/proxy-configuration",id:"guides/references/proxy-configuration",title:"Proxy Configuration",description:"Cypress needs Internet access to work. Many companies require the use of a",source:"@site/docs/guides/references/proxy-configuration.mdx",sourceDirName:"guides/references",slug:"/guides/references/proxy-configuration",permalink:"/cypress-documentation/guides/references/proxy-configuration",draft:!1,editUrl:"https://github.com/cypress-io/cypress-documentation/tree/main/docs/guides/references/proxy-configuration.mdx",tags:[],version:"current",lastUpdatedAt:1702621628,formattedLastUpdatedAt:"Dec 15, 2023",frontMatter:{title:"Proxy Configuration"},sidebar:"guides",previous:{title:"Migration Guide",permalink:"/cypress-documentation/guides/references/migration-guide"},next:{title:"Release Stages",permalink:"/cypress-documentation/guides/references/release-stages"}},l={},p=[{value:"Set a proxy on Linux or macOS",id:"Set-a-proxy-on-Linux-or-macOS",level:2},{value:"Set a proxy on Windows",id:"Set-a-proxy-on-Windows",level:2},{value:"Proxy environment variables",id:"Proxy-environment-variables",level:2},{value:"Using a custom certificate authority (CA)",id:"Using-a-custom-certificate-authority-CA",level:2},{value:"View, unset, and set environment variables",id:"View-unset-and-set-environment-variables",level:2},{value:"Linux or macOS",id:"Linux-or-macOS",level:3},{value:"Set an environment variable for the current session",id:"Set-an-environment-variable-for-the-current-session",level:4},{value:"Unset an environment variable",id:"Unset-an-environment-variable",level:4},{value:"See all the currently set environment variables",id:"See-all-the-currently-set-environment-variables",level:4},{value:"Windows",id:"Windows",level:3},{value:"Set an environment variable for current session",id:"Set-an-environment-variable-for-current-session",level:4},{value:"Set environment variable globally for all future sessions",id:"Set-environment-variable-globally-for-all-future-sessions",level:4},{value:"Unset an environment variable in the current session",id:"Unset-an-environment-variable-in-the-current-session",level:4},{value:"See all currently set environment variables",id:"See-all-currently-set-environment-variables",level:4},{value:"View proxy settings in Cypress",id:"View-proxy-settings-in-Cypress",level:2}],u=(m="DocsImage",function(e){return console.warn("Component "+m+" was not imported, exported, or provided by MDXProvider as global scope"),(0,a.kt)("div",e)});var m;const c={toc:p};function d(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,r.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Cypress needs Internet access to work. Many companies require the use of a\ncorporate proxy to access the Internet. If your company does this, many\nfunctions of Cypress will not work until you've configured Cypress to use your\nproxy:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Cypress won't be able to load web pages besides ",(0,a.kt)("inlineCode",{parentName:"li"},"localhost"),"."),(0,a.kt)("li",{parentName:"ul"},"Cypress won't be able to warn you if your\n",(0,a.kt)("a",{parentName:"li",href:"/guides/references/configuration#Global"},"baseUrl")," isn't available."),(0,a.kt)("li",{parentName:"ul"},"Cypress won't be able to connect to\n",(0,a.kt)("a",{parentName:"li",href:"/guides/cloud/introduction"},"Cypress Cloud")," to log in or record test runs."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"npm install cypress")," may fail while downloading the Cypress binary.")),(0,a.kt)("p",null,"If you are experiencing any or all of these issues, you may need to configure\nCypress with your proxy. Instructions are available for\n",(0,a.kt)("a",{parentName:"p",href:"#Set-a-proxy-on-Linux-or-macOS"},"macOS"),",\n",(0,a.kt)("a",{parentName:"p",href:"#Set-a-proxy-on-Linux-or-macOS"},"Linux"),", and ",(0,a.kt)("a",{parentName:"p",href:"#Set-a-proxy-on-Windows"},"Windows"),"."),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"Proxy Auto-Configuration (PAC) files are not currently supported. If your\norganization uses a PAC file, contact a network administrator to ask what HTTP\nproxy you should be using to access the general Internet, then use that proxy\nwith Cypress.")),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"SOCKS proxies are not currently supported. A workaround is to set up an HTTP\nproxy locally that points to your SOCKS proxy, then using that HTTP proxy with\nCypress.\n",(0,a.kt)("a",{parentName:"p",href:"https://superuser.com/questions/423563/convert-http-requests-to-socks5"},"Read more about forwarding an HTTP proxy through SOCKS."))),(0,a.kt)("h2",{id:"Set-a-proxy-on-Linux-or-macOS"},"Set a proxy on Linux or macOS"),(0,a.kt)("p",null,"To set your proxy on Linux or macOS, run the following command in a terminal\nbefore running Cypress:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"export HTTP_PROXY=http://my-company-proxy.com\n")),(0,a.kt)("p",null,"You can also set ",(0,a.kt)("inlineCode",{parentName:"p"},"NO_PROXY")," to bypass the proxy for certain domains (by default,\nonly ",(0,a.kt)("inlineCode",{parentName:"p"},"localhost")," will be bypassed):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"export NO_PROXY=localhost,google.com,apple.com\n")),(0,a.kt)("p",null,"To make these changes permanent, you can add these commands to your shell's\n",(0,a.kt)("inlineCode",{parentName:"p"},"~/.profile")," (",(0,a.kt)("inlineCode",{parentName:"p"},"~/.zsh_profile"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"~/.bash_profile"),", etc.) to run them on every\nlogin."),(0,a.kt)("h2",{id:"Set-a-proxy-on-Windows"},"Set a proxy on Windows"),(0,a.kt)("p",null,"When starting up after being installed, Cypress will attempt to load the proxy\nconfigured in the Windows registry by default.\n",(0,a.kt)("a",{parentName:"p",href:"https://www.howtogeek.com/tips/how-to-set-your-proxy-settings-in-windows-8.1/"},"Learn how to set your proxy settings system-wide in Windows.")),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"When downloading Cypress for the first time, the ",(0,a.kt)("inlineCode",{parentName:"p"},"cypress")," command line tool\n",(0,a.kt)("em",{parentName:"p"},"does not")," read proxy settings from the Windows registry. If you need to\nconfigure a proxy for the installation to work, you must set the appropriate\nenvironment variables as described below.")),(0,a.kt)("p",null,"You can also set proxy environment variables before running Cypress to override\nthe Windows registry. This is also the only way to define a proxy for\n",(0,a.kt)("inlineCode",{parentName:"p"},"cypress install"),". In Command Prompt, defining the required environment\nvariables looks like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"set HTTP_PROXY=http://my-company-proxy.com\n")),(0,a.kt)("p",null,"To accomplish the same thing in PowerShell:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'$env:HTTP_PROXY = "http://my-company-proxy.com"\n')),(0,a.kt)("p",null,"To save the ",(0,a.kt)("inlineCode",{parentName:"p"},"HTTP_PROXY")," variable and use your proxy for all new shells, use\n",(0,a.kt)("inlineCode",{parentName:"p"},"setx"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"setx HTTP_PROXY http://my-company-proxy.com\n")),(0,a.kt)("h2",{id:"Proxy-environment-variables"},"Proxy environment variables"),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"This section refers to your operating system's environment variables, ",(0,a.kt)("em",{parentName:"p"},"not"),"\n",(0,a.kt)("a",{parentName:"p",href:"/guides/guides/environment-variables"},"Cypress environment variables"))),(0,a.kt)("p",null,"Cypress automatically reads from your system's ",(0,a.kt)("inlineCode",{parentName:"p"},"HTTP_PROXY")," environment variable\nand uses that proxy for all HTTP and HTTPS traffic. If an ",(0,a.kt)("inlineCode",{parentName:"p"},"HTTPS_PROXY"),"\nenvironment variable is set, HTTPS traffic will use that proxy instead."),(0,a.kt)("p",null,"To bypass the proxy for certain domains, a ",(0,a.kt)("inlineCode",{parentName:"p"},"NO_PROXY")," environment variable can\nbe set to a comma-separated list of domain names to not proxy traffic for. By\ndefault, traffic to ",(0,a.kt)("inlineCode",{parentName:"p"},"localhost")," will not be proxied. To make Cypress send\ntraffic for ",(0,a.kt)("inlineCode",{parentName:"p"},"localhost")," through the proxy, pass ",(0,a.kt)("inlineCode",{parentName:"p"},"<-loopback>")," in ",(0,a.kt)("inlineCode",{parentName:"p"},"NO_PROXY"),"."),(0,a.kt)("p",null,"If an uppercase and a lowercase version of the proxy settings are supplied (for\nexample, ",(0,a.kt)("inlineCode",{parentName:"p"},"HTTP_PROXY")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"http_proxy")," are both set), the lowercase variable\nwill be preferred."),(0,a.kt)("h2",{id:"Using-a-custom-certificate-authority-CA"},"Using a custom certificate authority (CA)"),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"This section refers to npm config variables and node environment variables,\n",(0,a.kt)("em",{parentName:"p"},"not")," ",(0,a.kt)("a",{parentName:"p",href:"/guides/guides/environment-variables"},"Cypress environment variables"))),(0,a.kt)("p",null,"Cypress needs to be able to authenticate properly when communicating to\n",(0,a.kt)("a",{parentName:"p",href:"/guides/cloud/introduction"},"Cypress Cloud"),". When connecting through a proxy,\noftentimes a self signed certificate is used as a CA. In order to handle this\nconfiguration, Cypress automatically reads from npm config's\n",(0,a.kt)("a",{parentName:"p",href:"https://docs.npmjs.com/cli/v8/using-npm/config#cafile"},(0,a.kt)("inlineCode",{parentName:"a"},"cafile"))," and\n",(0,a.kt)("a",{parentName:"p",href:"https://docs.npmjs.com/cli/v8/using-npm/config#ca"},(0,a.kt)("inlineCode",{parentName:"a"},"ca"))," options and the\n",(0,a.kt)("a",{parentName:"p",href:"https://nodejs.org/api/cli.html#node_extra_ca_certsfile"},(0,a.kt)("inlineCode",{parentName:"a"},"NODE_EXTRA_CA_CERTS")),"\nnode environment variable."),(0,a.kt)("p",null,"To mimic the behavior of npm and node, Cypress looks at ",(0,a.kt)("inlineCode",{parentName:"p"},"cafile")," first and then\n",(0,a.kt)("inlineCode",{parentName:"p"},"ca")," and uses the corresponding certificate(s) as a replacement for the CA. For\nexample, to use the CA at ",(0,a.kt)("inlineCode",{parentName:"p"},"/home/person/certs/ca.crt"),", add the following to your\n",(0,a.kt)("inlineCode",{parentName:"p"},".npmrc"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"cafile=/home/person/certs/ca.crt\n")),(0,a.kt)("p",null,"If neither ",(0,a.kt)("inlineCode",{parentName:"p"},"cafile")," nor ",(0,a.kt)("inlineCode",{parentName:"p"},"ca")," are set, Cypress looks at the system environment\nvariable ",(0,a.kt)("inlineCode",{parentName:"p"},"NODE_EXTRA_CA_CERTS")," and uses the corresponding certificate(s) as an\nextension for the trusted CA."),(0,a.kt)("p",null,"Note that the npm config is used as a replacement, and the node environment\nvariable is used as an extension."),(0,a.kt)("h2",{id:"View-unset-and-set-environment-variables"},"View, unset, and set environment variables"),(0,a.kt)("p",null,"In order to properly configure your proxy configuration, it can be helpful to\nknow how to view currently set environment variables, unset unwanted environment\nvariables, and set environment variables depending on your operating system."),(0,a.kt)("h3",{id:"Linux-or-macOS"},"Linux or macOS"),(0,a.kt)("h4",{id:"Set-an-environment-variable-for-the-current-session"},"Set an environment variable for the current session"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"export SOME_VARIABLE=some-value\n")),(0,a.kt)("h4",{id:"Unset-an-environment-variable"},"Unset an environment variable"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"unset SOME_VARIABLE\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"echo")," will print nothing after ",(0,a.kt)("inlineCode",{parentName:"p"},"unset"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"echo $SOME_VARIABLE\n")),(0,a.kt)("h4",{id:"See-all-the-currently-set-environment-variables"},"See all the currently set environment variables"),(0,a.kt)("p",null,"Print all env vars:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"env\n")),(0,a.kt)("p",null,"Print environment variables with ",(0,a.kt)("inlineCode",{parentName:"p"},"proxy")," (case insensitive) in the name:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"env | grep -i proxy\n")),(0,a.kt)("h3",{id:"Windows"},"Windows"),(0,a.kt)("p",null,"Setting environment variables in Windows is different depending on if you're\nusing ",(0,a.kt)("em",{parentName:"p"},"command prompt")," or ",(0,a.kt)("em",{parentName:"p"},"PowerShell"),"."),(0,a.kt)("h4",{id:"Set-an-environment-variable-for-current-session"},"Set an environment variable for current session"),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"Command prompt:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"set SOME_VARIABLE=some-value\n")),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"PowerShell:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'$env:SOME_VARIABLE = "some-value"\n')),(0,a.kt)("h4",{id:"Set-environment-variable-globally-for-all-future-sessions"},"Set environment variable globally for all future sessions"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"setx SOME_VARIABLE some-value\n")),(0,a.kt)("h4",{id:"Unset-an-environment-variable-in-the-current-session"},"Unset an environment variable in the current session"),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"Command prompt:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"set SOME_VARIABLE=\n")),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"PowerShell:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"Remove-Item Env:\\SOME_VARIABLE\n")),(0,a.kt)("h4",{id:"See-all-currently-set-environment-variables"},"See all currently set environment variables"),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"Command prompt:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"set\n")),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"PowerShell:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"Get-ChildItem Env:\n")),(0,a.kt)("h2",{id:"View-proxy-settings-in-Cypress"},"View proxy settings in Cypress"),(0,a.kt)("p",null,"Your current proxy settings can be viewed from within Cypress. Follow these\nsteps:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Open up your project in Cypress via ",(0,a.kt)("inlineCode",{parentName:"li"},"cypress open"),"."),(0,a.kt)("li",{parentName:"ol"},'Click the "Settings" tab.'),(0,a.kt)("li",{parentName:"ol"},'Click the "Proxy Settings" section to expand it and view the proxy settings\nthat Cypress is currently using.')),(0,a.kt)(u,{src:"/img/guides/configuration/test-runner-settings-proxy-configuration.jpg",alt:"Proxy configuration in the Desktop app",mdxType:"DocsImage"}))}d.isMDXComponent=!0}}]);